import{r as e,A as a,p as t,B as l,c as s,o as i,l as n,b as r,t as o,g as c,F as u,n as d,u as v,v as p,x as m,y,C as g,h as f,w as h,T as _,D as b,f as k,d as x,s as w,E as C,G as A,z as L}from"./vue-core-BXg5zaqj.js";import{c as P,_ as S}from"./index--vV0uQ1E.js";import{a as T}from"./api-Cibp7nif.js";import"./axios-rSMZb3Ae.js";import"./pinia-CQ2rHS-F.js";const z=e(!1),I=e("Loading...");const M={class:"citation-results"},D={key:0,class:"loading-state"},N={key:1,class:"error-state"},R={key:2,class:"results-content"},V={class:"results-header"},U={class:"header-content"},F={class:"summary-stats"},q={class:"stat-item"},E={class:"stat-number"},j={class:"stat-item verified"},B={class:"stat-number"},$={class:"stat-item invalid"},O={class:"stat-number"},H={key:0,class:"stats-section"},J={class:"stats-grid"},Y={class:"stat-card"},G={class:"stat-value"},X={class:"stat-card"},K={class:"stat-value"},Q={class:"stat-card verified"},W={class:"stat-value"},Z={class:"stat-card invalid"},ee={class:"stat-value"},ae={class:"filter-section"},te={class:"filter-controls"},le=["onClick"],se={class:"filter-count"},ie={class:"search-box"},ne={key:1,class:"citations-list"},re={key:0,class:"group-icon"},oe={key:1,class:"group-icon"},ce={class:"group-title"},ue={class:"citation-header"},de={class:"citation-main"},ve=["title","onMouseenter","onClick"],pe={key:0,class:"score-tooltip"},me={class:"case-name"},ye=["href"],ge={key:1},fe={class:"citation-link"},he=["href"],_e={key:1,class:"citation-text"},be={key:2,class:"complex-indicator",title:"Complex citation with multiple components"},ke={class:"citation-actions"},xe=["onClick","title"],we={key:0,class:"citation-details"},Ce={class:"detail-section"},Ae={class:"detail-row"},Le={class:"detail-value"},Pe={key:0,class:"detail-row"},Se={class:"detail-value"},Te={class:"detail-row"},ze={class:"detail-section"},Ie={class:"detail-row"},Me={class:"detail-value"},De={class:"detail-row"},Ne={class:"detail-value"},Re={class:"detail-row"},Ve={class:"detail-value"},Ue={key:0,class:"detail-row"},Fe={key:1,class:"detail-row"},qe={class:"detail-section"},Ee={key:0,class:"detail-row"},je={class:"detail-value"},Be={key:1,class:"detail-row"},$e={class:"detail-value"},Oe={key:2,class:"detail-row"},He={class:"detail-value"},Je={key:3,class:"detail-row"},Ye={class:"detail-value"},Ge={key:4,class:"detail-row"},Xe={class:"detail-value"},Ke={key:0,class:"detail-section"},Qe={class:"detail-row"},We={class:"detail-value"},Ze={key:0,class:"detail-row"},ea={class:"detail-value"},aa={key:1,class:"detail-row"},ta={class:"detail-value"},la={key:2,class:"detail-row"},sa={key:1,class:"detail-section"},ia={class:"context-box"},na={key:2,class:"detail-section"},ra={class:"parallel-citations"},oa={class:"parallel-citation-text"},ca={key:0,class:"inherited-badge",title:"Verified by association with primary"},ua={class:"detail-section"},da={class:"detail-row"},va={class:"detail-value"},pa={key:0,class:"detail-row"},ma={class:"detail-value"},ya={key:1,class:"detail-row"},ga={class:"detail-value note"},fa={key:3,class:"detail-section"},ha={class:"complex-citation-info"},_a={key:0,class:"detail-row"},ba={class:"detail-value"},ka={key:1,class:"detail-row"},xa={class:"detail-value"},wa={key:2,class:"detail-row"},Ca={class:"detail-value"},Aa={key:3,class:"detail-row"},La={class:"detail-value"},Pa={key:4,class:"detail-row"},Sa={class:"detail-value"},Ta={key:5,class:"detail-row"},za={class:"detail-value"},Ia={key:6,class:"detail-row"},Ma={class:"detail-value"},Da={key:1,class:"parallel-citations-section"},Na={class:"citation-header"},Ra={class:"citation-main"},Va={key:0,class:"inherited-badge",title:"Verified by association with primary"},Ua={class:"case-name"},Fa={class:"citation-link"},qa={class:"citation-text"},Ea={key:0,class:"pagination"},ja=["disabled"],Ba={class:"page-info"},$a=["disabled"],Oa={key:2,class:"empty-filter"},Ha={key:3,class:"no-results"},Ja={class:"modal-body"},Ya={class:"detail-section"},Ga={class:"detail-grid"},Xa={class:"detail-item"},Ka={class:"detail-value"},Qa={class:"detail-item"},Wa={class:"detail-value"},Za={class:"detail-item"},et={class:"detail-section"},at={class:"detail-grid"},tt={key:0,class:"detail-item"},lt={class:"detail-value"},st={key:1,class:"detail-item"},it={class:"detail-value"},nt={key:2,class:"detail-item"},rt={class:"detail-value"},ot={key:3,class:"detail-item"},ct={class:"detail-value"},ut={key:4,class:"detail-item"},dt={class:"detail-value"},vt={class:"detail-section"},pt={class:"detail-grid"},mt={key:0,class:"detail-item"},yt={class:"detail-value"},gt={key:1,class:"detail-item"},ft={class:"detail-value"},ht={key:2,class:"detail-item"},_t={class:"detail-value"},bt={key:3,class:"detail-item"},kt={class:"detail-value"},xt={class:"detail-section"},wt={class:"detail-grid"},Ct={key:0,class:"detail-item"},At={class:"detail-value"},Lt={key:1,class:"detail-item"},Pt={class:"detail-value"},St={key:2,class:"detail-item"},Tt={class:"detail-value"},zt={key:0,class:"detail-section"},It={class:"raw-data"},Mt={key:1,class:"detail-section"},Dt={class:"parallel-citations"},Nt=S({__name:"CitationResults",props:{results:{type:Object,default:null},loading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["apply-correction","copy-results","download-results","toast"],setup(a,{emit:g}){const f=a,h=g,_=e("all"),b=e(""),k=e(1),x=e(null),w=e(new Set),C=e(null),A=t((()=>{var e;return(null==(e=f.results)?void 0:e.citations)?f.results.citations.filter((e=>e.verified)).length:0})),L=t((()=>{var e;return(null==(e=f.results)?void 0:e.citations)?f.results.citations.filter((e=>!e.verified)).length:0})),P=t((()=>{var e;if(!(null==(e=f.results)?void 0:e.citations))return[];let a=f.results.citations;if("verified"===_.value?a=a.filter((e=>e.verified)):"invalid"===_.value&&(a=a.filter((e=>!e.verified))),b.value.trim()){const e=b.value.toLowerCase();a=a.filter((a=>a.citation.toLowerCase().includes(e)||Rt(a)&&Rt(a).toLowerCase().includes(e)||Vt(a)&&Vt(a).toLowerCase().includes(e)||qt(a)&&qt(a).toLowerCase().includes(e)||Et(a)&&Et(a).toLowerCase().includes(e)||jt(a)&&jt(a).toLowerCase().includes(e)||Bt(a)&&Bt(a).toLowerCase().includes(e)||Ot(a)&&Ot(a).some((a=>a.toLowerCase().includes(e)))||Jt(a)&&Jt(a).toLowerCase().includes(e)))}return a.sort(((e,a)=>(e.score||0)-(a.score||0))),a})),S=t((()=>Math.ceil(P.value.length/50))),T=t((()=>{const e=50*(k.value-1),a=e+50;return P.value.slice(e,a)})),z=t((()=>{var e,a;return[{value:"all",label:"All",count:(null==(a=null==(e=f.results)?void 0:e.citations)?void 0:a.length)||0},{value:"verified",label:"Verified",count:A.value},{value:"invalid",label:"Invalid",count:L.value}]})),I=t((()=>[{status:"verified",citations:T.value.filter((e=>e.verified))},{status:"unverified",citations:T.value.filter((e=>!e.verified))}].filter((e=>e.citations.length>0)))),Nt=t((()=>{var e;if(!(null==(e=f.results)?void 0:e.citations))return[];const a=new Map;return T.value.forEach((e=>{const t=e.primary_citation||e.citation;a.has(t)||a.set(t,{primary:null,parallels:[],isComplex:!1});const l=a.get(t);e.citation!==t&&e.is_parallel_citation?l.parallels.push(e):l.primary=e,e.is_complex_citation&&(l.isComplex=!0)})),Array.from(a.values()).sort(((e,a)=>{var t,l,s,i;const n=(null==(t=e.primary)?void 0:t.verified)||e.parallels.some((e=>e.verified)),r=(null==(l=a.primary)?void 0:l.verified)||a.parallels.some((e=>e.verified));if(n!==r)return r?1:-1;const o=(null==(s=e.primary)?void 0:s.citation)||"",c=(null==(i=a.primary)?void 0:i.citation)||"";return o.localeCompare(c)}))})),Rt=e=>{var a,t;const l=e.case_name||(null==(a=e.metadata)?void 0:a.case_name)||(null==(t=e.group_metadata)?void 0:t.case_name);if(l&&"N/A"!==l&&""!==l.trim())return l;const s=e.extracted_case_name||null;return s&&"N/A"!==s&&""!==s.trim()?s:"N/A"},Vt=e=>e.extracted_case_name||null,Ut=e=>e.case_name_similarity||null,Ft=e=>e.case_name_mismatch||!1,qt=e=>{var a,t;return e.court||(null==(a=e.metadata)?void 0:a.court)||(null==(t=e.group_metadata)?void 0:t.court)||null},Et=e=>{var a,t;return e.docket_number||(null==(a=e.metadata)?void 0:a.docket)||(null==(t=e.group_metadata)?void 0:t.docket)||null},jt=e=>{var a;return e.date_filed||(null==(a=e.group_metadata)?void 0:a.date_filed)||null},Bt=e=>e.extracted_date||null,$t=e=>{var a;return e.canonical_date||(null==(a=e.group_metadata)?void 0:a.canonical_date)||null},Ot=e=>e.parallel_citations&&e.parallel_citations.length>0?e.parallel_citations:e.all_citations||[],Ht=e=>{var a,t;return e.url||(null==(a=e.metadata)?void 0:a.url)||(null==(t=e.group_metadata)?void 0:t.url)||null},Jt=e=>{var a;const t=e.url||"";if(t)try{return new URL(t).hostname.replace(/^www\./,"")}catch(s){return t}const l=e.citation_url||"";if(l)try{return new URL(l).hostname.replace(/^www\./,"")}catch(s){return l}return e.source||(null==(a=e.metadata)?void 0:a.source)||"Unknown"},Yt=e=>e.note||null,Gt=e=>{if(!e)return"N/A";const a=/^\d{4}/.exec(e);if(a)return a[0];try{return new Date(e).getFullYear()}catch(t){return e}},Xt=async()=>{try{const e=P.value.map((e=>`${e.citation} - ${e.verified?"Verified":"Invalid"}`)).join("\n");await navigator.clipboard.writeText(e),h("copy-results"),h("toast","Results copied to clipboard!","success")}catch(e){h("toast","Failed to copy results","error")}},Kt=()=>{try{const e={timestamp:(new Date).toISOString(),total:P.value.length,verified:A.value,invalid:L.value,citations:P.value.map((e=>({citation:e.citation,verified:e.verified,case_name:Rt(e),extracted_case_name:Vt(e),case_name_similarity:Ut(e),case_name_mismatch:Ft(e),court:qt(e),docket_number:Et(e),date_filed:jt(e),extracted_date:Bt(e),parallel_citations:Ot(e),url:Ht(e),source:Jt(e),note:Yt(e),metadata:e.metadata})))},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),l=document.createElement("a");l.href=t,l.download=`citation-results-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t),h("download-results"),h("toast","Results downloaded successfully!","success")}catch(e){h("toast","Failed to download results","error")}},Qt=()=>{k.value=1};l(_,Qt),l(b,Qt);const Wt=e=>{if(!e)return"";let a=e.citation;if(Array.isArray(a)){if(a.length>0)return a[0]}else if("string"==typeof a)return a;let t=e.canonical_citation;if(Array.isArray(t)){if(t.length>0)return t[0]}else if("string"==typeof t)return t;return e.cite?e.cite:e.text?e.text:"Citation not available"},Zt=e=>{let a=e.citation;return Array.isArray(a)&&a.length>1?a.slice(1):!Array.isArray(a)&&Array.isArray(e.canonical_citation)&&e.canonical_citation.length>1?e.canonical_citation.slice(1):Array.isArray(e.parallel_citations)&&e.parallel_citations.length>0?e.parallel_citations:[]},el=()=>{x.value=null},al=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString()}catch(a){return e}},tl=e=>{if(!e)return"N/A";try{const a="string"==typeof e?JSON.parse(e):e;return JSON.stringify(a,null,2)}catch(a){return e}},ll=()=>{C.value=null};return(e,t)=>(i(),s("div",M,[a.loading?(i(),s("div",D,t[4]||(t[4]=[r("div",{class:"loading-spinner"},null,-1),r("h3",null,"Analyzing citations...",-1)]))):a.error?(i(),s("div",N,[t[5]||(t[5]=r("div",{class:"error-icon"},"❌",-1)),t[6]||(t[6]=r("h3",null,"Analysis Error",-1)),r("p",null,o(a.error),1)])):a.results&&a.results.citations&&a.results.citations.length>0?(i(),s("div",R,[r("div",V,[r("div",U,[t[10]||(t[10]=r("h2",null,"Citation Analysis Results",-1)),r("div",F,[r("div",q,[r("span",E,o(a.results.citations.length),1),t[7]||(t[7]=r("span",{class:"stat-label"},"Total",-1))]),r("div",j,[r("span",B,o(A.value),1),t[8]||(t[8]=r("span",{class:"stat-label"},"Verified",-1))]),r("div",$,[r("span",O,o(L.value),1),t[9]||(t[9]=r("span",{class:"stat-label"},"Invalid",-1))])])]),r("div",{class:"action-buttons"},[r("button",{onClick:Xt,class:"action-btn copy-btn"},t[11]||(t[11]=[r("span",{class:"btn-icon"},"📋",-1),c(" Copy Results ")])),r("button",{onClick:Kt,class:"action-btn download-btn"},t[12]||(t[12]=[r("span",{class:"btn-icon"},"💾",-1),c(" Download ")]))])]),a.results.stats?(i(),s("div",H,[t[17]||(t[17]=r("h3",null,"Processing Breakdown",-1)),r("div",J,[r("div",Y,[r("span",G,o(a.results.stats.total_extracted),1),t[13]||(t[13]=r("span",{class:"stat-title"},"Extracted",-1))]),r("div",X,[r("span",K,o(a.results.stats.deduplicated),1),t[14]||(t[14]=r("span",{class:"stat-title"},"Unique",-1))]),r("div",Q,[r("span",W,o(a.results.stats.verified_in_cache+a.results.stats.verified_in_json_array+a.results.stats.verified_in_text_blob+a.results.stats.verified_in_single+a.results.stats.verified_in_langsearch),1),t[15]||(t[15]=r("span",{class:"stat-title"},"Verified",-1))]),r("div",Z,[r("span",ee,o(a.results.stats.not_verified),1),t[16]||(t[16]=r("span",{class:"stat-title"},"Not Verified",-1))])])])):n("",!0),r("div",ae,[r("div",te,[(i(!0),s(u,null,d(z.value,(e=>(i(),s("button",{key:e.value,class:v(["filter-btn",{active:_.value===e.value}]),onClick:a=>_.value=e.value},[c(o(e.label)+" ",1),r("span",se,"("+o(e.count)+")",1)],10,le)))),128))]),r("div",ie,[p(r("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),type:"text",placeholder:"Search citations...",class:"search-input"},null,512),[[m,b.value]])])]),P.value.length>0?(i(),s("div",ne,[(i(!0),s(u,null,d(I.value,((e,a)=>(i(),s(u,{key:e.status},[r("div",{class:v(["group-header",e.status])},["verified"===e.status?(i(),s("span",re,"✔️")):"unverified"===e.status?(i(),s("span",oe,"❌")):n("",!0),r("span",ce,o("verified"===e.status?"Verified Citations":"Unverified Citations")+" ("+o(e.citations.length)+") ",1)],2),(i(!0),s(u,null,d(Nt.value.filter((a=>{var t;const l=(null==(t=a.primary)?void 0:t.verified)||a.parallels.some((e=>e.verified));return"verified"===e.status?l:!l})),(e=>{var a,l,p;return i(),s("div",{key:(null==(a=e.primary)?void 0:a.citation)||"cluster",class:"citation-cluster"},[e.primary?(i(),s("div",{key:0,class:v(["citation-item",{verified:e.primary.verified,invalid:!e.primary.verified}])},[r("div",ue,[r("div",de,[t[22]||(t[22]=r("div",{class:"primary-badge",title:"Primary citation in this cluster"}," 🎯 Primary ",-1)),r("div",{class:v(["score-flag",`score-${e.primary.scoreColor}`]),title:(p=e.primary.score,{0:"No verification data available",1:"Limited verification - some data available",2:"Good verification - case name found",3:"Very good verification - case name and additional data",4:"Excellent verification - all data matches"}[p]||"Unknown score"),onMouseenter:a=>(e=>{C.value=e})(e.primary),onMouseleave:ll,onClick:a=>(e=>{C.value=C.value===e?null:e})(e.primary),style:{cursor:"pointer",position:"relative"}},[c(o(e.primary.score)+"/4 ",1),C.value===e.primary?(i(),s("div",pe,[t[21]||(t[21]=r("div",null,[r("strong",null,"Score Breakdown:")],-1)),r("div",null,[t[18]||(t[18]=c("Case name match: ")),r("span",{class:v({"text-success":e.primary.case_name&&"N/A"!==e.primary.case_name})},o(e.primary.case_name&&"N/A"!==e.primary.case_name?"+2":"0"),3)]),r("div",null,[t[19]||(t[19]=c("Hinted name similarity: ")),r("span",{class:v({"text-success":Ut(e.primary)>=.5})},o(Ut(e.primary)>=.5?"+1":"0"),3)]),r("div",null,[t[20]||(t[20]=c("Year match: ")),r("span",{class:v({"text-success":Bt(e.primary)&&$t(e.primary)&&Bt(e.primary).substring(0,4)===$t(e.primary).substring(0,4)})},o(Bt(e.primary)&&$t(e.primary)&&Bt(e.primary).substring(0,4)===$t(e.primary).substring(0,4)?"+1":"0"),3)])])):n("",!0)],42,ve),r("div",me,[e.primary.verified&&Ht(e.primary)?(i(),s("a",{key:0,href:Ht(e.primary),target:"_blank",class:"case-name-link",title:"View case details"},o(Rt(e.primary)||"Unknown Case"),9,ye)):(i(),s("span",ge,o(Rt(e.primary)||"Unknown Case"),1))]),r("div",fe,[e.primary.verified&&Ht(e.primary)?(i(),s("a",{key:0,href:Ht(e.primary),target:"_blank",class:"citation-hyperlink",title:"View case details"},o(Wt(e.primary)),9,he)):(i(),s("span",_e,o(Wt(e.primary)),1)),e.isComplex?(i(),s("span",be," 🔗 ")):n("",!0)])]),r("div",ke,[r("button",{onClick:a=>{return t=e.primary,void(w.value.has(t.citation)?w.value.delete(t.citation):w.value.add(t.citation));var t},class:v(["expand-btn",{expanded:w.value.has(e.primary.citation)}]),title:w.value.has(e.primary.citation)?"Hide details":"Show details"},o(w.value.has(e.primary.citation)?"▼":"▶"),11,xe)])]),w.value.has(e.primary.citation)?(i(),s("div",we,[r("div",Ce,[t[29]||(t[29]=r("h4",{class:"section-title"},"Citation Information",-1)),r("div",Ae,[t[23]||(t[23]=r("span",{class:"detail-label"},"Citation Text:",-1)),t[24]||(t[24]=c()),r("span",Le,o(Wt(e.primary)),1)]),e.primary.id?(i(),s("div",Pe,[t[25]||(t[25]=r("span",{class:"detail-label"},"Database ID:",-1)),t[26]||(t[26]=c()),r("span",Se,o(e.primary.id),1)])):n("",!0),r("div",Te,[t[27]||(t[27]=r("span",{class:"detail-label"},"Status:",-1)),t[28]||(t[28]=c()),r("span",{class:v(["detail-value",e.primary.verified?"verified":"invalid"])},o(e.primary.verified?"Verified":"Not Verified"),3)])]),r("div",ze,[t[39]||(t[39]=r("h4",{class:"section-title"},"Case Information",-1)),r("div",Ie,[t[30]||(t[30]=r("span",{class:"detail-label"},"Canonical Case Name:",-1)),t[31]||(t[31]=c()),r("span",Me,o(Rt(e.primary)||"N/A"),1)]),r("div",De,[t[32]||(t[32]=r("span",{class:"detail-label"},"Extracted Case Name:",-1)),t[33]||(t[33]=c()),r("span",Ne,o(Vt(e.primary)||"N/A"),1)]),r("div",Re,[t[34]||(t[34]=r("span",{class:"detail-label"},"Hinted Case Name:",-1)),t[35]||(t[35]=c()),r("span",Ve,o(e.primary.hinted_case_name||"N/A"),1)]),null!==Ut(e.primary)?(i(),s("div",Ue,[t[36]||(t[36]=r("span",{class:"detail-label"},"Name Similarity:",-1)),t[37]||(t[37]=c()),r("span",{class:v(["detail-value",(l=Ut(e.primary),l>=.8?"high-similarity":l>=.6?"medium-similarity":"low-similarity")])},o((100*Ut(e.primary)).toFixed(1))+"%",3)])):n("",!0),Ft(e.primary)?(i(),s("div",Fe,t[38]||(t[38]=[r("span",{class:"detail-label"},"Name Mismatch:",-1),c(),r("span",{class:"detail-value warning"},"⚠️ Case names differ significantly",-1)]))):n("",!0)]),r("div",qe,[t[50]||(t[50]=r("h4",{class:"section-title"},"Citation Components",-1)),e.primary.volume?(i(),s("div",Ee,[t[40]||(t[40]=r("span",{class:"detail-label"},"Volume:",-1)),t[41]||(t[41]=c()),r("span",je,o(e.primary.volume),1)])):n("",!0),e.primary.reporter?(i(),s("div",Be,[t[42]||(t[42]=r("span",{class:"detail-label"},"Reporter:",-1)),t[43]||(t[43]=c()),r("span",$e,o(e.primary.reporter),1)])):n("",!0),e.primary.page?(i(),s("div",Oe,[t[44]||(t[44]=r("span",{class:"detail-label"},"Page:",-1)),t[45]||(t[45]=c()),r("span",He,o(e.primary.page),1)])):n("",!0),e.primary.year?(i(),s("div",Je,[t[46]||(t[46]=r("span",{class:"detail-label"},"Year:",-1)),t[47]||(t[47]=c()),r("span",Ye,o(e.primary.year),1)])):n("",!0),e.primary.court?(i(),s("div",Ge,[t[48]||(t[48]=r("span",{class:"detail-label"},"Court:",-1)),t[49]||(t[49]=c()),r("span",Xe,o(e.primary.court),1)])):n("",!0)]),jt(e.primary)||Bt(e.primary)||$t(e.primary)?(i(),s("div",Ke,[t[59]||(t[59]=r("h4",{class:"section-title"},"Decision Information",-1)),r("div",Qe,[t[51]||(t[51]=r("span",{class:"detail-label"},"Extracted Date:",-1)),t[52]||(t[52]=c()),r("span",We,o(Gt(Bt(e.primary))||"N/A"),1)]),$t(e.primary)?(i(),s("div",Ze,[t[53]||(t[53]=r("span",{class:"detail-label"},"Canonical Date (Case Name):",-1)),t[54]||(t[54]=c()),r("span",ea,o(Gt($t(e.primary))),1)])):n("",!0),jt(e.primary)?(i(),s("div",aa,[t[55]||(t[55]=r("span",{class:"detail-label"},"Canonical Date (Verified):",-1)),t[56]||(t[56]=c()),r("span",ta,o(Gt(jt(e.primary))),1)])):n("",!0),Bt(e.primary)&&jt(e.primary)?(i(),s("div",la,[t[57]||(t[57]=r("span",{class:"detail-label"},"Date Match:",-1)),t[58]||(t[58]=c()),r("span",{class:v(["detail-value",Bt(e.primary)===jt(e.primary)?"high-similarity":"low-similarity"])},o(Bt(e.primary)===jt(e.primary)?"✓ Match":"✗ Different"),3)])):n("",!0)])):n("",!0),e.primary.context?(i(),s("div",sa,[t[60]||(t[60]=r("h4",{class:"section-title"},"Context",-1)),r("div",ia,o(e.primary.context),1)])):n("",!0),e.parallels.length>0?(i(),s("div",na,[t[62]||(t[62]=r("h4",{class:"section-title"},"Parallel Citations in This Cluster",-1)),r("div",ra,[(i(!0),s(u,null,d(e.parallels,((e,a)=>(i(),s("div",{key:a,class:"parallel-citation-item"},[t[61]||(t[61]=r("span",{class:"parallel-badge",title:"Parallel citation"},"🔗 Parallel",-1)),r("span",oa,o(e.citation),1),"true_by_parallel"===e.verified?(i(),s("span",ca,"✓ Inherited")):n("",!0)])))),128))])])):n("",!0),r("div",ua,[t[69]||(t[69]=r("h4",{class:"section-title"},"Verification Details",-1)),r("div",da,[t[63]||(t[63]=r("span",{class:"detail-label"},"Source:",-1)),t[64]||(t[64]=c()),r("span",va,o(Jt(e.primary)||"N/A"),1)]),void 0!==e.primary.confidence?(i(),s("div",pa,[t[65]||(t[65]=r("span",{class:"detail-label"},"Confidence:",-1)),t[66]||(t[66]=c()),r("span",ma,o((100*e.primary.confidence).toFixed(1))+"%",1)])):n("",!0),Yt(e.primary)?(i(),s("div",ya,[t[67]||(t[67]=r("span",{class:"detail-label"},"Note:",-1)),t[68]||(t[68]=c()),r("span",ga,o(Yt(e.primary)),1)])):n("",!0)]),e.isComplex&&e.primary.complex_metadata?(i(),s("div",fa,[t[77]||(t[77]=r("h4",{class:"section-title"},"Complex Citation Details",-1)),r("div",ha,[e.primary.complex_metadata.primary_citation?(i(),s("div",_a,[t[70]||(t[70]=r("span",{class:"detail-label"},"Primary Citation:",-1)),r("span",ba,o(e.primary.complex_metadata.primary_citation),1)])):n("",!0),e.primary.complex_metadata.parallel_citations&&e.primary.complex_metadata.parallel_citations.length>0?(i(),s("div",ka,[t[71]||(t[71]=r("span",{class:"detail-label"},"Parallel Citations:",-1)),r("div",xa,[(i(!0),s(u,null,d(e.primary.complex_metadata.parallel_citations,((e,a)=>(i(),s("span",{key:a,class:"parallel-citation-tag"},o(e),1)))),128))])])):n("",!0),e.primary.complex_metadata.pinpoint_pages&&e.primary.complex_metadata.pinpoint_pages.length>0?(i(),s("div",wa,[t[72]||(t[72]=r("span",{class:"detail-label"},"Pinpoint Pages:",-1)),r("span",Ca,o(e.primary.complex_metadata.pinpoint_pages.join(", ")),1)])):n("",!0),e.primary.complex_metadata.docket_numbers&&e.primary.complex_metadata.docket_numbers.length>0?(i(),s("div",Aa,[t[73]||(t[73]=r("span",{class:"detail-label"},"Docket Numbers:",-1)),r("span",La,o(e.primary.complex_metadata.docket_numbers.join(", ")),1)])):n("",!0),e.primary.complex_metadata.case_history&&e.primary.complex_metadata.case_history.length>0?(i(),s("div",Pa,[t[74]||(t[74]=r("span",{class:"detail-label"},"Case History:",-1)),r("span",Sa,o(e.primary.complex_metadata.case_history.join(", ")),1)])):n("",!0),e.primary.complex_metadata.publication_status?(i(),s("div",Ta,[t[75]||(t[75]=r("span",{class:"detail-label"},"Publication Status:",-1)),r("span",za,o(e.primary.complex_metadata.publication_status),1)])):n("",!0),e.primary.complex_metadata.year?(i(),s("div",Ia,[t[76]||(t[76]=r("span",{class:"detail-label"},"Year:",-1)),r("span",Ma,o(e.primary.complex_metadata.year),1)])):n("",!0)])])):n("",!0)])):n("",!0)],2)):n("",!0),e.parallels.length>0?(i(),s("div",Da,[(i(!0),s(u,null,d(e.parallels,(e=>(i(),s("div",{key:e.citation,class:v(["citation-item","parallel-item",{verified:e.verified,invalid:!e.verified}])},[r("div",Na,[r("div",Ra,[t[78]||(t[78]=r("div",{class:"parallel-badge",title:"Parallel citation"}," 🔗 Parallel ",-1)),"true_by_parallel"===e.verified?(i(),s("div",Va," ✓ Inherited ")):n("",!0),r("div",Ua,[r("span",null,o(Rt(e)||"Unknown Case"),1)]),r("div",Fa,[r("span",qa,o(Wt(e)),1)])])])],2)))),128))])):n("",!0)])})),128))],64)))),128)),S.value>1?(i(),s("div",Ea,[r("button",{onClick:t[1]||(t[1]=e=>k.value--),disabled:k.value<=1,class:"pagination-btn"}," ← Previous ",8,ja),r("span",Ba,"Page "+o(k.value)+" of "+o(S.value),1),r("button",{onClick:t[2]||(t[2]=e=>k.value++),disabled:k.value>=S.value,class:"pagination-btn"}," Next → ",8,$a)])):n("",!0)])):n("",!0),0===P.value.length&&a.results.citations.length>0?(i(),s("div",Oa,t[79]||(t[79]=[r("div",{class:"empty-icon"},"🔍",-1),r("h3",null,"No citations match your filter",-1),r("p",null,"Try adjusting your search or filter criteria",-1)]))):n("",!0)])):(i(),s("div",Ha,t[80]||(t[80]=[r("div",{class:"no-results-icon"},"📄",-1),r("h3",null,"No Citations Found",-1),r("p",null,"The document didn't contain any recognizable legal citations",-1)]))),x.value?(i(),s("div",{key:4,class:"modal-overlay",onClick:el},[r("div",{class:"modal-content",onClick:t[3]||(t[3]=y((()=>{}),["stop"]))},[r("div",{class:"modal-header"},[t[81]||(t[81]=r("h3",null,"Citation Details",-1)),r("button",{onClick:el,class:"modal-close"},"×")]),r("div",Ja,[r("div",Ya,[t[85]||(t[85]=r("h4",null,"Citation Information",-1)),r("div",Ga,[r("div",Xa,[t[82]||(t[82]=r("span",{class:"detail-label"},"Citation Text:",-1)),r("span",Ka,o(Wt(x.value)),1)]),r("div",Qa,[t[83]||(t[83]=r("span",{class:"detail-label"},"Database ID:",-1)),r("span",Wa,o(x.value.id||"N/A"),1)]),r("div",Za,[t[84]||(t[84]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:v(["detail-value",x.value.verified?"verified":"invalid"])},o(x.value.verified?"Verified":"Not Verified"),3)])])]),r("div",et,[t[91]||(t[91]=r("h4",null,"Citation Components",-1)),r("div",at,[x.value.volume?(i(),s("div",tt,[t[86]||(t[86]=r("span",{class:"detail-label"},"Volume:",-1)),r("span",lt,o(x.value.volume),1)])):n("",!0),x.value.reporter?(i(),s("div",st,[t[87]||(t[87]=r("span",{class:"detail-label"},"Reporter:",-1)),r("span",it,o(x.value.reporter),1)])):n("",!0),x.value.page?(i(),s("div",nt,[t[88]||(t[88]=r("span",{class:"detail-label"},"Page:",-1)),r("span",rt,o(x.value.page),1)])):n("",!0),x.value.year?(i(),s("div",ot,[t[89]||(t[89]=r("span",{class:"detail-label"},"Year:",-1)),r("span",ct,o(x.value.year),1)])):n("",!0),x.value.court?(i(),s("div",ut,[t[90]||(t[90]=r("span",{class:"detail-label"},"Court:",-1)),r("span",dt,o(x.value.court),1)])):n("",!0)])]),r("div",vt,[t[96]||(t[96]=r("h4",null,"Verification Details",-1)),r("div",pt,[x.value.verification_source?(i(),s("div",mt,[t[92]||(t[92]=r("span",{class:"detail-label"},"Verification Source:",-1)),r("span",yt,o(x.value.verification_source),1)])):n("",!0),void 0!==x.value.verification_confidence?(i(),s("div",gt,[t[93]||(t[93]=r("span",{class:"detail-label"},"Verification Confidence:",-1)),r("span",ft,o((100*x.value.verification_confidence).toFixed(1))+"%",1)])):n("",!0),void 0!==x.value.verification_count?(i(),s("div",ht,[t[94]||(t[94]=r("span",{class:"detail-label"},"Times Verified:",-1)),r("span",_t,o(x.value.verification_count),1)])):n("",!0),void 0!==x.value.error_count?(i(),s("div",bt,[t[95]||(t[95]=r("span",{class:"detail-label"},"Verification Errors:",-1)),r("span",kt,o(x.value.error_count),1)])):n("",!0)])]),r("div",xt,[t[100]||(t[100]=r("h4",null,"Database Timestamps",-1)),r("div",wt,[x.value.created_at?(i(),s("div",Ct,[t[97]||(t[97]=r("span",{class:"detail-label"},"First Added:",-1)),r("span",At,o(al(x.value.created_at)),1)])):n("",!0),x.value.updated_at?(i(),s("div",Lt,[t[98]||(t[98]=r("span",{class:"detail-label"},"Last Updated:",-1)),r("span",Pt,o(al(x.value.updated_at)),1)])):n("",!0),x.value.last_verified_at?(i(),s("div",St,[t[99]||(t[99]=r("span",{class:"detail-label"},"Last Verified:",-1)),r("span",Tt,o(al(x.value.last_verified_at)),1)])):n("",!0)])]),x.value.verification_result?(i(),s("div",zt,[t[101]||(t[101]=r("h4",null,"Raw Verification Data",-1)),r("div",It,[r("pre",null,o(tl(x.value.verification_result)),1)])])):n("",!0),Zt(x.value)&&Zt(x.value).length>0?(i(),s("div",Mt,[t[102]||(t[102]=r("h4",null,"Additional Parallel Citations",-1)),r("div",Dt,[(i(!0),s(u,null,d(Zt(x.value),((e,a)=>(i(),s("span",{key:a,class:"parallel-citation"},o((e=>{if(!e)return"";if("string"==typeof e)return e;if("object"==typeof e){if(e.citation)return e.citation;if(e.cite)return e.cite;if(e.text)return e.text;if(e.volume||e.reporter||e.page){const a=e.volume||"",t=e.reporter||"",l=e.page||"",s=e.year||"";let i=[a,t,l].filter(Boolean).join(" ");if(s&&i&&!i.includes(s)&&(i+=` (${s})`),i)return i}return String(e)}return String(e)})(e)),1)))),128))])])):n("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:el,class:"btn btn-secondary"},"Close")])])])):n("",!0)]))}},[["__scopeId","data-v-fc48ebae"]]),Rt={class:"unified-input"},Vt={class:"input-methods-top"},Ut={class:"method-icon"},Ft={class:"method-content"},qt={key:0,class:"active-indicator"},Et={class:"method-icon"},jt={class:"method-content"},Bt={key:0,class:"active-indicator"},$t={key:0,class:"input-area-top"},Ot={key:0,class:"file-input"},Ht=["disabled"],Jt={key:0,class:"drop-zone-content"},Yt={key:1,class:"file-info"},Gt={class:"file-details"},Xt={key:0,class:"validation-errors"},Kt={key:1,class:"url-input"},Qt=["disabled"],Wt={class:"input-footer"},Zt={key:0,class:"url-preview"},el={key:1,class:"url-error"},al={key:0,class:"validation-errors"},tl={class:"input-methods-bottom"},ll={class:"method-icon"},sl={class:"method-content"},il={key:0,class:"active-indicator"},nl={class:"method-icon"},rl={class:"method-content"},ol={key:0,class:"active-indicator"},cl={class:"analyze-section"},ul=["disabled"],dl={key:0,class:"analyzing-spinner"},vl={key:1,class:"analyze-icon"},pl={key:0,class:"validation-summary"},ml={key:1,class:"input-area-bottom"},yl={key:0,class:"text-input"},gl=["disabled"],fl={class:"input-footer"},hl={key:0,class:"min-length-hint"},_l={key:0,class:"validation-errors"},bl={key:1,class:"quick-citation-input-area"},kl=["disabled"],xl={__name:"UnifiedInput",props:{isAnalyzing:{type:Boolean,default:!1}},emits:["analyze"],setup(a,{emit:l}){const f=a,h=l,_="Paste Text",b="URL",k="Upload File",x="Quick Citation",w="Paste legal text or citations directly",C="Analyze content from a web URL",A="Upload a document for analysis",L="Enter a single citation and analyze instantly",P="📝",S="🔗",T="📁",z="🔎",I={minLength:10,maxLength:5e4,minLengthMessage:"Text must be at least 10 characters long",maxLengthMessage:"Text is too long. Maximum 50,000 characters allowed."},M={maxLength:2048,maxLengthMessage:"URL is too long. Maximum 2,048 characters allowed."},D={maxSize:52428800,allowedTypes:[".pdf",".doc",".docx",".txt"],maxSizeMessage:"File is too large. Maximum 50MB allowed.",typeMessage:"Invalid file type. Please upload PDF, DOC, DOCX, or TXT files."},N=e("text"),R=e(""),V=e(""),U=e(null),F=e(!1),q=e(null),E=e(""),j=e({}),B=e({text:!1,url:!1,file:!1,quick:!1}),$=e(!1);function O(){const e={};"text"===N.value?e.text=function(e){const a=[],t=I;return e.trim()?e.length<t.minLength?a.push(t.minLengthMessage):e.length>t.maxLength&&a.push(t.maxLengthMessage):a.push("Text is required"),/[\x00-\x08\x0B\x0C\x0E-\x1F]/.test(e)&&a.push("Text contains invalid characters. Please remove any special characters."),a}(R.value):"url"===N.value?e.url=function(e){const a=[],t=M;return e.trim()?e.length>t.maxLength?a.push(t.maxLengthMessage):/^https?:\/\//.test(e)?/\./.test(e)||a.push("URL must contain a dot"):a.push("URL must start with http:// or https://"):a.push("URL is required"),a}(V.value):"file"===N.value&&(e.file=function(e){const a=[],t=D;if(e){e.size>t.maxSize&&a.push(t.maxSizeMessage),0===e.size&&a.push("File is empty");const l="."+e.name.split(".").pop().toLowerCase();t.allowedTypes.includes(l)||a.push(t.typeMessage)}else a.push("Please select a file");return a}(U.value)),j.value=e}function H(){B.value[N.value]=!0,$.value=!1,O()}const J=t((()=>j.value[N.value]||[])),Y=t((()=>J.value.length>0)),G=t((()=>{let e=!1;return!f.isAnalyzing&&("text"===N.value?e=R.value.length>=I.minLength&&R.value.length<=I.maxLength:"url"===N.value?e=V.value.length>0:"file"===N.value?e=!!U.value:"quick"===N.value&&(e=E.value.trim().length>0),e)}));function X(e){e.preventDefault(),e.stopPropagation(),U.value=e.target.files[0]||null,F.value=!1,H()}function K(e){e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.files[0];a&&(U.value=a,H()),F.value=!1}function Q(){var e;f.isAnalyzing||null==(e=q.value)||e.click()}function W(){U.value=null,q.value&&(q.value.value=""),H()}function Z(){if(G.value)if($.value=!1,"text"===N.value)h("analyze",{text:R.value,type:"text"});else if("url"===N.value)h("analyze",{url:V.value,type:"url"});else if("file"===N.value){const e=new FormData;e.append("file",U.value),e.append("type","file"),h("analyze",e)}else"quick"===N.value&&(h("analyze",{text:E.value.trim(),type:"text",quick:!0}),E.value="");else $.value=!0}function ee(e){if(!e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]}function ae(){j.value={},B.value={text:!1,url:!1,file:!1,quick:!1},$.value=!1,O()}return(e,t)=>(i(),s("div",Rt,[r("div",Vt,[r("div",{class:v(["input-method-card",{active:"file"===N.value,disabled:a.isAnalyzing}]),onClick:t[0]||(t[0]=e=>!a.isAnalyzing&&(N.value="file",ae()))},[r("div",Ut,o(T),1),r("div",Ft,[r("h4",null,o(k),1),r("p",null,o(A),1)]),"file"===N.value?(i(),s("div",qt,"✓")):n("",!0)],2),r("div",{class:v(["input-method-card",{active:"url"===N.value,disabled:a.isAnalyzing}]),onClick:t[1]||(t[1]=e=>!a.isAnalyzing&&(N.value="url",ae()))},[r("div",Et,o(S),1),r("div",jt,[r("h4",null,o(b),1),r("p",null,o(C),1)]),"url"===N.value?(i(),s("div",Bt,"✓")):n("",!0)],2)]),"file"===N.value||"url"===N.value?(i(),s("div",$t,["file"===N.value?(i(),s("div",Ot,[t[12]||(t[12]=r("label",null,"Upload a document",-1)),r("div",{class:v(["file-drop-zone",{"has-file":U.value,dragover:F.value,error:Y.value&&B.value.file}]),onDrop:K,onDragover:t[2]||(t[2]=y((e=>F.value=!0),["prevent"])),onDragleave:t[3]||(t[3]=y((e=>F.value=!1),["prevent"])),onClick:Q},[r("input",{ref_key:"fileInput",ref:q,id:"fileInput",type:"file",onChange:X,disabled:a.isAnalyzing,accept:".pdf,.doc,.docx,.txt",style:{display:"none"}},null,40,Ht),U.value?(i(),s("div",Yt,[t[10]||(t[10]=r("div",{class:"file-icon"},"📄",-1)),r("div",Gt,[r("strong",null,o(U.value.name),1),r("span",null,o(ee(U.value.size)),1)]),a.isAnalyzing?n("",!0):(i(),s("button",{key:0,onClick:y(W,["stop"]),class:"clear-file-btn"}," ✕ "))])):(i(),s("div",Jt,t[9]||(t[9]=[r("div",{class:"upload-icon"},"📁",-1),r("p",null,"Click to browse or drag & drop",-1),r("p",{class:"file-types"},"Supports: PDF, DOC, DOCX, TXT (max 50MB)",-1)])))],34),Y.value&&B.value.file?(i(),s("div",Xt,[(i(!0),s(u,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[11]||(t[11]=r("span",{class:"error-icon"},"⚠️",-1)),c(" "+o(e),1)])))),128))])):n("",!0)])):"url"===N.value?(i(),s("div",Kt,[t[14]||(t[14]=r("label",null,"Enter URL to analyze",-1)),p(r("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>V.value=e),type:"url",placeholder:"https://example.com/document.pdf",disabled:a.isAnalyzing,onInput:H,class:v({error:Y.value&&B.value.url})},null,42,Qt),[[m,V.value]]),r("div",Wt,[V.value&&!Y.value?(i(),s("span",Zt,"Will analyze: "+o(V.value),1)):V.value&&Y.value?(i(),s("span",el,"Invalid URL format")):n("",!0)]),Y.value&&B.value.url?(i(),s("div",al,[(i(!0),s(u,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[13]||(t[13]=r("span",{class:"error-icon"},"⚠️",-1)),c(" "+o(e),1)])))),128))])):n("",!0)])):n("",!0)])):n("",!0),r("div",tl,[r("div",{class:v(["input-method-card",{active:"quick"===N.value,disabled:a.isAnalyzing}]),onClick:t[5]||(t[5]=e=>!a.isAnalyzing&&(N.value="quick",ae()))},[r("div",ll,o(z),1),r("div",sl,[r("h4",null,o(x),1),r("p",null,o(L),1)]),"quick"===N.value?(i(),s("div",il,"✓")):n("",!0)],2),r("div",{class:v(["input-method-card",{active:"text"===N.value,disabled:a.isAnalyzing}]),onClick:t[6]||(t[6]=e=>!a.isAnalyzing&&(N.value="text",ae()))},[r("div",nl,o(P),1),r("div",rl,[r("h4",null,o(_),1),r("p",null,o(w),1)]),"text"===N.value?(i(),s("div",ol,"✓")):n("",!0)],2)]),r("div",cl,[r("button",{class:v(["analyze-btn",{disabled:!G.value||a.isAnalyzing}]),disabled:!G.value||a.isAnalyzing,onClick:Z},[a.isAnalyzing?(i(),s("span",dl)):(i(),s("span",vl,"🔍")),c(" "+o(a.isAnalyzing?"Analyzing...":"Analyze Content"),1)],10,ul),$.value&&Y.value?(i(),s("div",pl,t[15]||(t[15]=[r("p",null,"Please fix the errors above before analyzing",-1)]))):n("",!0)]),"text"===N.value||"quick"===N.value?(i(),s("div",ml,["text"===N.value?(i(),s("div",yl,[t[17]||(t[17]=r("label",null,"Paste your text here",-1)),p(r("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>R.value=e),placeholder:"Paste legal text, citations, or document content here...",disabled:a.isAnalyzing,rows:"6",onInput:H,class:v({error:Y.value&&B.value.text})},null,42,gl),[[m,R.value]]),r("div",fl,[r("span",{class:v(["char-count",{error:R.value.length>I.maxLength}])},o(R.value.length)+" / "+o(I.maxLength)+" characters ",3),R.value.length<I.minLength&&B.value.text?(i(),s("span",hl," Minimum "+o(I.minLength)+" characters required ",1)):n("",!0)]),Y.value&&B.value.text?(i(),s("div",_l,[(i(!0),s(u,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[16]||(t[16]=r("span",{class:"error-icon"},"⚠️",-1)),c(" "+o(e),1)])))),128))])):n("",!0)])):"quick"===N.value?(i(),s("div",bl,[t[18]||(t[18]=r("label",null,"Enter a single citation",-1)),p(r("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>E.value=e),type:"text",placeholder:"Enter citation...",disabled:a.isAnalyzing,onKeyup:g(Z,["enter"]),class:"quick-citation-input"},null,40,kl),[[m,E.value]])])):n("",!0)])):n("",!0)]))}},wl={class:"toast-icon"},Cl={class:"toast-message"},Al={class:"enhanced-validator"},Ll={class:"header text-center mb-4"},Pl={class:"main-content"},Sl={key:0,class:"progress-container"},Tl={key:1,class:"processing-section mb-4"},zl={key:2,class:"processing-section mb-4"},Il={class:"card processing-card"},Ml={class:"card-body text-center"},Dl={class:"processing-content"},Nl={class:"progress-info mb-3"},Rl={class:"progress-stats"},Vl={class:"stat"},Ul={class:"stat"},Fl={class:"progress-container"},ql={class:"progress",style:{height:"1.5rem","border-radius":"0.75rem"}},El=["aria-valuenow"],jl={class:"progress-text"},Bl={class:"progress-label mt-2"},$l={class:"text-muted"},Ol={class:"processing-steps mt-4"},Hl={key:3,class:"results-container"},Jl={key:4,class:"error-container"},Yl={class:"error-card"},Gl={key:5,class:"no-results-state text-center mt-5"};const Xl=S({name:"EnhancedValidator",components:{CitationResults:Nt,UnifiedInput:S(xl,[["__scopeId","data-v-5acecf32"]]),Toast:S({__name:"Toast",props:{message:String,type:{type:String,default:"info"},duration:{type:Number,default:3500}},emits:["close"],setup(a,{emit:c}){const u=a,d=c,p=e(!0),m=t((()=>"success"===u.type?"✅":"error"===u.type?"❌":"ℹ️"));function y(){p.value=!1,d("close")}return l((()=>u.message),(e=>{e&&(p.value=!0,setTimeout(y,u.duration))})),(e,t)=>(i(),f(_,{name:"toast-fade"},{default:h((()=>[p.value?(i(),s("div",{key:0,class:v(["toast",a.type])},[r("span",wl,o(m.value),1),r("span",Cl,o(a.message),1),r("button",{class:"toast-close",onClick:y},"×")],2)):n("",!0)])),_:1}))}},[["__scopeId","data-v-a1e0936f"]]),SkeletonLoader:S({__name:"SkeletonLoader",props:{lines:{type:Number,default:3},height:{type:String,default:"auto"},width:{type:String,default:"100%"}},setup:e=>(a,t)=>(i(),s("div",{class:"skeleton-loader",style:b({height:e.height,width:e.width})},[(i(!0),s(u,null,d(e.lines,(e=>(i(),s("div",{key:e,class:"skeleton-line"})))),128))],4))},[["__scopeId","data-v-1c57e4a2"]])},setup(){const s=C();L();const i=e(null),n=e(null),{isLoading:r,cancel:o}=function(t={}){const{loadingMessage:l="Loading...",showLoading:s=!0,onSuccess:i,onError:n,onFinally:r}=t,o=e(null),c=e(null),u=e(!1),d=e(null);let v=null,p=null;const m=`api_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return a((()=>{p&&p.abort(),v&&v.remove()})),{execute:async function(e,a={}){var y;const{message:g=l,showLoader:f=s,signal:h,..._}={...t,...a};c.value=null,d.value=null,o.value=null,f&&(v=P(m,{message:g})),u.value=!0,"undefined"!=typeof AbortController&&(p=new AbortController,_.signal=h||p.signal);try{const a=await e({..._,signal:_.signal});return o.value=a.data||a,d.value=a.status||200,i&&i(a),a}catch(b){throw c.value=b,d.value=(null==(y=b.response)?void 0:y.status)||0,n&&n(b),b}finally{u.value=!1,v&&(c.value?v.error(c.value):v.complete(),v=null),r&&r(),p=null}},cancel:function(){p&&(p.abort(),p=null),v&&(v.remove(),v=null),u.value=!1},data:o,error:c,isLoading:u,status:d}}({loadingMessage:"Validating citation...",showLoading:!0}),c=e(!1),{isLoading:u}=function(){const e=(e,a="Loading...")=>{z.value=e,a&&(I.value=a)};return{isLoading:t((()=>z.value)),loadingMessage:t((()=>I.value)),setLoading:e,showLoading:a=>{e(!0,a)},hideLoading:()=>{e(!1)},toggleLoading:a=>{e(!z.value,a)}}}(),d=t((()=>r.value||u.value||c.value)),{elapsedTime:v,remainingTime:p,totalProgress:m,currentStep:y,currentStepProgress:g,processingSteps:f,actualTimes:h,citationInfo:_,rateLimitInfo:b,timeout:k,processingError:x,canRetry:S,startProcessing:M,stopProcessing:D,updateProgress:N,setSteps:R,resetProcessing:V,setProcessingError:U}=function(){const a=e(null),l=e(0),s=e(""),i=e(0),n=e([]),r=e({}),o=e(null),c=e(null),u=e(null),d=e(null),v=e(!1),p=t((()=>a.value?(Date.now()-a.value)/1e3:0)),m=t((()=>l.value?Math.max(0,l.value-p.value):0)),y=t((()=>l.value?Math.min(100,p.value/l.value*100):0)),g=t((()=>{if(!n.value.length)return 0;const e=n.value.findIndex((e=>e.step===s.value));if(-1===e)return 0;const a=n.value[e],t=p.value-(a.startTime||0);return Math.min(100,t/a.estimated_time*100)})),f=(e,a)=>{const t=n.value.findIndex((a=>a.step===e));-1!==t&&(0!==t&&100!==n.value[t-1].progress||(s.value=e,n.value[t].startTime||(n.value[t].startTime=Date.now())),n.value[t].progress=a,i.value=a)};return{startTime:a,estimatedTotalTime:l,currentStep:s,stepProgress:i,processingSteps:n,actualTimes:r,citationInfo:o,rateLimitInfo:c,timeout:u,processingError:d,canRetry:v,elapsedTime:p,remainingTime:m,totalProgress:y,currentStepProgress:g,startProcessing:e=>{var t;a.value=Date.now(),"object"==typeof e&&null!==e&&Array.isArray(e.steps)?(l.value=e.estimated_total_time,n.value=e.steps.map((e=>({step:e[0],estimated_time:e[1],startTime:null,progress:0}))),s.value=(null==(t=n.value[0])?void 0:t.step)||""):"number"==typeof e?(l.value=e,n.value=[],s.value=""):(l.value=0,n.value=[],s.value=""),i.value=0},stopProcessing:()=>{a.value=null,l.value=0,s.value="",i.value=0},updateProgress:e=>{"object"==typeof e&&e.step?f(e.step,e.progress||0):"number"==typeof e&&(i.value=e)},setSteps:e=>{Array.isArray(e)&&(n.value=e.map((e=>({step:"string"==typeof e?e:e.step,estimated_time:"object"==typeof e?e.estimated_time:10,startTime:null,progress:0}))))},resetProcessing:()=>{a.value=null,l.value=0,s.value="",i.value=0,n.value=[],r.value={},o.value=null,c.value=null,u.value=null,d.value=null,v.value=!1},setProcessingError:e=>{d.value=e,v.value=!0},updateStep:f,completeStep:e=>{f(e,100);const a=n.value.findIndex((a=>a.step===e))+1;a<n.value.length&&(s.value=n.value[a].step,n.value[a].startTime=Date.now())},updateActualTimes:e=>{r.value=e},reset:()=>{a.value=null,l.value=0,s.value="",i.value=0,n.value=[],r.value={},o.value=null,c.value=null,u.value=null,d.value=null,v.value=!1},formatTime:e=>e<60?`${Math.round(e)}s`:`${Math.floor(e/60)}m ${Math.round(e%60)}s`}}(),F=e(0),q=e(null),E=e(null),j=e(null);let B=e(null);const $=e(""),O=e("info"),H=(e,a="info")=>{$.value=e,O.value=a},J=e(null),Y=12e4,G=e(""),X=t((()=>_.value&&_.value.total>=35)),K=e(0),Q=t((()=>_.value&&_.value.total?_.value.total:0)),W=t((()=>Q.value?Math.min(100,Math.round(K.value/Q.value*100)):0)),Z=t((()=>W.value>=80?"bg-success":W.value>=50?"bg-info":W.value>=30?"bg-warning":"bg-danger"));let ee=null;function ae(){i.value=null,n.value=null,V()}function te(e){return(e||[]).map((e=>{let a=e.citation;Array.isArray(a)&&(a=a.join("; "));let t=!1;t="string"==typeof e.verified?"true"===e.verified||"true_by_parallel"===e.verified:!!e.verified;let l=0;if(e.case_name&&"N/A"!==e.case_name&&(l+=2),e.extracted_case_name&&"N/A"!==e.extracted_case_name&&e.case_name&&"N/A"!==e.case_name){const a=e.case_name.toLowerCase().split(/\s+/).filter((e=>e.length>2)),t=e.extracted_case_name.toLowerCase().split(/\s+/).filter((e=>e.length>2));a.filter((e=>t.includes(e))).length/Math.max(a.length,t.length)>=.5&&(l+=1)}if(e.extracted_date&&e.canonical_date){const a=e.extracted_date.toString().substring(0,4);a===e.canonical_date.toString().substring(0,4)&&4===a.length&&(l+=1)}let s="red";4===l||3===l?s="green":2===l?s="yellow":1===l&&(s="orange");return{...e,citation:a,verified:t,valid:t,score:l,scoreColor:s,case_name:e.case_name||"N/A",extracted_case_name:e.extracted_case_name||"N/A",hinted_case_name:e.hinted_case_name||"N/A",canonical_date:e.canonical_date||null,extracted_date:e.extracted_date||null,metadata:{case_name:e.case_name,canonical_date:e.canonical_date,court:e.court,confidence:e.confidence,method:e.method,pattern:e.pattern},details:{case_name:e.case_name,canonical_date:e.canonical_date,court:e.court,confidence:e.confidence,method:e.method,pattern:e.pattern}}}))}async function le(e){if(e)try{const a=(await T.get(`/task_status/${e}`)).data;if("completed"===a.status){const e=Array.isArray(a.results)?a.results:a.citations||[];if(i.value={citations:te(e),metadata:a.metadata||{},total_citations:e.length,verified_count:e.filter((e=>{var a,t;return e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found)})).length,unverified_count:e.filter((e=>{var a,t;return!(e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found))})).length},c.value=!1,D(),r.value=!1,void 0!==u&&void 0!==u.value&&(u.value=!1),H("Citation analysis completed successfully!","success"),j.value&&(clearInterval(j.value),j.value=null),0===e.length){let e="No citations found in the provided text or document.";a.status_message&&a.status_message.toLowerCase().includes("rate limit")&&(e+=" (Possible cause: search engine rate limiting)"),a.error&&(e+=` (Backend error: ${a.error})`),n.value=e}window&&window.localStorage&&"true"===window.localStorage.getItem("debugMode")&&(n.value+="\n[DEBUG] Raw backend response: "+JSON.stringify(a,null,2))}else"failed"===a.status?(n.value=a.error||"Processing failed",c.value=!1,U(a.error||"Processing failed"),H(`Processing failed: ${a.error||"Unknown error"}`,"error"),j.value&&(clearInterval(j.value),j.value=null)):(c.value=!0,a.estimated_total_time&&a.steps?B.value!==e&&(M({estimated_total_time:a.estimated_total_time,steps:a.steps}),B.value=e):a.estimated_total_time&&B.value!==e&&(M(a.estimated_total_time),B.value=e),a.current_step&&N({step:a.current_step,progress:a.progress||0}),void 0!==a.total_citations&&(_.value={total:a.total_citations,processed:a.processed_citations||0,unique:a.unique_citations||0}),j.value||(j.value=setInterval((()=>le(e)),2e3)));ue()}catch(a){n.value="Failed to check processing status",c.value=!1,U("Failed to check processing status"),j.value&&(clearInterval(j.value),j.value=null)}}const se=async(e,a)=>{try{"file"===a?await oe(e):"url"===a?await ce({url:e}):"text"===a&&await re({text:e})}catch(t){x.value=`Failed to analyze input: ${t.message}`,S.value=!0}},ie=e=>{try{const a=Array.isArray(e.validation_results)&&e.validation_results.length>0?e.validation_results:e.citations||[];i.value={...e,citations:te(a),timestamp:(new Date).toISOString()},r.value=!1,n.value=null,c.value=!1,E.value=null,void 0!==u&&void 0!==u.value&&(u.value=!1),A((()=>{const e=document.querySelector(".results-container");e&&e.scrollIntoView({behavior:"smooth"})}))}catch(a){n.value="Failed to process results",r.value=!1}},ne=e=>{n.value=e.message||"An error occurred during analysis",r.value=!1,c.value=!1,E.value=null,x.value=e.message||"Analysis failed",S.value=!0,H(n.value,"error")},re=async({text:e,options:a})=>{r.value=!0,n.value=null,i.value=null;try{const a=await T.post("/analyze",{text:e,type:"text"},{timeout:3e5});"processing"===a.data.status&&a.data.task_id?(c.value=!0,E.value=a.data.task_id,j.value||(j.value=setInterval((()=>le(a.data.task_id)),2e3))):(ie(a.data),r.value=!1)}catch(t){ne(t)}},oe=async e=>{r.value=!0,n.value=null,i.value=null;try{let a;e instanceof FormData?a=e:(a=new FormData,a.append("file",e.file),a.append("type","file"));const t=await T.post("/analyze",a,{headers:{"Content-Type":"multipart/form-data"},timeout:3e5});"processing"===t.data.status&&t.data.task_id?(c.value=!0,E.value=t.data.task_id,j.value||(j.value=setInterval((()=>le(t.data.task_id)),2e3))):(ie(t.data),r.value=!1)}catch(a){ne(a)}},ce=async({url:e})=>{r.value=!0,n.value=null,i.value=null;try{const a=await T.post("/analyze",{url:e,type:"url"},{timeout:3e5});"processing"===a.data.status&&a.data.task_id?(c.value=!0,E.value=a.data.task_id,j.value||(j.value=setInterval((()=>le(a.data.task_id)),2e3))):(ie(a.data),r.value=!1)}catch(a){ne(a)}};function ue(){J.value&&(clearTimeout(J.value),J.value=null)}return w((()=>{let e={...s.query};if(e.task_id)return E.value=e.task_id,c.value=!0,void le(e.task_id);if(!e.text&&!e.url&&!e.fileName&&localStorage.getItem("lastCitationInput"))try{e=JSON.parse(localStorage.getItem("lastCitationInput"))}catch(a){e={}}e.text||e.url||e.fileName?(ae(),e.text?re({text:e.text}):e.url?ce({url:e.url}):e.fileName&&(n.value="File upload not available from history. Please upload the file again.")):i.value=null,X.value&&Q.value>20&&(K.value=0,ee&&clearInterval(ee),ee=setInterval((()=>{K.value<Q.value&&K.value++}),2e3)),setTimeout((()=>{const e=document.querySelectorAll(".fas.fa-cog.fa-spin"),a=document.querySelectorAll(".bi.bi-gear-fill.spinning");e.forEach(((e,t)=>{-1===getComputedStyle(e).fontFamily.indexOf("FontAwesome")&&(e.style.display="none",a[t]&&(a[t].style.display="inline-block"))}))}),100)})),a((()=>{c.value&&o(),j.value&&(clearInterval(j.value),j.value=null),ue(),ee&&clearInterval(ee)})),l((()=>i.value),(e=>{e&&ee&&(K.value=Q.value,clearInterval(ee))})),{results:i,error:n,isLoading:d,showLoading:d,hasActiveRequest:c,clearResults:ae,handleUnifiedAnalyze:function(e){V(),R([{step:"Preparing analysis",estimated_time:5},{step:"Processing content",estimated_time:30},{step:"Verifying citations",estimated_time:60}]),M(),c.value=!0,n.value=null,i.value=null,e.file?oe(e):e.url?ce(e):e.text&&(e.quick,re({text:e.text,options:{}})),G.value="",ue(),J.value=setTimeout((()=>{G.value="Processing timed out. No response from server.",U(G.value),c.value=!1,H(G.value,"error")}),Y)},retryProcessing:async()=>{if(E.value)try{x.value=null,S.value=!1,V(),await T.cancelRequest(E.value);const e=T.getRequestStatus(E.value);if(e){const{type:a,input:t}=e;await se(t,a)}}catch(e){x.value=`Failed to retry: ${e.message}`,S.value=!0}},cancelValidation:o,copyResults:function(){},downloadResults:function(){},elapsedTime:v,remainingTime:p,totalProgress:m,currentStep:y,currentStepProgress:g,processingSteps:f,actualTimes:h,formatTime:function(e){if(!e||e<0)return"0s";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=Math.floor(e%60);return a>0?`${a}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`},citationInfo:_,queuePosition:F,estimatedQueueTime:q,rateLimitInfo:b,timeout:k,processingError:x,canRetry:S,getProgressBarClass:function(e){return e>=.8?"bg-success":e>=.5?"bg-info":e>=.3?"bg-warning":"bg-danger"},applyCorrection:()=>{},toastMessage:$,toastType:O,clearToast:()=>{$.value=""},fallbackError:G,showTimer:X,progressCurrent:K,progressTotal:Q,progressPercent:W,progressBarClass:Z}}},[["render",function(e,a,t,l,u,d){const p=k("Toast"),m=k("SkeletonLoader"),y=k("CitationResults");return i(),s("div",Al,[l.toastMessage?(i(),f(p,{key:0,message:l.toastMessage,type:l.toastType,onClose:l.clearToast},null,8,["message","type","onClose"])):n("",!0),r("div",Ll,[r("button",{class:"btn btn-link back-btn",onClick:a[0]||(a[0]=(...a)=>e.goHome&&e.goHome(...a))},a[1]||(a[1]=[r("i",{class:"bi bi-arrow-left"},null,-1),c(" Back to Home ")])),a[2]||(a[2]=r("h1",{class:"results-title"},"Citation Verification Results",-1))]),r("div",Pl,[l.showLoading&&!l.results?(i(),s("div",Sl,[x(m,{lines:4,height:"6em"})])):n("",!0),l.showLoading&&!l.showTimer?(i(),s("div",Tl,a[3]||(a[3]=[r("div",{class:"card processing-card"},[r("div",{class:"card-body text-center"},[r("div",{class:"processing-header"},[r("div",{class:"spinner-container"},[r("div",{class:"spinner-border text-primary",role:"status"},[r("span",{class:"visually-hidden"},"Processing...")])]),r("h5",{class:"card-title mt-3"},[r("i",{class:"fas fa-cog fa-spin me-2 text-primary"}),r("i",{class:"bi bi-gear-fill spinning me-2 text-primary",style:{display:"none"}}),c(" Processing Citations ")])]),r("div",{class:"processing-content"},[r("p",{class:"text-muted mb-3"},"Extracting and analyzing citations from your document..."),r("div",{class:"progress-dots"},[r("span",{class:"dot"}),r("span",{class:"dot"}),r("span",{class:"dot"})]),r("div",{class:"processing-steps mt-4"},[r("div",{class:"step active"},[r("i",{class:"bi bi-file-earmark-text text-primary"}),r("span",null,"Document Analysis")]),r("div",{class:"step"},[r("i",{class:"bi bi-search text-muted"}),r("span",null,"Citation Extraction")]),r("div",{class:"step"},[r("i",{class:"bi bi-check-circle text-muted"}),r("span",null,"Verification")])])])])],-1)]))):n("",!0),l.showLoading&&l.showTimer?(i(),s("div",zl,[r("div",Il,[r("div",Ml,[a[9]||(a[9]=r("div",{class:"processing-header"},[r("div",{class:"spinner-container"},[r("div",{class:"spinner-border text-primary",role:"status"},[r("span",{class:"visually-hidden"},"Processing...")])]),r("h5",{class:"card-title mt-3"},[r("i",{class:"fas fa-cog fa-spin me-2 text-primary"}),r("i",{class:"bi bi-gear-fill spinning me-2 text-primary",style:{display:"none"}}),c(" Processing Citations ")])],-1)),r("div",Dl,[r("div",Nl,[r("div",Rl,[r("span",Vl,[a[4]||(a[4]=r("i",{class:"bi bi-list-ol text-primary"},null,-1)),c(" "+o(l.progressCurrent)+" of "+o(l.progressTotal)+" citations ",1)]),r("span",Ul,[a[5]||(a[5]=r("i",{class:"bi bi-clock text-primary"},null,-1)),c(" "+o(l.formatTime(l.elapsedTime))+" elapsed ",1)])])]),r("div",Fl,[r("div",ql,[r("div",{class:v(["progress-bar progress-bar-striped progress-bar-animated",l.progressBarClass]),role:"progressbar",style:b({width:l.progressPercent+"%"}),"aria-valuenow":l.progressPercent,"aria-valuemin":"0","aria-valuemax":"100"},[r("span",jl,o(l.progressPercent)+"%",1)],14,El)]),r("div",Bl,[r("small",$l,o(100===l.progressPercent?"Finalizing results...":"Processing citations..."),1)])]),r("div",Ol,[r("div",{class:v(["step",{active:l.progressPercent<33}])},[r("i",{class:v(["bi bi-file-earmark-text",l.progressPercent<33?"text-primary":"text-success"])},null,2),a[6]||(a[6]=r("span",null,"Document Analysis",-1))],2),r("div",{class:v(["step",{active:l.progressPercent>=33&&l.progressPercent<66}])},[r("i",{class:v(["bi bi-search",l.progressPercent>=33&&l.progressPercent<66?"text-primary":l.progressPercent>=66?"text-success":"text-muted"])},null,2),a[7]||(a[7]=r("span",null,"Citation Extraction",-1))],2),r("div",{class:v(["step",{active:l.progressPercent>=66}])},[r("i",{class:v(["bi bi-check-circle",l.progressPercent>=66?"text-primary":"text-muted"])},null,2),a[8]||(a[8]=r("span",null,"Verification",-1))],2)])])])])])):n("",!0),l.results&&!l.showLoading?(i(),s("div",Hl,[x(y,{results:l.results,onApplyCorrection:l.applyCorrection,onCopyResults:l.copyResults,onDownloadResults:l.downloadResults,onToast:e.showToast},null,8,["results","onApplyCorrection","onCopyResults","onDownloadResults","onToast"])])):n("",!0),l.error&&!l.showLoading?(i(),s("div",Jl,[r("div",Yl,[a[10]||(a[10]=r("i",{class:"error-icon"},"❌",-1)),a[11]||(a[11]=r("h3",null,"Analysis Failed",-1)),r("p",null,o(l.error),1)])])):n("",!0),l.results||l.showLoading||l.error?n("",!0):(i(),s("div",Gl,a[12]||(a[12]=[r("p",{class:"lead"},[c("No results to display."),r("br"),c("Please return to the home page to start a new analysis.")],-1)])))])])}],["__scopeId","data-v-e2bf1042"]]);export{Xl as default};
