import{b as e}from"./index-D5v2aCTm.js";import"./vendor-CMnRMYmA.js";const t=new Set,r=e.create({timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});function s(e,t,r={}){const s=new Error(e);return t&&Object.getOwnPropertyNames(t).forEach((e=>{s[e]=t[e]})),Object.entries(r).forEach((([e,t])=>{s[e]=t})),s.isApiError=!0,s.timestamp=(new Date).toISOString(),s}r.interceptors.request.use((e=>{var r;const s=`${null==(r=e.method)?void 0:r.toUpperCase()}:${e.url}`;return t.add(s),e.metadata={startTime:new Date},e}),(e=>Promise.reject(s("Request failed to be sent",e)))),r.interceptors.response.use((e=>{var r,s;const o=`${null==(r=e.config.method)?void 0:r.toUpperCase()}:${e.config.url}`;t.delete(o);const n=new Date;null==(s=e.config.metadata)||s.startTime;return e.data}),(async e=>{var o,n,a,i;const u=e.config,l=`${null==(o=u.method)?void 0:o.toUpperCase()}:${u.url}`;t.delete(l);const c=s((null==(a=null==(n=e.response)?void 0:n.data)?void 0:a.message)||"An unexpected error occurred",e,{status:null==(i=e.response)?void 0:i.status,url:u.url,method:u.method}),d=!e.response||e.response.status>=500&&e.response.status<600,p=u._retryCount||0,m=u._maxRetries??3;if(d&&p<m){const e=(u._retryDelay??1e3)*Math.pow(2,p);return new Promise((t=>{setTimeout((()=>{u._retryCount=p+1,u._retryDelay=e,t(r(u))}),e)}))}return Promise.reject(c)})),r.cancelAllRequests=(e="User cancelled all requests")=>{t.clear()},r.hasActiveRequests=()=>t.size>0;export{r as default};
