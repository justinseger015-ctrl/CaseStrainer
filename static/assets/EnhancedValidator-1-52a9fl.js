import{r as e,D as a,p as t,c as s,o as l,b as i,l as n,B as r,t as o,x as c,F as u,n as d,g as v,E as p,v as m,y as g,A as f,G as y,h,z as b,H as k,w as _,T as x,f as w,d as C,s as A,u as T,C as z,I as S}from"./vendor-ByCRwmQi.js";import{c as L,_ as I}from"./index-B8WNTw1j.js";import{b as P,a as N}from"./api-CmsJ-okB.js";const R=e(!1),M=e("Loading...");const D={name:"ProcessingProgress",props:{elapsedTime:{type:Number,required:!0},remainingTime:{type:Number,required:!0},totalProgress:{type:Number,required:!0},currentStep:{type:String,default:""},currentStepProgress:{type:Number,default:0},processingSteps:{type:Array,default:()=>[]},actualTimes:{type:Object,default:()=>({})},citationInfo:{type:Object,default:null},rateLimitInfo:{type:Object,default:null},error:{type:String,default:""},canRetry:{type:Boolean,default:!1},timeout:{type:Number,default:null}},mounted(){},watch:{totalProgress(e){},remainingTime(e){}},computed:{currentStepElapsed(){const e=this.processingSteps.find(e=>e.step===this.currentStep);return e?Date.now()/1e3-e.start_time:0},currentStepRemaining(){const e=this.processingSteps.find(e=>e.step===this.currentStep);return e&&e.estimated_time?Math.max(0,e.estimated_time-this.currentStepElapsed):0},isTimeoutWarning(){if(!this.timeout)return!1;return this.timeout-this.elapsedTime<60}},methods:{formatTime(e){if(e<0)return"0s";const a=Math.floor(e/60),t=Math.round(e%60);return a>0?`${a}m ${t}s`:`${t}s`},getStepClass(e){return 100===e.progress?"completed":e.step===this.currentStep?"current":e.progress>0?"in-progress":"pending"},getStepStatus(e){return 100===e.progress?"Completed":e.step===this.currentStep?"In Progress":e.progress>0?`${e.progress}%`:"Pending"},formatProcessingRate(e){if(!e.processed||!this.elapsedTime)return"0/min";const a=e.processed/this.elapsedTime*60;return`${Math.round(a)}/min`}}},E={class:"processing-progress"},q={class:"progress-section"},F={class:"progress-bar"},U={class:"time-info"},$={key:0,class:"citation-section"},V={class:"citation-stats"},O={class:"stat"},B={class:"value"},j={class:"stat"},H={class:"value"},G={class:"stat"},W={class:"value"},X={key:0,class:"stat"},J={class:"value"},K={key:0,class:"rate-limit-info"},Q={class:"stat"},Z={class:"value"},Y={key:0,class:"stat"},ee={class:"value"},ae={key:1,class:"current-step"},te={class:"step-info"},se={class:"step-name"},le={class:"progress-bar"},ie={class:"time-info"},ne={class:"steps-section"},re={class:"steps-list"},oe={class:"step-header"},ce={class:"step-name"},ue={class:"step-status"},de={key:0,class:"progress-bar"},ve={key:1,class:"time-info"},pe={key:0},me={key:2,class:"error-section"},ge={class:"error-message"};const fe=I(D,[["render",function(e,a,t,p,m,g){return l(),s("div",E,[i("div",q,[a[1]||(a[1]=i("h3",null,"Overall Progress",-1)),i("div",F,[i("div",{class:"progress-fill",style:r({width:`${t.totalProgress}%`})},null,4)]),i("div",U,[i("span",null,"Elapsed: "+o(g.formatTime(t.elapsedTime)),1),i("span",null,"Remaining: "+o(g.formatTime(t.remainingTime)),1),t.timeout?(l(),s("span",{key:0,class:c(["timeout-info",{warning:g.isTimeoutWarning}])}," Timeout: "+o(g.formatTime(t.timeout-t.elapsedTime)),3)):n("",!0)])]),t.citationInfo?(l(),s("div",$,[a[8]||(a[8]=i("h3",null,"Citation Processing",-1)),i("div",V,[i("div",O,[a[2]||(a[2]=i("span",{class:"label"},"Total Citations:",-1)),i("span",B,o(t.citationInfo.total),1)]),i("div",j,[a[3]||(a[3]=i("span",{class:"label"},"Unique Citations:",-1)),i("span",H,o(t.citationInfo.unique),1)]),i("div",G,[a[4]||(a[4]=i("span",{class:"label"},"Processed:",-1)),i("span",W,o(t.citationInfo.processed),1)]),t.citationInfo.unique?(l(),s("div",X,[a[5]||(a[5]=i("span",{class:"label"},"Processing Rate:",-1)),i("span",J,o(g.formatProcessingRate(t.citationInfo)),1)])):n("",!0)]),t.rateLimitInfo?(l(),s("div",K,[i("div",Q,[a[6]||(a[6]=i("span",{class:"label"},"API Rate Limit:",-1)),i("span",Z,o(t.rateLimitInfo.remaining)+"/"+o(t.rateLimitInfo.limit),1)]),t.rateLimitInfo.resetTime?(l(),s("div",Y,[a[7]||(a[7]=i("span",{class:"label"},"Reset in:",-1)),i("span",ee,o(g.formatTime(t.rateLimitInfo.resetTime-Date.now()/1e3)),1)])):n("",!0)])):n("",!0)])):n("",!0),t.currentStep?(l(),s("div",ae,[a[9]||(a[9]=i("h3",null,"Current Step",-1)),i("div",te,[i("span",se,o(t.currentStep),1),i("div",le,[i("div",{class:"progress-fill",style:r({width:`${t.currentStepProgress}%`})},null,4)]),i("div",ie,[i("span",null,"Elapsed: "+o(g.formatTime(g.currentStepElapsed)),1),i("span",null,"Remaining: "+o(g.formatTime(g.currentStepRemaining)),1)])])])):n("",!0),i("div",ne,[a[10]||(a[10]=i("h3",null,"Processing Steps",-1)),i("div",re,[(l(!0),s(u,null,d(t.processingSteps,e=>(l(),s("div",{key:e.step,class:c(["step",g.getStepClass(e)])},[i("div",oe,[i("span",ce,o(e.step),1),i("span",ue,o(g.getStepStatus(e)),1)]),void 0!==e.progress?(l(),s("div",de,[i("div",{class:"progress-fill",style:r({width:`${e.progress}%`})},null,4)])):n("",!0),e.estimated_time?(l(),s("div",ve,[i("span",null,"Estimated: "+o(g.formatTime(e.estimated_time)),1),e.actual_time?(l(),s("span",pe,"Actual: "+o(g.formatTime(e.actual_time)),1)):n("",!0)])):n("",!0)],2))),128))])]),t.error?(l(),s("div",me,[i("div",ge,[a[11]||(a[11]=i("i",{class:"fas fa-exclamation-circle"},null,-1)),v(" "+o(t.error),1)]),t.canRetry?(l(),s("button",{key:0,onClick:a[0]||(a[0]=a=>e.$emit("retry")),class:"retry-button"}," Retry Processing ")):n("",!0)])):n("",!0)])}],["__scopeId","data-v-c1475ded"]]),ye={class:"citation-results"},he={key:0,class:"prominent-citations-section"},be={class:"citations-summary"},ke={class:"citations-grid"},_e={class:"citation-row",style:{color:"#dc3545","font-weight":"bold","font-size":"1.15rem"}},xe=["onClick"],we={class:"citation-parallel-item"},Ce=["href"],Ae={key:1,class:"citation-text"},Te={key:0},ze={class:"citation-row citation-row-canonical flex-names-row"},Se={class:"names-flex-wrap"},Le={class:"canonical-name-block"},Ie={key:1,class:"canonical-date missing"},Pe={key:1,class:"canonical-name missing"},Ne={key:0},Re={class:"citation-row citation-row-extracted flex-names-row"},Me={class:"names-flex-wrap"},De={class:"extracted-name-block"},Ee={key:1,class:"extracted-date missing"},qe={key:1,class:"extracted-name missing"},Fe={key:0},Ue={class:"citation-details"},$e={class:"detail-row"},Ve={class:"detail-row"},Oe={key:0,class:"detail-row"},Be={key:1,class:"loading-state"},je={key:2,class:"error-state"},He={key:3,class:"results-content"},Ge={class:"results-header"},We={class:"header-content"},Xe={class:"summary-stats"},Je={class:"stat-item verified"},Ke={class:"stat-number"},Qe={class:"stat-item invalid"},Ze={class:"stat-number"},Ye={class:"stat-item total"},ea={class:"stat-number"},aa={class:"action-buttons"},ta={class:"filter-section"},sa={class:"filter-controls"},la=["onClick"],ia={class:"layout-controls"},na={class:"search-box"},ra={class:"citations-list"},oa={key:0},ca={class:"cluster-header"},ua={key:0},da={key:1},va={key:2,class:"canonical-date"},pa={key:0,class:"extracted-info"},ma={class:"extracted-name"},ga={key:0,class:"extracted-date"},fa={class:"cluster-meta"},ya={class:"cluster-size"},ha={key:0},ba={key:0},ka=["href"],_a={class:"cluster-citations"},xa={class:"citation-row-content"},wa={class:"citation-score"},Ca=["title"],Aa={class:"citation-details"},Ta={class:"citation-text-line"},za=["href"],Sa={key:1,class:"citation-text"},La={class:"citation-meta-line"},Ia={class:"source"},Pa={key:1,class:"horizontal-clusters"},Na={class:"horizontal-cluster-header"},Ra={class:"cluster-title-section"},Ma={class:"cluster-title"},Da={key:0},Ea={key:1},qa={key:2,class:"canonical-date"},Fa={key:0,class:"extracted-info"},Ua={class:"extracted-name"},$a={key:0,class:"extracted-date"},Va={class:"cluster-actions"},Oa={class:"cluster-size-badge"},Ba={key:0},ja=["href"],Ha={class:"horizontal-citations-grid"},Ga={class:"citation-card-header"},Wa=["title"],Xa={class:"citation-card-body"},Ja={class:"citation-text"},Ka=["href"],Qa={key:1},Za={class:"citation-source"},Ya={class:"source-value"},et={key:2,class:"canonical-only-clusters"},at={class:"canonical-line"},tt={key:1,class:"canonical-date missing"},st={key:1,class:"canonical-name missing"},lt={class:"extracted-line"},it={key:1,class:"extracted-date missing"},nt={key:1,class:"extracted-name missing"},rt={class:"citations-line"},ot={class:"citations-list-inline"},ct=["href"],ut={key:1,class:"citation-text"},dt={key:2},vt={key:4,class:"results-content"},pt={class:"results-header"},mt={class:"header-content"},gt={class:"summary-stats"},ft={class:"stat-item verified"},yt={class:"stat-number"},ht={class:"stat-item invalid"},bt={class:"stat-number"},kt={class:"stat-item total"},_t={class:"stat-number"},xt={class:"action-buttons"},wt={class:"filter-section"},Ct={class:"filter-controls"},At=["onClick"],Tt={class:"layout-controls"},zt={class:"search-box"},St={class:"citations-list"},Lt={class:"citation-row citation-row-citations"},It={class:"citation-text"},Pt={class:"citation-row citation-row-canonical flex-names-row"},Nt={key:0},Rt={key:1,class:"canonical-date missing"},Mt={key:1,class:"canonical-name missing"},Dt={class:"citation-row citation-row-extracted flex-names-row"},Et={key:0},qt={key:1,class:"extracted-date missing"},Ft={key:1,class:"extracted-name missing"},Ut={key:5,class:"no-results-state"},$t=I({__name:"CitationResults",props:{results:{type:Object,default:null},showLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["copy-results","download-results","toast"],setup(a,{emit:r}){const k=a,_=e("all"),x=e(""),w=e(1),C=e(new Set),A=e(0),T=e(null);e(!1);const z=e("full");p(()=>k.results,(e,a)=>{e&&"number"==typeof e.progress&&(A.value=e.progress,T.value=e.eta_seconds)},{immediate:!0,deep:!0});const S=t(()=>k.showLoading&&A.value>0&&A.value<100),L=t(()=>{var e,a;return(null==(e=k.results)?void 0:e.clusters)&&k.results.clusters.length>0?k.results.clusters.reduce((e,a)=>e+a.citations.filter(e=>"true"===e.verified||!0===e.verified).length,0):(null==(a=k.results)?void 0:a.citations)?k.results.citations.filter(e=>"true"===e.verified||!0===e.verified).length:0}),I=t(()=>{var e,a;return(null==(e=k.results)?void 0:e.clusters)&&k.results.clusters.length>0?k.results.clusters.reduce((e,a)=>e+a.citations.filter(e=>"false"===e.verified||!1===e.verified).length,0):(null==(a=k.results)?void 0:a.citations)?k.results.citations.filter(e=>"false"===e.verified||!1===e.verified).length:0}),P=t(()=>{var e;return(null==(e=k.results)?void 0:e.clusters)&&0!==k.results.clusters.length?k.results.clusters.map(e=>{let a=e.citations.filter(e=>!M(e));if("verified"===_.value?a=a.filter(e=>"true"===e.verified||!0===e.verified):"invalid"===_.value&&(a=a.filter(e=>"false"===e.verified||!1===e.verified)),x.value.trim()){const e=x.value.toLowerCase();a=a.filter(a=>a.citation&&a.citation.toLowerCase().includes(e)||a.canonical_citation&&a.canonical_citation.toLowerCase().includes(e)||a.primary_citation&&a.primary_citation.toLowerCase().includes(e)||E(a)&&E(a).toLowerCase().includes(e))}return a.length>0?{...e,citations:a,size:a.length}:null}).filter(e=>null!==e):[]}),N=t(()=>{var e,a;return(null==(e=k.results)?void 0:e.clusters)&&k.results.clusters.length>0?k.results.clusters.flatMap(e=>e.citations):(null==(a=k.results)?void 0:a.citations)?k.results.citations.filter(e=>!M(e)):[]}),R=t(()=>{var e,a;if((null==(e=k.results)?void 0:e.clusters)&&k.results.clusters.length>0)return P.value.flatMap(e=>e.citations);if(!(null==(a=k.results)?void 0:a.citations))return[];let t=k.results.citations;if(t=t.filter(e=>!M(e)),"verified"===_.value?t=t.filter(e=>"true"===e.verified||!0===e.verified):"invalid"===_.value&&(t=t.filter(e=>"false"===e.verified||!1===e.verified)),x.value.trim()){const e=x.value.toLowerCase();t=t.filter(a=>a.citation&&a.citation.toLowerCase().includes(e)||a.canonical_citation&&a.canonical_citation.toLowerCase().includes(e)||a.primary_citation&&a.primary_citation.toLowerCase().includes(e)||E(a)&&E(a).toLowerCase().includes(e))}return t}),M=e=>{const a=(e.citation||e.canonical_citation||e.primary_citation||"").toUpperCase();return!!(a.includes("U.S.C.")||a.includes("USC")||a.includes("C.F.R.")||a.includes("CFR")||a.includes("UNITED STATES CODE")||a.includes("CODE OF FEDERAL REGULATIONS"))||(/\d+\s+U\.?\s*S\.?\s*C\.?\s*[§]?\s*\d+/i.test(a)||/\d+\s+C\.?\s*F\.?\s*R\.?\s*[§]?\s*\d+/i.test(a))},D=t(()=>[{value:"all",label:"All",count:R.value.length},{value:"verified",label:"Verified",count:L.value},{value:"invalid",label:"Invalid",count:I.value}]),E=e=>e.case_name||e.canonical_name||e.extracted_case_name||null,q=e=>e.case_name||e.canonical_name||null,F=e=>{const a=e.extracted_case_name;return a&&"N/A"!==a?a:null},U=e=>e.canonical_date||null,$=e=>{const a=e.extracted_date;return a&&"N/A"!==a?a:null},V=e=>e.citation||e.canonical_citation||e.primary_citation||"N/A",O=e=>e.url||null,B=e=>e.source||"Unknown",j=e=>e.confidence||e.likelihood_score||"N/A",H=e=>e.error||e.explanation||null,G=e=>"true"===e.verified||!0===e.verified?"verified":"true_by_parallel"===e.verified?"true_by_parallel":"unverified",W=e=>{const a=G(e);return"verified"===a||"true_by_parallel"===a},X=e=>((e,a)=>{if(!e||!a)return!1;if("N/A"===e||"N/A"===a)return!1;const t=e=>e.toLowerCase().replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim(),s=t(e),l=t(a);if(s===l)return!0;const i=s.split(" "),n=l.split(" ");return i.filter(e=>n.includes(e)&&e.length>2).length>=.6*Math.min(i.length,n.length)})(q(e),F(e))?"name-similar":"name-different",J=e=>((e,a)=>{if(!e||!a)return!1;const t=e=>{const a=e.match(/\d{4}/);return a?a[0]:null},s=t(e),l=t(a);return s&&l&&s===l})(U(e),$(e))?"date-similar":"date-different",K=e=>{const a=j(e);return"number"==typeof a?a>=.8?"green":a>=.6?"yellow":a>=.4?"orange":"red":W(e)?"green":"red"},Q=e=>{const a=j(e);return"number"==typeof a?Math.round(100*a)+"%":W(e)?"✓":"✗"},Z=e=>{if(!e)return null;const a=e.match(/\d{4}/);return a?a[0]:e},Y=e=>{(e=>{C.value.has(e)?C.value.delete(e):C.value.add(e)})(e)},ee=()=>{w.value=1};function ae(e,a,t){const s=new Set,l=[];for(const i of e){const e=a(i),n=t(i);if(!e&&!n)continue;const r=`${e||""}||${n||""}`;s.has(r)||(s.add(r),l.push({name:e,year:n,citation:i}))}return l}return p(_,ee),p(x,ee),(e,t)=>(l(),s("div",ye,[a.results&&(a.results.clusters||a.results.citations)?(l(),s("div",he,[i("div",be,[t[23]||(t[23]=i("h3",null,"Citation Comparison",-1)),i("div",ke,[(l(!0),s(u,null,d(a.results.clusters||[{citations:N.value}],e=>(l(),s("div",{key:e.cluster_id||V(e.citations[0]),class:"citation-comparison-card"},[e.citations.every(e=>"unverified"===G(e))&&0===ae(e.citations,q,e=>Z(U(e))).length&&0===ae(e.citations,F,e=>Z($(e))).length?(l(),s(u,{key:0},[i("div",_e,o(V(e.citations[0])),1),t[13]||(t[13]=m('<div class="citation-row flex-names-row" data-v-0f7abc8c><span class="row-label" data-v-0f7abc8c>Verified:</span><span style="color:#dc3545;font-weight:bold;" data-v-0f7abc8c>N/A, N/A</span></div><div class="citation-row flex-names-row" data-v-0f7abc8c><span class="row-label" data-v-0f7abc8c>From Document:</span><span style="color:#dc3545;font-weight:bold;" data-v-0f7abc8c>N/A, N/A</span></div>',2))],64)):(l(),s(u,{key:1},[i("div",{class:"citation-row citation-row-citations",onClick:a=>Y(V(e.citations[0]))},[(l(!0),s(u,null,d(e.citations,(a,r)=>(l(),s(u,null,[i("span",we,["verified"===G(a)&&O(a)?(l(),s("a",{key:0,href:O(a),target:"_blank",class:"citation-link-verified",onClick:t[0]||(t[0]=f(()=>{},["stop"]))},o(V(a)),9,Ce)):(l(),s("span",Ae,o(V(a)),1)),i("span",{class:c(["verification-badge",G(a)])},["true_by_parallel"===G(a)?(l(),s(u,{key:0},[v("PARALLEL CITATION VERIFIED")],64)):(l(),s(u,{key:1},[v(o(G(a).replace("_"," ")),1)],64))],2)]),r<e.citations.length-1?(l(),s("span",Te,", ")):n("",!0)],64))),256)),i("div",{class:c(["expand-icon",{expanded:C.value.has(V(e.citations[0]))}])},"▼",2)],8,xe),i("div",ze,[t[14]||(t[14]=i("span",{class:"row-label"},"Verified:",-1)),i("div",Se,[(l(!0),s(u,null,d(ae(e.citations,q,e=>Z(U(e))),(a,t)=>(l(),s(u,null,[i("span",Le,[a.name&&"N/A"!==a.name?(l(),s("span",{key:0,class:c(["canonical-name",X(a.citation)])},[v(o(a.name)+" ",1),a.year?(l(),s("span",{key:0,class:c(["canonical-date",J(a.citation)])}," ("+o(a.year)+")",3)):(l(),s("span",Ie,"(no date)"))],2)):(l(),s("span",Pe,"No canonical name"))]),t<ae(e.citations,q,e=>Z(U(e))).length-1?(l(),s("span",Ne,", ")):n("",!0)],64))),256))])]),t[22]||(t[22]=i("div",{style:{height:"0.5em"}},null,-1)),i("div",Re,[t[15]||(t[15]=i("span",{class:"row-label"},"From Document:",-1)),i("div",Me,[(l(!0),s(u,null,d(ae(e.citations,F,e=>Z($(e))),(a,t)=>(l(),s(u,null,[i("span",De,[a.name&&"N/A"!==a.name?(l(),s("span",{key:0,class:c(["extracted-name",X(a.citation)])},[v(o(a.name)+" ",1),a.year?(l(),s("span",{key:0,class:c(["extracted-date",J(a.citation)])}," ("+o(a.year)+")",3)):(l(),s("span",Ee,"(no date)"))],2)):(l(),s("span",qe,"No extracted name"))]),t<ae(e.citations,F,e=>Z($(e))).length-1?(l(),s("span",Fe,", ")):n("",!0)],64))),256))])]),g(i("div",Ue,[(l(!0),s(u,null,d(e.citations,(e,a)=>(l(),s("div",{key:V(e)+"-details"},[i("div",$e,[t[16]||(t[16]=i("span",{class:"detail-label"},"Source:",-1)),t[17]||(t[17]=v()),i("span",null,o(B(e)),1)]),i("div",Ve,[t[18]||(t[18]=i("span",{class:"detail-label"},"Verification:",-1)),t[19]||(t[19]=v()),i("span",null,o(G(e)),1)]),H(e)?(l(),s("div",Oe,[t[20]||(t[20]=i("span",{class:"detail-label"},"Error:",-1)),t[21]||(t[21]=v()),i("span",null,o(H(e)),1)])):n("",!0)]))),128))],512),[[y,C.value.has(V(e.citations[0]))]])],64))]))),128))])])])):n("",!0),a.showLoading?(l(),s("div",Be,[t[24]||(t[24]=i("div",{class:"loading-spinner"},null,-1)),t[25]||(t[25]=i("p",null,"Processing citations...",-1)),S.value?(l(),h(fe,{key:0,"elapsed-time":0,"remaining-time":T.value||0,"total-progress":A.value,"current-step":"Processing Citations","current-step-progress":A.value,"processing-steps":[],"citation-info":null,"rate-limit-info":null,error:"","can-retry":!1,timeout:null},null,8,["remaining-time","total-progress","current-step-progress"])):n("",!0)])):a.error?(l(),s("div",je,[t[26]||(t[26]=i("div",{class:"error-icon"},"⚠️",-1)),t[27]||(t[27]=i("h3",null,"Error Processing Citations",-1)),i("p",null,o(a.error),1)])):a.results&&a.results.clusters&&a.results.clusters.length>0?(l(),s("div",He,[i("div",Ge,[i("div",We,[t[31]||(t[31]=i("h2",null,"Citation Verification Results (Clustered)",-1)),i("div",Xe,[i("div",Je,[i("span",Ke,o(L.value),1),t[28]||(t[28]=i("span",{class:"stat-label"},"Verified",-1))]),i("div",Qe,[i("span",Ze,o(I.value),1),t[29]||(t[29]=i("span",{class:"stat-label"},"Invalid",-1))]),i("div",Ye,[i("span",ea,o(P.value.length),1),t[30]||(t[30]=i("span",{class:"stat-label"},"Clusters",-1))])])]),i("div",aa,[i("button",{class:"action-btn copy-btn",onClick:t[1]||(t[1]=a=>e.$emit("copy-results"))}," Copy Results "),i("button",{class:"action-btn download-btn",onClick:t[2]||(t[2]=a=>e.$emit("download-results"))}," Download ")])]),i("div",ta,[i("div",sa,[(l(!0),s(u,null,d(D.value,e=>(l(),s("button",{key:e.value,class:c(["filter-btn",{active:_.value===e.value}]),onClick:a=>_.value=e.value},o(e.label)+" ("+o(e.count)+") ",11,la))),128))]),i("div",ia,[i("button",{class:c(["layout-btn",{active:"full"===z.value}]),onClick:t[3]||(t[3]=e=>z.value="full"),title:"Full Display with All Details"},t[32]||(t[32]=[i("span",null,"📋",-1),v(" Citation on Top ")]),2),i("button",{class:c(["layout-btn",{active:"horizontal"===z.value}]),onClick:t[4]||(t[4]=e=>z.value="horizontal"),title:"Horizontal Layout"},t[33]||(t[33]=[i("span",null,"📄",-1),v(" Horizontal ")]),2),i("button",{class:c(["layout-btn",{active:"canonical-only"===z.value}]),onClick:t[5]||(t[5]=e=>z.value="canonical-only"),title:"Name/Date on Top"},t[34]||(t[34]=[i("span",null,"📝",-1),v(" Name/Date on Top ")]),2)]),i("div",na,[g(i("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>x.value=e),type:"text",placeholder:"Search citations...",class:"search-input"},null,512),[[b,x.value]])])]),i("div",ra,["full"===z.value?(l(),s("div",oa,[(l(!0),s(u,null,d(P.value,e=>(l(),s("div",{key:e.cluster_id,class:"cluster-item"},[i("div",ca,[i("h3",null,[e.canonical_name&&"N/A"!==e.canonical_name?(l(),s("span",ua,o(e.canonical_name),1)):(l(),s("span",da,"Unverified Cluster")),e.canonical_date?(l(),s("span",va," ("+o(Z(e.canonical_date))+") ",1)):n("",!0)]),e.extracted_case_name&&"N/A"!==e.extracted_case_name?(l(),s("div",pa,[t[35]||(t[35]=i("span",{class:"extracted-label"},"Extracted from document:",-1)),i("span",ma,o(e.extracted_case_name),1),e.extracted_date?(l(),s("span",ga," ("+o(Z(e.extracted_date))+") ",1)):n("",!0)])):n("",!0),i("div",fa,[i("span",ya,[v(o(e.size)+" citation",1),e.size>1?(l(),s("span",ha,"s")):n("",!0)]),e.url?(l(),s("span",ba,[i("a",{href:e.url,target:"_blank"},"View on CourtListener",8,ka)])):n("",!0)])]),i("div",_a,[(l(!0),s(u,null,d(e.citations,(a,t)=>(l(),s("div",{key:`${e.cluster_id}-${t}`,class:"citation-row"},[i("div",xa,[i("div",wa,[i("span",{class:c(["score-badge",K(a)]),title:"Confidence: "+j(a)},o(Q(a)),11,Ca)]),i("div",Aa,[i("div",Ta,[O(a)?(l(),s("a",{key:0,href:O(a),target:"_blank",class:"citation-link"},o(V(a)),9,za)):(l(),s("span",Sa,o(V(a)),1))]),i("div",La,[i("span",Ia,o(B(a)),1),i("span",{class:c(["verification-status",G(a)])},o(G(a).replace("_"," ")),3)])])])]))),128))])]))),128))])):"horizontal"===z.value?(l(),s("div",Pa,[(l(!0),s(u,null,d(P.value,e=>(l(),s("div",{key:e.cluster_id,class:"horizontal-cluster-card"},[i("div",Na,[i("div",Ra,[i("h3",Ma,[e.canonical_name&&"N/A"!==e.canonical_name?(l(),s("span",Da,o(e.canonical_name),1)):(l(),s("span",Ea,"Unverified Cluster")),e.canonical_date?(l(),s("span",qa," ("+o(Z(e.canonical_date))+") ",1)):n("",!0)]),e.extracted_case_name&&"N/A"!==e.extracted_case_name?(l(),s("div",Fa,[t[36]||(t[36]=i("span",{class:"extracted-label"},"Extracted:",-1)),i("span",Ua,o(e.extracted_case_name),1),e.extracted_date?(l(),s("span",$a," ("+o(Z(e.extracted_date))+") ",1)):n("",!0)])):n("",!0)]),i("div",Va,[i("span",Oa,[v(o(e.size)+" citation",1),e.size>1?(l(),s("span",Ba,"s")):n("",!0)]),e.url?(l(),s("a",{key:0,href:e.url,target:"_blank",class:"courtlistener-link"},t[37]||(t[37]=[i("span",null,"🔗",-1),v(" CourtListener ")]),8,ja)):n("",!0)])]),i("div",Ha,[(l(!0),s(u,null,d(e.citations,(a,n)=>(l(),s("div",{key:`${e.cluster_id}-${n}`,class:"horizontal-citation-card"},[i("div",Ga,[i("span",{class:c(["score-badge",K(a)]),title:"Confidence: "+j(a)},o(Q(a)),11,Wa),i("span",{class:c(["verification-status",G(a)])},o(G(a).replace("_"," ")),3)]),i("div",Xa,[i("div",Ja,[O(a)?(l(),s("a",{key:0,href:O(a),target:"_blank",class:"citation-link"},o(V(a)),9,Ka)):(l(),s("span",Qa,o(V(a)),1))]),i("div",Za,[t[38]||(t[38]=i("span",{class:"source-label"},"Source:",-1)),i("span",Ya,o(B(a)),1)])])]))),128))])]))),128))])):"canonical-only"===z.value?(l(),s("div",et,[(l(!0),s(u,null,d(P.value,e=>(l(),s("div",{key:e.cluster_id,class:"canonical-only-card"},[i("div",at,[t[39]||(t[39]=i("span",{class:"canonical-label"},"Canonical:",-1)),q(e.citations[0])&&"N/A"!==q(e.citations[0])?(l(),s("span",{key:0,class:c(["canonical-name",X(e.citations[0])])},[v(o(q(e.citations[0]))+" ",1),U(e.citations[0])?(l(),s("span",{key:0,class:c(["canonical-date",J(e.citations[0])])}," ("+o(Z(U(e.citations[0])))+") ",3)):(l(),s("span",tt,"(no date)"))],2)):(l(),s("span",st,"No canonical name"))]),i("div",lt,[t[40]||(t[40]=i("span",{class:"extracted-label"},"Extracted:",-1)),F(e.citations[0])&&"N/A"!==F(e.citations[0])?(l(),s("span",{key:0,class:c(["extracted-name",X(e.citations[0])])},[v(o(F(e.citations[0]))+" ",1),$(e.citations[0])?(l(),s("span",{key:0,class:c(["extracted-date",J(e.citations[0])])}," ("+o(Z($(e.citations[0])))+") ",3)):(l(),s("span",it,"(no date)"))],2)):(l(),s("span",nt,"No extracted name"))]),i("div",rt,[t[41]||(t[41]=i("span",{class:"citations-label"},"Citations:",-1)),i("div",ot,[(l(!0),s(u,null,d(e.citations,(a,t)=>(l(),s(u,null,["verified"===G(a)&&O(a)?(l(),s("a",{key:0,href:O(a),target:"_blank",class:"citation-link-verified"},o(V(a)),9,ct)):(l(),s("span",ut,o(V(a)),1)),t<e.citations.length-1?(l(),s("span",dt,", ")):n("",!0)],64))),256))])])]))),128))])):n("",!0)])])):a.results&&a.results.citations&&a.results.citations.length>0?(l(),s("div",vt,[i("div",pt,[i("div",mt,[t[45]||(t[45]=i("h2",null,"Citation Verification Results (Individual)",-1)),i("div",gt,[i("div",ft,[i("span",yt,o(L.value),1),t[42]||(t[42]=i("span",{class:"stat-label"},"Verified",-1))]),i("div",ht,[i("span",bt,o(I.value),1),t[43]||(t[43]=i("span",{class:"stat-label"},"Invalid",-1))]),i("div",kt,[i("span",_t,o(R.value.length),1),t[44]||(t[44]=i("span",{class:"stat-label"},"Total",-1))])])]),i("div",xt,[i("button",{class:"action-btn copy-btn",onClick:t[7]||(t[7]=a=>e.$emit("copy-results"))}," Copy Results "),i("button",{class:"action-btn download-btn",onClick:t[8]||(t[8]=a=>e.$emit("download-results"))}," Download ")])]),i("div",wt,[i("div",Ct,[(l(!0),s(u,null,d(D.value,e=>(l(),s("button",{key:e.value,class:c(["filter-btn",{active:_.value===e.value}]),onClick:a=>_.value=e.value},o(e.label)+" ("+o(e.count)+") ",11,At))),128))]),i("div",Tt,[i("button",{class:c(["layout-btn",{active:"full"===z.value}]),onClick:t[9]||(t[9]=e=>z.value="full"),title:"Full Display with All Details"},t[46]||(t[46]=[i("span",null,"📋",-1),v(" Citation on Top ")]),2),i("button",{class:c(["layout-btn",{active:"horizontal"===z.value}]),onClick:t[10]||(t[10]=e=>z.value="horizontal"),title:"Horizontal Layout"},t[47]||(t[47]=[i("span",null,"📄",-1),v(" Horizontal ")]),2),i("button",{class:c(["layout-btn",{active:"canonical-only"===z.value}]),onClick:t[11]||(t[11]=e=>z.value="canonical-only"),title:"Name/Date on Top"},t[48]||(t[48]=[i("span",null,"📝",-1),v(" Name/Date on Top ")]),2)]),i("div",zt,[g(i("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>x.value=e),type:"text",placeholder:"Search citations...",class:"search-input"},null,512),[[b,x.value]])])]),i("div",St,[(l(!0),s(u,null,d(R.value,e=>(l(),s("div",{key:V(e),class:"citation-item individual"},[i("div",Lt,[i("span",It,o(V(e)),1),i("span",{class:c(["verification-badge",G(e)])},o(G(e)),3)]),i("div",Pt,[t[49]||(t[49]=i("span",{class:"row-label"},"Verified:",-1)),i("span",null,[q(e)&&"N/A"!==q(e)?(l(),s("span",Nt,[v(o(q(e))+" ",1),U(e)?(l(),s("span",{key:0,class:c(["canonical-date",J(e)])}," ("+o(Z(U(e)))+") ",3)):(l(),s("span",Rt,"(no date)"))])):(l(),s("span",Mt,"No canonical name"))])]),i("div",Dt,[t[50]||(t[50]=i("span",{class:"row-label"},"From Document:",-1)),i("span",null,[F(e)&&"N/A"!==F(e)?(l(),s("span",Et,[v(o(F(e))+" ",1),$(e)?(l(),s("span",{key:0,class:c(["extracted-date",J(e)])}," ("+o(Z($(e)))+") ",3)):(l(),s("span",qt,"(no date)"))])):(l(),s("span",Ft,"No extracted name"))])])]))),128))])])):(l(),s("div",Ut,t[51]||(t[51]=[i("p",null,"No citation results to display.",-1)])))]))}},[["__scopeId","data-v-0f7abc8c"]]),Vt={class:"unified-input"},Ot={class:"input-methods-top"},Bt={class:"method-icon"},jt={class:"method-content"},Ht={key:0,class:"active-indicator"},Gt={class:"method-icon"},Wt={class:"method-content"},Xt={key:0,class:"active-indicator"},Jt={key:0,class:"input-area-top"},Kt={key:0,class:"file-input"},Qt=["disabled"],Zt={key:0,class:"drop-zone-content"},Yt={key:1,class:"file-info"},es={class:"file-details"},as={key:0,class:"validation-errors"},ts={key:1,class:"url-input"},ss={class:"url-input-container"},ls={class:"input-wrapper"},is=["disabled"],ns={key:0,class:"input-status valid"},rs={key:1,class:"input-status invalid"},os={class:"input-footer"},cs={key:0,class:"url-preview"},us={key:1,class:"url-error"},ds={key:2,class:"url-hint"},vs={key:0,class:"validation-errors"},ps={class:"input-methods-bottom"},ms={class:"method-icon"},gs={class:"method-content"},fs={key:0,class:"active-indicator"},ys={class:"method-icon"},hs={class:"method-content"},bs={key:0,class:"active-indicator"},ks={class:"analyze-section"},_s=["disabled"],xs={key:0,class:"analyzing-spinner"},ws={key:1,class:"analyze-icon"},Cs={key:0,class:"validation-summary"},As={key:1,class:"input-area-bottom"},Ts={key:0,class:"text-input"},zs={class:"textarea-container"},Ss=["disabled"],Ls={key:0,class:"textarea-overlay"},Is={class:"input-footer"},Ps={key:0,class:"min-length-hint"},Ns={key:0,class:"validation-errors"},Rs={key:1,class:"quick-citation-input-area"},Ms={class:"quick-input-container"},Ds={class:"input-wrapper"},Es=["disabled"],qs={key:0,class:"input-status valid"},Fs={__name:"UnifiedInput",props:{isAnalyzing:{type:Boolean,default:!1}},emits:["analyze"],setup(a,{emit:r}){const p=a,y=r,h="Paste Text",_="URL",x="Upload File",w="Quick Citation",C="Paste legal text or citations directly",A="Analyze content from a web URL",T="Upload a document for analysis",z="Enter a single citation and analyze instantly",S="📝",L="🔗",I="📁",P="🔎",N={minLength:10,maxLength:5e4,minLengthMessage:"Text must be at least 10 characters long",maxLengthMessage:"Text is too long. Maximum 50,000 characters allowed."},R={maxLength:2048,maxLengthMessage:"URL is too long. Maximum 2,048 characters allowed."},M={maxSize:52428800,allowedTypes:[".pdf",".doc",".docx",".txt"],maxSizeMessage:"File is too large. Maximum 50MB allowed.",typeMessage:"Invalid file type. Please upload PDF, DOC, DOCX, or TXT files."},D=e("text"),E=e(""),q=e(""),F=e(null),U=e(!1),$=e(null),V=e(""),O=e({}),B=e({text:!1,url:!1,file:!1,quick:!1}),j=e(!1);function H(){const e={};"text"===D.value?e.text=function(e){const a=[],t=N;return e.trim()?e.length<t.minLength?a.push(t.minLengthMessage):e.length>t.maxLength&&a.push(t.maxLengthMessage):a.push("Text is required"),/[\x00-\x08\x0B\x0C\x0E-\x1F]/.test(e)&&a.push("Text contains invalid characters. Please remove any special characters."),a}(E.value):"url"===D.value?e.url=function(e){const a=[],t=R;return e.trim()?e.length>t.maxLength?a.push(t.maxLengthMessage):/^https?:\/\//.test(e)?/\./.test(e)||a.push("URL must contain a dot"):a.push("URL must start with http:// or https://"):a.push("URL is required"),a}(q.value):"file"===D.value&&(e.file=function(e){const a=[],t=M;if(e){e.size>t.maxSize&&a.push(t.maxSizeMessage),0===e.size&&a.push("File is empty");const s="."+e.name.split(".").pop().toLowerCase();t.allowedTypes.includes(s)||a.push(t.typeMessage)}else a.push("Please select a file");return a}(F.value)),O.value=e}function G(){B.value[D.value]=!0,j.value=!1,H()}const W=t(()=>O.value[D.value]||[]),X=t(()=>W.value.length>0),J=t(()=>{let e=!1;return!p.isAnalyzing&&("text"===D.value?e=E.value.length>=N.minLength&&E.value.length<=N.maxLength:"url"===D.value?e=q.value.length>0:"file"===D.value?e=!!F.value:"quick"===D.value&&(e=V.value.trim().length>0),e)});function K(e){e.preventDefault(),e.stopPropagation(),F.value=e.target.files[0]||null,U.value=!1,G()}function Q(e){e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.files[0];a&&(F.value=a,G()),U.value=!1}function Z(){var e;p.isAnalyzing||null==(e=$.value)||e.click()}function Y(){F.value=null,$.value&&($.value.value=""),G()}function ee(){if(J.value)if(j.value=!1,"text"===D.value)y("analyze",{text:E.value,type:"text"});else if("url"===D.value)y("analyze",{url:q.value,type:"url"});else if("file"===D.value){const e=new FormData;e.append("file",F.value),e.append("type","file"),y("analyze",e)}else"quick"===D.value&&(y("analyze",{text:V.value.trim(),type:"text",quick:!0}),V.value="");else j.value=!0}function ae(e){if(!e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]}function te(){O.value={},B.value={text:!1,url:!1,file:!1,quick:!1},j.value=!1,H()}return(e,t)=>(l(),s("div",Vt,[i("div",Ot,[i("div",{class:c(["input-method-card",{active:"file"===D.value,disabled:a.isAnalyzing}]),onClick:t[0]||(t[0]=e=>!a.isAnalyzing&&(D.value="file",te()))},[i("div",Bt,o(I),1),i("div",jt,[i("h4",null,o(x),1),i("p",null,o(T),1)]),"file"===D.value?(l(),s("div",Ht,"✓")):n("",!0)],2),i("div",{class:c(["input-method-card",{active:"url"===D.value,disabled:a.isAnalyzing}]),onClick:t[1]||(t[1]=e=>!a.isAnalyzing&&(D.value="url",te()))},[i("div",Gt,o(L),1),i("div",Wt,[i("h4",null,o(_),1),i("p",null,o(A),1)]),"url"===D.value?(l(),s("div",Xt,"✓")):n("",!0)],2)]),"file"===D.value||"url"===D.value?(l(),s("div",Jt,["file"===D.value?(l(),s("div",Kt,[t[13]||(t[13]=i("label",{class:"input-label"},[i("i",{class:"bi bi-file-earmark-arrow-up me-2"}),v(" Upload a document ")],-1)),i("div",{class:c(["file-drop-zone",{"has-file":F.value,dragover:U.value,error:X.value&&B.value.file}]),onDrop:Q,onDragover:t[2]||(t[2]=f(e=>U.value=!0,["prevent"])),onDragleave:t[3]||(t[3]=f(e=>U.value=!1,["prevent"])),onClick:Z},[i("input",{ref_key:"fileInput",ref:$,id:"fileInput",type:"file",onChange:K,disabled:a.isAnalyzing,accept:".pdf,.doc,.docx,.txt",style:{display:"none"}},null,40,Qt),F.value?(l(),s("div",Yt,[t[11]||(t[11]=i("div",{class:"file-icon"},"📄",-1)),i("div",es,[i("strong",null,o(F.value.name),1),i("span",null,o(ae(F.value.size)),1)]),a.isAnalyzing?n("",!0):(l(),s("button",{key:0,onClick:f(Y,["stop"]),class:"clear-file-btn",title:"Remove file"},t[10]||(t[10]=[i("i",{class:"bi bi-x-lg"},null,-1)])))])):(l(),s("div",Zt,t[9]||(t[9]=[m('<div class="upload-icon" data-v-d110b890>📁</div><h5 class="drop-zone-title" data-v-d110b890>Click to browse or drag &amp; drop</h5><p class="file-types" data-v-d110b890>Supports: PDF, DOC, DOCX, TXT (max 50MB)</p><div class="drop-zone-hint" data-v-d110b890><i class="bi bi-arrow-up-circle" data-v-d110b890></i><span data-v-d110b890>Drop your file here</span></div>',4)])))],34),X.value&&B.value.file?(l(),s("div",as,[(l(!0),s(u,null,d(W.value,e=>(l(),s("div",{key:e,class:"error-message"},[t[12]||(t[12]=i("span",{class:"error-icon"},"⚠️",-1)),v(" "+o(e),1)]))),128))])):n("",!0)])):"url"===D.value?(l(),s("div",ts,[t[21]||(t[21]=i("label",{class:"input-label"},[i("i",{class:"bi bi-link-45deg me-2"}),v(" Enter URL to analyze ")],-1)),i("div",ss,[i("div",ls,[t[16]||(t[16]=i("div",{class:"input-icon"},[i("i",{class:"bi bi-globe"})],-1)),g(i("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>q.value=e),type:"url",placeholder:"https://example.com/document.pdf",disabled:a.isAnalyzing,onInput:G,class:c([{error:X.value&&B.value.url},"url-input-field"])},null,42,is),[[b,q.value]]),q.value&&!X.value?(l(),s("div",ns,t[14]||(t[14]=[i("i",{class:"bi bi-check-circle-fill"},null,-1)]))):q.value&&X.value?(l(),s("div",rs,t[15]||(t[15]=[i("i",{class:"bi bi-x-circle-fill"},null,-1)]))):n("",!0)])]),i("div",os,[q.value&&!X.value?(l(),s("span",cs,[t[17]||(t[17]=i("i",{class:"bi bi-eye me-1"},null,-1)),v(" Will analyze: "+o(q.value),1)])):q.value&&X.value?(l(),s("span",us,t[18]||(t[18]=[i("i",{class:"bi bi-exclamation-triangle me-1"},null,-1),v(" Invalid URL format ")]))):(l(),s("span",ds,t[19]||(t[19]=[i("i",{class:"bi bi-info-circle me-1"},null,-1),v(" Enter a valid URL to analyze web content ")])))]),X.value&&B.value.url?(l(),s("div",vs,[(l(!0),s(u,null,d(W.value,e=>(l(),s("div",{key:e,class:"error-message"},[t[20]||(t[20]=i("span",{class:"error-icon"},"⚠️",-1)),v(" "+o(e),1)]))),128))])):n("",!0)])):n("",!0)])):n("",!0),i("div",ps,[i("div",{class:c(["input-method-card",{active:"quick"===D.value,disabled:a.isAnalyzing}]),onClick:t[5]||(t[5]=e=>!a.isAnalyzing&&(D.value="quick",te()))},[i("div",ms,o(P),1),i("div",gs,[i("h4",null,o(w),1),i("p",null,o(z),1)]),"quick"===D.value?(l(),s("div",fs,"✓")):n("",!0)],2),i("div",{class:c(["input-method-card",{active:"text"===D.value,disabled:a.isAnalyzing}]),onClick:t[6]||(t[6]=e=>!a.isAnalyzing&&(D.value="text",te()))},[i("div",ys,o(S),1),i("div",hs,[i("h4",null,o(h),1),i("p",null,o(C),1)]),"text"===D.value?(l(),s("div",bs,"✓")):n("",!0)],2)]),i("div",ks,[i("button",{class:c(["analyze-btn",{disabled:!J.value||a.isAnalyzing}]),disabled:!J.value||a.isAnalyzing,onClick:ee},[a.isAnalyzing?(l(),s("span",xs)):(l(),s("span",ws,"🔍")),v(" "+o(a.isAnalyzing?"Analyzing...":"Analyze Content"),1)],10,_s),j.value&&X.value?(l(),s("div",Cs,t[22]||(t[22]=[i("p",null,"Please fix the errors above before analyzing",-1)]))):n("",!0)]),"text"===D.value||"quick"===D.value?(l(),s("div",As,["text"===D.value?(l(),s("div",Ts,[t[27]||(t[27]=i("label",{class:"input-label"},[i("i",{class:"bi bi-text-paragraph me-2"}),v(" Paste your text here ")],-1)),i("div",zs,[g(i("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>E.value=e),placeholder:"Paste legal text, citations, or document content here...",disabled:a.isAnalyzing,rows:"8",onInput:G,class:c([{error:X.value&&B.value.text},"text-input-field"])},null,42,Ss),[[b,E.value]]),E.value?n("",!0):(l(),s("div",Ls,t[23]||(t[23]=[i("i",{class:"bi bi-clipboard"},null,-1),i("span",null,"Paste your content here",-1)])))]),i("div",Is,[i("span",{class:c(["char-count",{error:E.value.length>N.maxLength}])},[t[24]||(t[24]=i("i",{class:"bi bi-type me-1"},null,-1)),v(" "+o(E.value.length)+" / "+o(N.maxLength)+" characters ",1)],2),E.value.length<N.minLength&&B.value.text?(l(),s("span",Ps,[t[25]||(t[25]=i("i",{class:"bi bi-exclamation-circle me-1"},null,-1)),v(" Minimum "+o(N.minLength)+" characters required ",1)])):n("",!0)]),X.value&&B.value.text?(l(),s("div",Ns,[(l(!0),s(u,null,d(W.value,e=>(l(),s("div",{key:e,class:"error-message"},[t[26]||(t[26]=i("span",{class:"error-icon"},"⚠️",-1)),v(" "+o(e),1)]))),128))])):n("",!0)])):"quick"===D.value?(l(),s("div",Rs,[t[30]||(t[30]=i("label",{class:"input-label"},[i("i",{class:"bi bi-lightning me-2"}),v(" Enter a single citation ")],-1)),i("div",Ms,[i("div",Ds,[t[29]||(t[29]=i("div",{class:"input-icon"},[i("i",{class:"bi bi-quote"})],-1)),g(i("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>V.value=e),type:"text",placeholder:"e.g., 410 U.S. 113 (1973) or Roe v. Wade",disabled:a.isAnalyzing,onKeyup:k(ee,["enter"]),class:"quick-citation-input"},null,40,Es),[[b,V.value]]),V.value?(l(),s("div",qs,t[28]||(t[28]=[i("i",{class:"bi bi-check-circle-fill"},null,-1)]))):n("",!0)])]),t[31]||(t[31]=i("div",{class:"input-footer"},[i("span",{class:"citation-hint"},[i("i",{class:"bi bi-info-circle me-1"}),v(" Enter a legal citation to verify quickly ")])],-1))])):n("",!0)])):n("",!0)]))}},Us={class:"toast-icon"},$s={class:"toast-message"},Vs={class:"enhanced-validator"},Os={class:"header text-center mb-4"},Bs={key:1,class:"loading-container"},js={class:"loading-content"},Hs={key:0,class:"progress-section"},Gs={class:"progress-info mb-3"},Ws={class:"progress-stats"},Xs={class:"stat"},Js={class:"stat"},Ks={class:"progress-container"},Qs={class:"progress",style:{height:"1.5rem","border-radius":"0.75rem"}},Zs=["aria-valuenow"],Ys={class:"progress-text"},el={key:2,class:"error-container"},al={class:"error-content"},tl={key:0,class:"mt-4"},sl={class:"card"},ll={class:"card-body"},il={key:3,class:"main-content-wrapper"},nl={class:"main-content-area"},rl={key:0,class:"results-container"},ol={key:1,class:"input-container"},cl={key:2,class:"no-results-container"};const ul=I({name:"EnhancedValidator",components:{CitationResults:$t,UnifiedInput:I(Fs,[["__scopeId","data-v-d110b890"]]),Toast:I({__name:"Toast",props:{message:String,type:{type:String,default:"info"},duration:{type:Number,default:3500}},emits:["close"],setup(a,{emit:r}){const u=a,d=r,v=e(!0),m=t(()=>"success"===u.type?"✅":"error"===u.type?"❌":"ℹ️");function g(){v.value=!1,d("close")}return p(()=>u.message,e=>{e&&(v.value=!0,setTimeout(g,u.duration))}),(e,t)=>(l(),h(x,{name:"toast-fade"},{default:_(()=>[v.value?(l(),s("div",{key:0,class:c(["toast",a.type])},[i("span",Us,o(m.value),1),i("span",$s,o(a.message),1),i("button",{class:"toast-close",onClick:g},"×")],2)):n("",!0)]),_:1}))}},[["__scopeId","data-v-a1e0936f"]]),SkeletonLoader:I({__name:"SkeletonLoader",props:{lines:{type:Number,default:3},height:{type:String,default:"auto"},width:{type:String,default:"100%"}},setup:e=>(a,t)=>(l(),s("div",{class:"skeleton-loader",style:r({height:e.height,width:e.width})},[(l(!0),s(u,null,d(e.lines,e=>(l(),s("div",{key:e,class:"skeleton-line"}))),128))],4))},[["__scopeId","data-v-1c57e4a2"]])},setup(){const s=T(),l=z(),i=e(null),n=e(null),{isLoading:r,cancel:o}=function(t={}){const{loadingMessage:s="Loading...",showLoading:l=!0,onSuccess:i,onError:n,onFinally:r}=t,o=e(null),c=e(null),u=e(!1),d=e(null);let v=null,p=null;const m=`api_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return a(()=>{p&&p.abort(),v&&v.remove()}),{execute:async function(e,a={}){var g;const{message:f=s,showLoader:y=l,signal:h,...b}={...t,...a};c.value=null,d.value=null,o.value=null,y&&(v=L(m,{message:f})),u.value=!0,"undefined"!=typeof AbortController&&(p=new AbortController,b.signal=h||p.signal);try{const a=await e({...b,signal:b.signal});return o.value=a.data||a,d.value=a.status||200,i&&i(a),a}catch(k){throw c.value=k,d.value=(null==(g=k.response)?void 0:g.status)||0,n&&n(k),k}finally{u.value=!1,v&&(c.value?v.error(c.value):v.complete(),v=null),r&&r(),p=null}},cancel:function(){p&&(p.abort(),p=null),v&&(v.remove(),v=null),u.value=!1},data:o,error:c,isLoading:u,status:d}}({loadingMessage:"Validating citation...",showLoading:!0}),c=e(!1),{isLoading:u}=function(){const e=(e,a="Loading...")=>{R.value=e,a&&(M.value=a)};return{isLoading:t(()=>R.value),loadingMessage:t(()=>M.value),setLoading:e,showLoading:a=>{e(!0,a)},hideLoading:()=>{e(!1)},toggleLoading:a=>{e(!R.value,a)}}}(),d=t(()=>r.value||u.value||c.value),{elapsedTime:v,remainingTime:m,totalProgress:g,currentStep:f,currentStepProgress:y,processingSteps:h,actualTimes:b,citationInfo:k,rateLimitInfo:_,timeout:x,processingError:w,canRetry:C,startProcessing:I,stopProcessing:D,updateProgress:E,setSteps:q,resetProcessing:F,setProcessingError:U}=function(){const a=e(null),s=e(0),l=e(""),i=e(0),n=e([]),r=e({}),o=e(null),c=e(null),u=e(null),d=e(null),v=e(!1),p=t(()=>a.value?(Date.now()-a.value)/1e3:0),m=t(()=>s.value?Math.max(0,s.value-p.value):0),g=t(()=>s.value?Math.min(100,p.value/s.value*100):0),f=t(()=>{if(!n.value.length)return 0;const e=n.value.findIndex(e=>e.step===l.value);if(-1===e)return 0;const a=n.value[e],t=p.value-(a.startTime||0);return Math.min(100,t/a.estimated_time*100)}),y=(e,a)=>{const t=n.value.findIndex(a=>a.step===e);-1!==t&&(0!==t&&100!==n.value[t-1].progress||(l.value=e,n.value[t].startTime||(n.value[t].startTime=Date.now())),n.value[t].progress=a,i.value=a)};return{startTime:a,estimatedTotalTime:s,currentStep:l,stepProgress:i,processingSteps:n,actualTimes:r,citationInfo:o,rateLimitInfo:c,timeout:u,processingError:d,canRetry:v,elapsedTime:p,remainingTime:m,totalProgress:g,currentStepProgress:f,startProcessing:e=>{var t;a.value=Date.now(),"object"==typeof e&&null!==e&&Array.isArray(e.steps)?(s.value=e.estimated_total_time,n.value=e.steps.map(e=>({step:e[0],estimated_time:e[1],startTime:null,progress:0})),l.value=(null==(t=n.value[0])?void 0:t.step)||""):"number"==typeof e?(s.value=e,n.value=[],l.value=""):(s.value=0,n.value=[],l.value=""),i.value=0},stopProcessing:()=>{a.value=null,s.value=0,l.value="",i.value=0},updateProgress:e=>{"object"==typeof e&&e.step?y(e.step,e.progress||0):"number"==typeof e&&(i.value=e)},setSteps:e=>{Array.isArray(e)&&(n.value=e.map(e=>({step:"string"==typeof e?e:e.step,estimated_time:"object"==typeof e?e.estimated_time:10,startTime:null,progress:0})))},resetProcessing:()=>{a.value=null,s.value=0,l.value="",i.value=0,n.value=[],r.value={},o.value=null,c.value=null,u.value=null,d.value=null,v.value=!1},setProcessingError:e=>{d.value=e,v.value=!0},updateStep:y,completeStep:e=>{y(e,100);const a=n.value.findIndex(a=>a.step===e)+1;a<n.value.length&&(l.value=n.value[a].step,n.value[a].startTime=Date.now())},updateActualTimes:e=>{r.value=e},reset:()=>{a.value=null,s.value=0,l.value="",i.value=0,n.value=[],r.value={},o.value=null,c.value=null,u.value=null,d.value=null,v.value=!1},formatTime:e=>e<60?`${Math.round(e)}s`:`${Math.floor(e/60)}m ${Math.round(e%60)}s`}}(),$=e(0),V=e(null),O=e(null),B=e(null);let j=e(null);const H=e(""),G=e("info"),W=(e,a="info")=>{H.value=e,G.value=a},X=e(null),J=12e4,K=e(""),Q=t(()=>!0),Z=e(0),Y=t(()=>k.value&&k.value.total?k.value.total:0),ee=t(()=>Y.value?Math.min(100,Math.round(Z.value/Y.value*100)):0),ae=t(()=>ee.value>=80?"bg-success":ee.value>=50?"bg-info":ee.value>=30?"bg-warning":"bg-danger");let te=null;const se=e(!1),{normalizeCitations:le}=function(){const e=e=>{let a=0,t="text-muted";if(e.canonical_name&&"N/A"!==e.canonical_name&&(a+=2),e.extracted_case_name&&"N/A"!==e.extracted_case_name&&e.canonical_name&&"N/A"!==e.canonical_name){const t=e.canonical_name.toLowerCase().split(/\s+/).filter(e=>e.length>2),s=e.extracted_case_name.toLowerCase().split(/\s+/).filter(e=>e.length>2);t.filter(e=>s.includes(e)).length/Math.max(t.length,s.length)>=.5&&(a+=1)}return e.canonical_date&&"N/A"!==e.canonical_date&&(a+=1),e.url&&""!==e.url&&(a+=1),t=a>=4?"text-success":a>=2?"text-warning":"text-danger",{score:a,scoreColor:t,normalized:{canonical_name:e.canonical_name||"N/A",extracted_case_name:e.extracted_case_name||"N/A",canonical_date:e.canonical_date||"N/A",extracted_date:e.extracted_date||"N/A",url:e.url||"",verified:e.verified||!1}}};return{normalizeCitation:e,normalizeCitations:a=>Array.isArray(a)?a.map(a=>{const t=e(a);return{...a,score:t.score,scoreColor:t.scoreColor}}):[],calculateCitationScore:a=>e(a).score,calculateSimilarity:e=>{if(e.canonical_name&&"N/A"!==e.canonical_name)return 1;if(e.extracted_case_name&&"N/A"!==e.extracted_case_name&&e.canonical_name&&"N/A"!==e.canonical_name){const a=e.canonical_name.toLowerCase().split(/\s+/).filter(e=>e.length>2),t=e.extracted_case_name.toLowerCase().split(/\s+/).filter(e=>e.length>2);return a.filter(e=>t.includes(e)).length/Math.max(a.length,t.length)}return 0}}}();function ie(e){const a=new Map;return e.forEach(e=>{const t=e.canonical_citation||e.citation||e.primary_citation;a.has(t)||a.set(t,{cluster_id:`cluster_${t.replace(/[^a-zA-Z0-9]/g,"_")}`,canonical_name:e.canonical_name||e.case_name||"N/A",canonical_date:e.canonical_date||null,extracted_case_name:e.extracted_case_name||"N/A",extracted_date:e.extracted_date||null,url:e.url||null,citations:[]});a.get(t).citations.push(e)}),Array.from(a.values()).map(e=>({...e,size:e.citations.length}))}function ne(){i.value=null,n.value=null,F()}async function re(e){if(e)try{const a=(await P.get(`/task_status/${e}`)).data;if("completed"===a.status){const e=Array.isArray(a.results)?a.results:a.citations||[];if(i.value={citations:le(e),clusters:a.clusters||ie(e),metadata:a.metadata||{},total_citations:e.length,verified_count:e.filter(e=>{var a,t;return e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found)}).length,unverified_count:e.filter(e=>{var a,t;return!(e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found))}).length},c.value=!1,D(),r.value=!1,void 0!==u&&void 0!==u.value&&(u.value=!1),W("Citation analysis completed successfully!","success"),B.value&&(clearInterval(B.value),B.value=null),0===e.length){let e="No citations found in the provided text or document.";a.status_message&&a.status_message.toLowerCase().includes("rate limit")&&(e+=" (Possible cause: search engine rate limiting)"),a.error&&(e+=` (Backend error: ${a.error})`),n.value=e}window&&window.localStorage&&"true"===window.localStorage.getItem("debugMode")&&(n.value+="\n[DEBUG] Raw backend response: "+JSON.stringify(a,null,2))}else"failed"===a.status?(n.value=a.error||"Processing failed",c.value=!1,U(a.error||"Processing failed"),W(`Processing failed: ${a.error||"Unknown error"}`,"error"),B.value&&(clearInterval(B.value),B.value=null)):(c.value=!0,a.estimated_total_time&&a.steps?j.value!==e&&(I({estimated_total_time:a.estimated_total_time,steps:a.steps}),j.value=e):a.estimated_total_time&&j.value!==e&&(I(a.estimated_total_time),j.value=e),a.current_step&&E({step:a.current_step,progress:a.progress||0}),void 0!==a.total_citations&&(k.value={total:a.total_citations,processed:a.processed_citations||0,unique:a.unique_citations||0}),i.value={citations:[],clusters:[],metadata:a.metadata||{},progress:a.progress||0,eta_seconds:a.eta_seconds||null,current_chunk:a.current_chunk||0,total_chunks:a.total_chunks||1,total_citations:a.total_citations||0,verified_count:0,unverified_count:0},B.value||(B.value=setInterval(()=>re(e),2e3)));me()}catch(a){n.value="Failed to check processing status",c.value=!1,U(a.message||"Failed to check processing status"),B.value&&(clearInterval(B.value),B.value=null)}}const oe=async(e,a)=>{try{"file"===a?await ve(e):"url"===a?await pe({url:e}):"text"===a&&await de({text:e})}catch(t){w.value=`Failed to analyze input: ${t.message}`,C.value=!0}},ce=e=>{try{let a=[];Array.isArray(e.citations)&&e.citations.length>0?a=e.citations:Array.isArray(e.validation_results)&&e.validation_results.length>0&&(a=e.validation_results),i.value={...e,citations:le(a),clusters:e.clusters||ie(a),timestamp:(new Date).toISOString()},r.value=!1,n.value=null,c.value=!1,O.value=null,void 0!==u&&void 0!==u.value&&(u.value=!1),S(()=>{const e=document.querySelector(".results-container");e&&e.scrollIntoView({behavior:"smooth"})})}catch(a){n.value="Failed to process results",r.value=!1}},ue=e=>{n.value=e.message||"An error occurred during analysis",r.value=!1,c.value=!1,O.value=null,w.value=e.message||"Analysis failed",C.value=!0,W(n.value,"error")},de=async({text:e,options:a})=>{if(!c.value){r.value=!0,n.value=null,i.value=null;try{const a=await N({text:e,type:"text"});ce(a),r.value=!1}catch(t){ue(t)}}},ve=async e=>{if(!c.value){r.value=!0,n.value=null,i.value=null;try{let a;e instanceof FormData?a=e:(a=new FormData,a.append("file",e.file),a.append("type","file"));const t=await N(a);ce(t),r.value=!1}catch(a){ue(a)}}},pe=async({url:e})=>{if(!c.value){r.value=!0,n.value=null,i.value=null;try{const a=await N({url:e,type:"url"});ce(a),r.value=!1}catch(a){ue(a)}}};function me(){X.value&&(clearTimeout(X.value),X.value=null)}A(()=>{let e={...s.query};if(l.currentRoute.value.state&&l.currentRoute.value.state.results){const e=l.currentRoute.value.state.results;let a=[];return Array.isArray(e.citations)&&e.citations.length>0?a=e.citations:Array.isArray(e.validation_results)&&e.validation_results.length>0&&(a=e.validation_results),void(a.length>0?(i.value={...e,citations:le(a),clusters:e.clusters||ie(a),total_citations:a.length,verified_count:a.filter(e=>{var a,t;return e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found)}).length,unverified_count:a.filter(e=>{var a,t;return!(e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found))}).length},W("Citation analysis completed successfully!","success")):n.value="No citations found in the provided text or document.")}if(e.task_id)return O.value=e.task_id,c.value=!0,void re(e.task_id);if(!e.text&&!e.url&&!e.fileName&&localStorage.getItem("lastCitationInput"))try{const a=JSON.parse(localStorage.getItem("lastCitationInput"));a.fileName?(delete a.fileName,0===Object.keys(a).length?localStorage.removeItem("lastCitationInput"):localStorage.setItem("lastCitationInput",JSON.stringify(a)),e={}):e=a}catch(a){e={}}e.text||e.url||e.fileName?(ne(),e.text?de({text:e.text}):e.url?pe({url:e.url}):e.fileName&&(n.value=`File "${e.fileName}" was previously uploaded but cannot be restored from history. Please upload the file again to analyze it.`,se.value=!0)):i.value=null,Q.value&&Y.value>20&&(Z.value=0,te&&clearInterval(te),te=setInterval(()=>{Z.value<Y.value&&Z.value++},2e3)),setTimeout(()=>{const e=document.querySelectorAll(".fas.fa-cog.fa-spin"),a=document.querySelectorAll(".bi.bi-gear-fill.spinning");e.forEach((e,t)=>{-1===getComputedStyle(e).fontFamily.indexOf("FontAwesome")&&(e.style.display="none",a[t]&&(a[t].style.display="inline-block"))})},100)}),a(()=>{c.value&&o(),B.value&&(clearInterval(B.value),B.value=null),me(),te&&clearInterval(te)}),p(()=>i.value,e=>{e&&te&&(Z.value=Y.value,clearInterval(te))});return{results:i,error:n,isLoading:d,showLoading:d,hasActiveRequest:c,clearResults:ne,handleUnifiedAnalyze:function(e){c.value?W("A request is already in progress. Please wait for it to complete.","warning"):(F(),q([{step:"Preparing analysis",estimated_time:5},{step:"Processing content",estimated_time:30},{step:"Verifying citations",estimated_time:60}]),I(),c.value=!0,n.value=null,i.value=null,e.file?ve(e):e.url?pe(e):e.text&&(e.quick,de({text:e.text,options:{}})),K.value="",me(),X.value=setTimeout(()=>{K.value="Processing timed out. No response from server.",U(K.value),c.value=!1,W(K.value,"error")},J))},retryProcessing:async()=>{if(O.value)try{w.value=null,C.value=!1,F(),await P.cancelRequest(O.value);const e=P.getRequestStatus(O.value);if(e){const{type:a,input:t}=e;await oe(t,a)}}catch(e){w.value=`Failed to retry: ${e.message}`,C.value=!0}},cancelValidation:o,copyResults:function(){},downloadResults:function(){},elapsedTime:v,remainingTime:m,totalProgress:g,currentStep:f,currentStepProgress:y,processingSteps:h,actualTimes:b,formatTime:function(e){if(!e||e<0)return"0s";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),s=Math.floor(e%60);return a>0?`${a}:${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${t}:${s.toString().padStart(2,"0")}`},citationInfo:k,queuePosition:$,estimatedQueueTime:V,rateLimitInfo:_,timeout:x,processingError:w,canRetry:C,getProgressBarClass:function(e){return e>=.8?"bg-success":e>=.5?"bg-info":e>=.3?"bg-warning":"bg-danger"},applyCorrection:()=>{},toastMessage:H,toastType:G,clearToast:()=>{H.value=""},fallbackError:K,showTimer:Q,progressCurrent:Z,progressTotal:Y,progressPercent:ee,progressBarClass:ae,loadRecentInput:e=>{l.push({path:"/",query:{tab:e.tab,..."paste"===e.tab&&e.text?{text:e.text}:{},..."url"===e.tab&&e.url?{url:e.url}:{}}})},showFileUpload:se}}},[["render",function(e,a,t,u,d,p){const m=w("Toast"),g=w("UnifiedInput"),f=w("CitationResults");return l(),s("div",Vs,[u.toastMessage?(l(),h(m,{key:0,message:u.toastMessage,type:u.toastType,onClose:u.clearToast},null,8,["message","type","onClose"])):n("",!0),i("div",Os,[i("button",{class:"btn btn-link back-btn",onClick:a[0]||(a[0]=(...a)=>e.goHome&&e.goHome(...a))},a[1]||(a[1]=[i("i",{class:"bi bi-arrow-left"},null,-1),v(" Back to Home ")])),a[2]||(a[2]=i("h1",{class:"results-title"},"Citation Verification Results",-1))]),u.showLoading&&!u.results?(l(),s("div",Bs,[i("div",js,[a[5]||(a[5]=i("div",{class:"spinner-container"},[i("div",{class:"spinner-border text-primary",role:"status"},[i("span",{class:"visually-hidden"},"Processing...")])],-1)),a[6]||(a[6]=i("h3",null,"Processing Citations",-1)),a[7]||(a[7]=i("p",{class:"text-muted"},"Extracting and analyzing citations from your document...",-1)),u.showTimer?(l(),s("div",Hs,[i("div",Gs,[i("div",Ws,[i("span",Xs,[a[3]||(a[3]=i("i",{class:"bi bi-list-ol text-primary"},null,-1)),v(" "+o(u.progressCurrent)+" of "+o(u.progressTotal)+" citations ",1)]),i("span",Js,[a[4]||(a[4]=i("i",{class:"bi bi-clock text-primary"},null,-1)),v(" "+o(u.formatTime(u.elapsedTime))+" elapsed ",1)])])]),i("div",Ks,[i("div",Qs,[i("div",{class:c(["progress-bar progress-bar-striped progress-bar-animated",u.progressBarClass]),role:"progressbar",style:r({width:u.progressPercent+"%"}),"aria-valuenow":u.progressPercent,"aria-valuemin":"0","aria-valuemax":"100"},[i("span",Ys,o(u.progressPercent)+"%",1)],14,Zs)])])])):n("",!0)])])):u.error&&!u.showLoading?(l(),s("div",el,[i("div",al,[a[10]||(a[10]=i("div",{class:"error-icon"},[i("i",{class:"bi bi-exclamation-triangle"})],-1)),a[11]||(a[11]=i("h3",null,"Analysis Failed",-1)),i("p",null,o(u.error),1),u.showFileUpload?(l(),s("div",tl,[i("div",sl,[a[9]||(a[9]=i("div",{class:"card-header bg-primary text-white"},[i("h5",{class:"mb-0"},[i("i",{class:"bi bi-file-earmark-arrow-up me-2"}),v(" Re-upload File ")])],-1)),i("div",ll,[a[8]||(a[8]=i("p",{class:"text-muted mb-3"}," To analyze your file, please upload it again using the form below. ",-1)),C(g,{onAnalyze:e.handleAnalyze,"is-analyzing":u.showLoading},null,8,["onAnalyze","is-analyzing"])])])])):n("",!0)])])):(l(),s("div",il,[i("div",nl,[u.results?(l(),s("div",rl,[C(f,{results:u.results,"processing-time":u.elapsedTime,"show-details":!0,onApplyCorrection:u.applyCorrection,onCopyResults:u.copyResults,onDownloadResults:u.downloadResults,onToast:e.showToast},null,8,["results","processing-time","onApplyCorrection","onCopyResults","onDownloadResults","onToast"])])):u.showFileUpload?(l(),s("div",ol,[C(g,{onAnalyze:e.handleAnalyze,"is-analyzing":u.showLoading},null,8,["onAnalyze","is-analyzing"])])):(l(),s("div",cl,a[12]||(a[12]=[i("div",{class:"no-results-content"},[i("div",{class:"no-results-icon"},[i("i",{class:"bi bi-search"})]),i("h3",null,"No Analysis Results"),i("p",{class:"lead"},[v("No results to display."),i("br"),v("Please return to the home page to start a new analysis.")])],-1)])))])]))])}],["__scopeId","data-v-b93066dd"]]);export{ul as default};
