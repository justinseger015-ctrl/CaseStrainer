import{r as e,s as a,p as t,u as l,c as s,o as i,l as n,b as o,t as r,g as u,F as c,n as d,v,x as p,y as m,z as g,A as f,h as y,w as h,T as b,B as k,f as w,d as _,C as x,D as C,E as L,G as T}from"./vue-core-CMPZWSde.js";import{c as A,_ as S}from"./index-C8vDvizX.js";import{a as P}from"./axios-rSMZb3Ae.js";import"./pinia-Dpv8-DN5.js";const R=e(!1),z=e("Loading...");const I=P.create({baseURL:"/casestrainer/api",timeout:12e4});I.interceptors.request.use((e=>("/analyze"===e.url&&e.data&&"url"===e.data.type?(e.timeout=3e5,e.retryCount=0,e.maxRetries=3):(e.timeout=12e4,e.retryCount=0,e.maxRetries=1),e))),I.interceptors.response.use((e=>e),(async e=>{const a=e.config;if(!a||!a.retryCount||a.retryCount>=a.maxRetries||"ECONNABORTED"!==e.code&&!e.message.includes("timeout")&&!e.message.includes("Network Error"))return Promise.reject(e);a.retryCount+=1;const t=Math.min(1e3*Math.pow(2,a.retryCount),3e4);return await new Promise((e=>setTimeout(e,t))),I(a)})),I.interceptors.request.use((e=>(e.headers["X-API-Key"]="443a87912e4f444fb818fca454364d71e4aa9f91",e.data instanceof FormData||(e.headers["Content-Type"]="application/json"),e)),(e=>Promise.reject(e))),I.interceptors.response.use((e=>e),(e=>(e.response||e.request,Promise.reject(e)))),I.interceptors.response.use((e=>e),(e=>{if(e.config&&"/analyze"===e.config.url&&e.config.data&&"url"===e.config.data.type)if(e.response)switch(e.response.status){case 400:e.message="Invalid URL or content type not supported";break;case 404:e.message="URL not found or content not accessible";break;case 429:e.message="Too many requests. Please try again in a few minutes";break;case 502:e.message="Failed to fetch URL content. The server may be temporarily unavailable";break;case 504:e.message="Request timed out while fetching URL content";break;default:e.message=`Error fetching URL: ${e.response.status} ${e.response.statusText}`}else"ECONNABORTED"===e.code?e.message="Request timed out while fetching URL content":"ECONNREFUSED"===e.code?e.message="Could not connect to the server":"ENOTFOUND"===e.code&&(e.message="URL not found or domain does not exist");return Promise.reject(e)}));const M={class:"citation-results"},D={key:0,class:"loading-state"},U={key:1,class:"error-state"},N={key:2,class:"results-content"},E={class:"results-header"},q={class:"header-content"},F={class:"summary-stats"},V={class:"stat-item"},j={class:"stat-number"},$={class:"stat-item verified"},O={class:"stat-number"},B={class:"stat-item invalid"},X={class:"stat-number"},J={key:0,class:"stats-section"},G={class:"stats-grid"},K={class:"stat-card"},Q={class:"stat-value"},Y={class:"stat-card"},H={class:"stat-value"},W={class:"stat-card verified"},Z={class:"stat-value"},ee={class:"stat-card invalid"},ae={class:"stat-value"},te={class:"filter-section"},le={class:"filter-controls"},se=["onClick"],ie={class:"filter-count"},ne={class:"search-box"},oe={key:1,class:"citations-list"},re={class:"citation-header"},ue={class:"citation-text"},ce=["onClick"],de={key:1,class:"citation-content"},ve={class:"citation-actions"},pe=["onClick"],me=["onClick"],ge=["onClick"],fe={class:"citation-details"},ye={key:0,class:"detail-section"},he={class:"detail-row"},be={class:"detail-value"},ke={class:"detail-row"},we={class:"detail-value"},_e={class:"detail-row"},xe={class:"detail-value"},Ce={key:0,class:"detail-row"},Le={key:1,class:"detail-row"},Te={key:1,class:"detail-section"},Ae={key:0,class:"detail-row"},Se={class:"detail-value"},Pe={key:1,class:"detail-row"},Re={class:"detail-value"},ze={key:2,class:"detail-section"},Ie={class:"detail-row"},Me={class:"detail-value"},De={key:0,class:"detail-row"},Ue={class:"detail-value"},Ne={key:1,class:"detail-row"},Ee={key:3,class:"detail-section"},qe={class:"parallel-citations"},Fe={class:"detail-section"},Ve={class:"detail-row"},je={class:"detail-value"},$e={key:0,class:"detail-row"},Oe={class:"detail-value note"},Be={key:0,class:"pagination"},Xe=["disabled"],Je={class:"page-info"},Ge=["disabled"],Ke={key:2,class:"empty-filter"},Qe={key:3,class:"no-results"},Ye={class:"modal-body"},He={class:"detail-section"},We={class:"detail-grid"},Ze={class:"detail-item"},ea={class:"detail-value"},aa={class:"detail-item"},ta={class:"detail-value"},la={class:"detail-item"},sa={class:"detail-section"},ia={class:"detail-grid"},na={key:0,class:"detail-item"},oa={class:"detail-value"},ra={key:1,class:"detail-item"},ua={class:"detail-value"},ca={key:2,class:"detail-item"},da={class:"detail-value"},va={key:3,class:"detail-item"},pa={class:"detail-value"},ma={key:4,class:"detail-item"},ga={class:"detail-value"},fa={class:"detail-section"},ya={class:"detail-grid"},ha={key:0,class:"detail-item"},ba={class:"detail-value"},ka={key:1,class:"detail-item"},wa={class:"detail-value"},_a={key:2,class:"detail-item"},xa={class:"detail-value"},Ca={key:3,class:"detail-item"},La={class:"detail-value"},Ta={class:"detail-section"},Aa={class:"detail-grid"},Sa={key:0,class:"detail-item"},Pa={class:"detail-value"},Ra={key:1,class:"detail-item"},za={class:"detail-value"},Ia={key:2,class:"detail-item"},Ma={class:"detail-value"},Da={key:0,class:"detail-section"},Ua={class:"raw-data"},Na={key:1,class:"detail-section"},Ea={class:"parallel-citations"},qa=S({__name:"CitationResults",props:{results:{type:Object,default:null},loading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["apply-correction","copy-results","download-results","toast"],setup(a,{emit:f}){const y=a,h=f,b=e("all"),k=e(""),w=e(1),_=e(null),x=t((()=>{var e;return(null==(e=y.results)?void 0:e.citations)?y.results.citations.filter((e=>e.verified)).length:0})),C=t((()=>{var e;return(null==(e=y.results)?void 0:e.citations)?y.results.citations.filter((e=>!e.verified)).length:0})),L=t((()=>{var e;if(!(null==(e=y.results)?void 0:e.citations))return[];let a=y.results.citations;if("verified"===b.value?a=a.filter((e=>e.verified)):"invalid"===b.value&&(a=a.filter((e=>!e.verified))),k.value.trim()){const e=k.value.toLowerCase();a=a.filter((a=>a.citation.toLowerCase().includes(e)||R(a)&&R(a).toLowerCase().includes(e)||z(a)&&z(a).toLowerCase().includes(e)||Fa(a)&&Fa(a).toLowerCase().includes(e)||Va(a)&&Va(a).toLowerCase().includes(e)||ja(a)&&ja(a).toLowerCase().includes(e)||$a(a)&&$a(a).toLowerCase().includes(e)||Oa(a)&&Oa(a).some((a=>a.toLowerCase().includes(e)))||Xa(a)&&Xa(a).toLowerCase().includes(e)))}return a})),T=t((()=>Math.ceil(L.value.length/50))),A=t((()=>{const e=50*(w.value-1),a=e+50;return L.value.slice(e,a)})),S=t((()=>{var e,a;return[{value:"all",label:"All",count:(null==(a=null==(e=y.results)?void 0:e.citations)?void 0:a.length)||0},{value:"verified",label:"Verified",count:x.value},{value:"invalid",label:"Invalid",count:C.value}]})),P=e=>{window.open(e,"_blank")},R=e=>{var a;return e.case_name||(null==(a=e.metadata)?void 0:a.case_name)||null},z=e=>e.extracted_case_name||null,I=e=>e.case_name_similarity||null,qa=e=>e.case_name_mismatch||!1,Fa=e=>{var a;return e.court||(null==(a=e.metadata)?void 0:a.court)||null},Va=e=>{var a;return e.docket_number||(null==(a=e.metadata)?void 0:a.docket)||null},ja=e=>e.date_filed||null,$a=e=>e.extracted_date||null,Oa=e=>e.parallel_citations||[],Ba=e=>{var a;return e.url||(null==(a=e.metadata)?void 0:a.url)||null},Xa=e=>{var a;const t=e.url||"";if(t)try{return new URL(t).hostname.replace(/^www\./,"")}catch(s){return t}const l=e.citation_url||"";if(l)try{return new URL(l).hostname.replace(/^www\./,"")}catch(s){return l}return e.source||(null==(a=e.metadata)?void 0:a.source)||"Unknown"},Ja=e=>e.note||null,Ga=e=>{if(!e)return"N/A";const a=/^\d{4}/.exec(e);if(a)return a[0];try{return new Date(e).getFullYear()}catch(t){return e}},Ka=async()=>{try{const e=L.value.map((e=>`${e.citation} - ${e.verified?"Verified":"Invalid"}`)).join("\n");await navigator.clipboard.writeText(e),h("copy-results"),h("toast","Results copied to clipboard!","success")}catch(e){h("toast","Failed to copy results","error")}},Qa=()=>{try{const e={timestamp:(new Date).toISOString(),total:L.value.length,verified:x.value,invalid:C.value,citations:L.value.map((e=>({citation:e.citation,verified:e.verified,case_name:R(e),extracted_case_name:z(e),case_name_similarity:I(e),case_name_mismatch:qa(e),court:Fa(e),docket_number:Va(e),date_filed:ja(e),extracted_date:$a(e),parallel_citations:Oa(e),url:Ba(e),source:Xa(e),note:Ja(e),metadata:e.metadata})))},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),l=document.createElement("a");l.href=t,l.download=`citation-results-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t),h("download-results"),h("toast","Results downloaded successfully!","success")}catch(e){h("toast","Failed to download results","error")}},Ya=()=>{w.value=1};l(b,Ya),l(k,Ya);const Ha=e=>{if(!e)return"";if("string"==typeof e)return e;if("object"==typeof e){if(e.citation)return e.citation;if(e.cite)return e.cite;if(e.text)return e.text;if(e.volume||e.reporter||e.page){const a=e.volume||"",t=e.reporter||"",l=e.page||"",s=e.year||"";let i=[a,t,l].filter(Boolean).join(" ");if(s&&i&&!i.includes(s)&&(i+=` (${s})`),i)return i}return String(e)}return String(e)},Wa=e=>e?e.citation&&"string"==typeof e.citation?e.citation:e.parallel_citations&&Array.isArray(e.parallel_citations)&&e.parallel_citations.length>0?Ha(e.parallel_citations[0]):e.cite?e.cite:e.text?e.text:"Citation not available":"",Za=e=>e.parallel_citations&&Array.isArray(e.parallel_citations)?e.parallel_citations.slice(1):[],et=()=>{_.value=null},at=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString()}catch(a){return e}},tt=e=>{if(!e)return"N/A";try{const a="string"==typeof e?JSON.parse(e):e;return JSON.stringify(a,null,2)}catch(a){return e}};return(e,t)=>(i(),s("div",M,[a.loading?(i(),s("div",D,t[4]||(t[4]=[o("div",{class:"loading-spinner"},null,-1),o("h3",null,"Analyzing citations...",-1)]))):a.error?(i(),s("div",U,[t[5]||(t[5]=o("div",{class:"error-icon"},"‚ùå",-1)),t[6]||(t[6]=o("h3",null,"Analysis Error",-1)),o("p",null,r(a.error),1)])):a.results&&a.results.citations&&a.results.citations.length>0?(i(),s("div",N,[o("div",E,[o("div",q,[t[10]||(t[10]=o("h2",null,"Citation Analysis Results",-1)),o("div",F,[o("div",V,[o("span",j,r(a.results.citations.length),1),t[7]||(t[7]=o("span",{class:"stat-label"},"Total",-1))]),o("div",$,[o("span",O,r(x.value),1),t[8]||(t[8]=o("span",{class:"stat-label"},"Verified",-1))]),o("div",B,[o("span",X,r(C.value),1),t[9]||(t[9]=o("span",{class:"stat-label"},"Invalid",-1))])])]),o("div",{class:"action-buttons"},[o("button",{onClick:Ka,class:"action-btn copy-btn"},t[11]||(t[11]=[o("span",{class:"btn-icon"},"üìã",-1),u(" Copy Results ")])),o("button",{onClick:Qa,class:"action-btn download-btn"},t[12]||(t[12]=[o("span",{class:"btn-icon"},"üíæ",-1),u(" Download ")]))])]),a.results.stats?(i(),s("div",J,[t[17]||(t[17]=o("h3",null,"Processing Breakdown",-1)),o("div",G,[o("div",K,[o("span",Q,r(a.results.stats.total_extracted),1),t[13]||(t[13]=o("span",{class:"stat-title"},"Extracted",-1))]),o("div",Y,[o("span",H,r(a.results.stats.deduplicated),1),t[14]||(t[14]=o("span",{class:"stat-title"},"Unique",-1))]),o("div",W,[o("span",Z,r(a.results.stats.verified_in_cache+a.results.stats.verified_in_json_array+a.results.stats.verified_in_text_blob+a.results.stats.verified_in_single+a.results.stats.verified_in_langsearch),1),t[15]||(t[15]=o("span",{class:"stat-title"},"Verified",-1))]),o("div",ee,[o("span",ae,r(a.results.stats.not_verified),1),t[16]||(t[16]=o("span",{class:"stat-title"},"Not Verified",-1))])])])):n("",!0),o("div",te,[o("div",le,[(i(!0),s(c,null,d(S.value,(e=>(i(),s("button",{key:e.value,class:v(["filter-btn",{active:b.value===e.value}]),onClick:a=>b.value=e.value},[u(r(e.label)+" ",1),o("span",ie,"("+r(e.count)+")",1)],10,se)))),128))]),o("div",ne,[p(o("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>k.value=e),type:"text",placeholder:"Search citations...",class:"search-input"},null,512),[[m,k.value]])])]),L.value.length>0?(i(),s("div",oe,[(i(!0),s(c,null,d(A.value,(e=>{var a,l;return i(),s("div",{key:e.id||e.citation||(null==(a=e.parallel_citations)?void 0:a.join("-")),class:v(["citation-item",{verified:e.verified,invalid:!e.verified}])},[o("div",re,[o("div",ue,[Ba(e)?(i(),s("span",{key:0,onClick:a=>P(Ba(e)),class:"citation-content clickable",title:"Click to view case details",style:{cursor:"pointer",color:"#007bff","text-decoration":"underline"}},r(Wa(e)),9,ce)):(i(),s("span",de,r(Wa(e)),1)),o("span",{class:v(["status-badge",e.verified?"verified":"invalid"])},r(e.verified?"‚úì Verified":"‚úó Invalid"),3)]),o("div",ve,[Ba(e)?(i(),s("button",{key:0,onClick:a=>P(Ba(e)),class:"action-link",title:"View case details"}," üîó ",8,pe)):n("",!0),o("button",{onClick:a=>(async e=>{try{await navigator.clipboard.writeText(e),h("toast","Citation copied to clipboard!","success")}catch(a){h("toast","Failed to copy citation","error")}})(Wa(e)),class:"action-link",title:"Copy citation"}," üìã ",8,me),o("button",{onClick:a=>{return t=e,void(_.value=t);var t},class:"action-link",title:"View detailed information"}," üìä ",8,ge)])]),o("div",fe,[R(e)||z(e)?(i(),s("div",ye,[t[23]||(t[23]=o("h4",{class:"section-title"},"Case Information",-1)),o("div",he,[t[18]||(t[18]=o("span",{class:"detail-label"},"Canonical Case Name:",-1)),o("span",be,r(R(e)||"N/A"),1)]),o("div",ke,[t[19]||(t[19]=o("span",{class:"detail-label"},"Extracted Case Name:",-1)),o("span",we,r(z(e)||"N/A"),1)]),o("div",_e,[t[20]||(t[20]=o("span",{class:"detail-label"},"Hinted Case Name:",-1)),o("span",xe,r(e.hinted_case_name||"N/A"),1)]),null!==I(e)?(i(),s("div",Ce,[t[21]||(t[21]=o("span",{class:"detail-label"},"Name Similarity:",-1)),o("span",{class:v(["detail-value",(l=I(e),l>=.8?"high-similarity":l>=.6?"medium-similarity":"low-similarity")])},r((100*I(e)).toFixed(1))+"% ",3)])):n("",!0),qa(e)?(i(),s("div",Le,t[22]||(t[22]=[o("span",{class:"detail-label"},"Name Mismatch:",-1),o("span",{class:"detail-value warning"},"‚ö†Ô∏è Case names differ significantly",-1)]))):n("",!0)])):n("",!0),Fa(e)||Va(e)?(i(),s("div",Te,[t[26]||(t[26]=o("h4",{class:"section-title"},"Court Information",-1)),Fa(e)?(i(),s("div",Ae,[t[24]||(t[24]=o("span",{class:"detail-label"},"Court:",-1)),o("span",Se,r(Fa(e)),1)])):n("",!0),Va(e)?(i(),s("div",Pe,[t[25]||(t[25]=o("span",{class:"detail-label"},"Docket:",-1)),o("span",Re,r(Va(e)),1)])):n("",!0)])):n("",!0),ja(e)||$a(e)?(i(),s("div",ze,[t[30]||(t[30]=o("h4",{class:"section-title"},"Decision Information",-1)),o("div",Ie,[t[27]||(t[27]=o("span",{class:"detail-label"},"Extracted Date:",-1)),o("span",Me,r(Ga($a(e))||"N/A"),1)]),ja(e)?(i(),s("div",De,[t[28]||(t[28]=o("span",{class:"detail-label"},"Canonical Date:",-1)),o("span",Ue,r(Ga(ja(e))),1)])):n("",!0),$a(e)&&ja(e)?(i(),s("div",Ne,[t[29]||(t[29]=o("span",{class:"detail-label"},"Date Match:",-1)),o("span",{class:v(["detail-value",$a(e)===ja(e)?"high-similarity":"low-similarity"])},r($a(e)===ja(e)?"‚úì Match":"‚úó Different"),3)])):n("",!0)])):n("",!0),Za(e)&&Za(e).length>0?(i(),s("div",Ee,[t[31]||(t[31]=o("h4",{class:"section-title"},"Additional Parallel Citations",-1)),o("div",qe,[(i(!0),s(c,null,d(Za(e),((e,a)=>(i(),s("span",{key:a,class:"parallel-citation"},r(Ha(e)),1)))),128))])])):n("",!0),o("div",Fe,[t[34]||(t[34]=o("h4",{class:"section-title"},"Verification Details",-1)),o("div",Ve,[t[32]||(t[32]=o("span",{class:"detail-label"},"Source:",-1)),o("span",je,r(Xa(e)||"N/A"),1)]),Ja(e)?(i(),s("div",$e,[t[33]||(t[33]=o("span",{class:"detail-label"},"Note:",-1)),o("span",Oe,r(Ja(e)),1)])):n("",!0)])])],2)})),128)),T.value>1?(i(),s("div",Be,[o("button",{onClick:t[1]||(t[1]=e=>w.value--),disabled:w.value<=1,class:"pagination-btn"}," ‚Üê Previous ",8,Xe),o("span",Je,"Page "+r(w.value)+" of "+r(T.value),1),o("button",{onClick:t[2]||(t[2]=e=>w.value++),disabled:w.value>=T.value,class:"pagination-btn"}," Next ‚Üí ",8,Ge)])):n("",!0)])):n("",!0),0===L.value.length&&a.results.citations.length>0?(i(),s("div",Ke,t[35]||(t[35]=[o("div",{class:"empty-icon"},"üîç",-1),o("h3",null,"No citations match your filter",-1),o("p",null,"Try adjusting your search or filter criteria",-1)]))):n("",!0)])):(i(),s("div",Qe,t[36]||(t[36]=[o("div",{class:"no-results-icon"},"üìÑ",-1),o("h3",null,"No Citations Found",-1),o("p",null,"The document didn't contain any recognizable legal citations",-1)]))),_.value?(i(),s("div",{key:4,class:"modal-overlay",onClick:et},[o("div",{class:"modal-content",onClick:t[3]||(t[3]=g((()=>{}),["stop"]))},[o("div",{class:"modal-header"},[t[37]||(t[37]=o("h3",null,"Citation Details",-1)),o("button",{onClick:et,class:"modal-close"},"√ó")]),o("div",Ye,[o("div",He,[t[41]||(t[41]=o("h4",null,"Citation Information",-1)),o("div",We,[o("div",Ze,[t[38]||(t[38]=o("span",{class:"detail-label"},"Citation Text:",-1)),o("span",ea,r(Wa(_.value)),1)]),o("div",aa,[t[39]||(t[39]=o("span",{class:"detail-label"},"Database ID:",-1)),o("span",ta,r(_.value.id||"N/A"),1)]),o("div",la,[t[40]||(t[40]=o("span",{class:"detail-label"},"Status:",-1)),o("span",{class:v(["detail-value",_.value.verified?"verified":"invalid"])},r(_.value.verified?"Verified":"Not Verified"),3)])])]),o("div",sa,[t[47]||(t[47]=o("h4",null,"Citation Components",-1)),o("div",ia,[_.value.volume?(i(),s("div",na,[t[42]||(t[42]=o("span",{class:"detail-label"},"Volume:",-1)),o("span",oa,r(_.value.volume),1)])):n("",!0),_.value.reporter?(i(),s("div",ra,[t[43]||(t[43]=o("span",{class:"detail-label"},"Reporter:",-1)),o("span",ua,r(_.value.reporter),1)])):n("",!0),_.value.page?(i(),s("div",ca,[t[44]||(t[44]=o("span",{class:"detail-label"},"Page:",-1)),o("span",da,r(_.value.page),1)])):n("",!0),_.value.year?(i(),s("div",va,[t[45]||(t[45]=o("span",{class:"detail-label"},"Year:",-1)),o("span",pa,r(_.value.year),1)])):n("",!0),_.value.court?(i(),s("div",ma,[t[46]||(t[46]=o("span",{class:"detail-label"},"Court:",-1)),o("span",ga,r(_.value.court),1)])):n("",!0)])]),o("div",fa,[t[52]||(t[52]=o("h4",null,"Verification Details",-1)),o("div",ya,[_.value.verification_source?(i(),s("div",ha,[t[48]||(t[48]=o("span",{class:"detail-label"},"Verification Source:",-1)),o("span",ba,r(_.value.verification_source),1)])):n("",!0),void 0!==_.value.verification_confidence?(i(),s("div",ka,[t[49]||(t[49]=o("span",{class:"detail-label"},"Verification Confidence:",-1)),o("span",wa,r((100*_.value.verification_confidence).toFixed(1))+"%",1)])):n("",!0),void 0!==_.value.verification_count?(i(),s("div",_a,[t[50]||(t[50]=o("span",{class:"detail-label"},"Times Verified:",-1)),o("span",xa,r(_.value.verification_count),1)])):n("",!0),void 0!==_.value.error_count?(i(),s("div",Ca,[t[51]||(t[51]=o("span",{class:"detail-label"},"Verification Errors:",-1)),o("span",La,r(_.value.error_count),1)])):n("",!0)])]),o("div",Ta,[t[56]||(t[56]=o("h4",null,"Database Timestamps",-1)),o("div",Aa,[_.value.created_at?(i(),s("div",Sa,[t[53]||(t[53]=o("span",{class:"detail-label"},"First Added:",-1)),o("span",Pa,r(at(_.value.created_at)),1)])):n("",!0),_.value.updated_at?(i(),s("div",Ra,[t[54]||(t[54]=o("span",{class:"detail-label"},"Last Updated:",-1)),o("span",za,r(at(_.value.updated_at)),1)])):n("",!0),_.value.last_verified_at?(i(),s("div",Ia,[t[55]||(t[55]=o("span",{class:"detail-label"},"Last Verified:",-1)),o("span",Ma,r(at(_.value.last_verified_at)),1)])):n("",!0)])]),_.value.verification_result?(i(),s("div",Da,[t[57]||(t[57]=o("h4",null,"Raw Verification Data",-1)),o("div",Ua,[o("pre",null,r(tt(_.value.verification_result)),1)])])):n("",!0),Za(_.value)&&Za(_.value).length>0?(i(),s("div",Na,[t[58]||(t[58]=o("h4",null,"Additional Parallel Citations",-1)),o("div",Ea,[(i(!0),s(c,null,d(Za(_.value),((e,a)=>(i(),s("span",{key:a,class:"parallel-citation"},r(Ha(e)),1)))),128))])])):n("",!0)]),o("div",{class:"modal-footer"},[o("button",{onClick:et,class:"btn btn-secondary"},"Close")])])])):n("",!0)]))}},[["__scopeId","data-v-b3e856f9"]]),Fa={class:"unified-input"},Va={class:"input-methods-top"},ja={class:"method-icon"},$a={class:"method-content"},Oa={key:0,class:"active-indicator"},Ba={class:"method-icon"},Xa={class:"method-content"},Ja={key:0,class:"active-indicator"},Ga={key:0,class:"input-area-top"},Ka={key:0,class:"file-input"},Qa=["disabled"],Ya={key:0,class:"drop-zone-content"},Ha={key:1,class:"file-info"},Wa={class:"file-details"},Za={key:0,class:"validation-errors"},et={key:1,class:"url-input"},at=["disabled"],tt={class:"input-footer"},lt={key:0,class:"url-preview"},st={key:1,class:"url-error"},it={key:0,class:"validation-errors"},nt={class:"input-methods-bottom"},ot={class:"method-icon"},rt={class:"method-content"},ut={key:0,class:"active-indicator"},ct={class:"method-icon"},dt={class:"method-content"},vt={key:0,class:"active-indicator"},pt={class:"analyze-section"},mt=["disabled"],gt={key:0,class:"analyzing-spinner"},ft={key:1,class:"analyze-icon"},yt={key:0,class:"validation-summary"},ht={key:1,class:"input-area-bottom"},bt={key:0,class:"text-input"},kt=["disabled"],wt={class:"input-footer"},_t={key:0,class:"min-length-hint"},xt={key:0,class:"validation-errors"},Ct={key:1,class:"quick-citation-input-area"},Lt=["disabled"],Tt={__name:"UnifiedInput",props:{isAnalyzing:{type:Boolean,default:!1}},emits:["analyze"],setup(a,{emit:l}){const y=a,h=l,b="Paste Text",k="URL",w="Upload File",_="Quick Citation",x="Paste legal text or citations directly",C="Analyze content from a web URL",L="Upload a document for analysis",T="Enter a single citation and analyze instantly",A="üìù",S="üîó",P="üìÅ",R="üîé",z={minLength:10,maxLength:5e4,minLengthMessage:"Text must be at least 10 characters long",maxLengthMessage:"Text is too long. Maximum 50,000 characters allowed."},I={maxLength:2048,maxLengthMessage:"URL is too long. Maximum 2,048 characters allowed."},M={maxSize:52428800,allowedTypes:[".pdf",".doc",".docx",".txt"],maxSizeMessage:"File is too large. Maximum 50MB allowed.",typeMessage:"Invalid file type. Please upload PDF, DOC, DOCX, or TXT files."},D=e("text"),U=e(""),N=e(""),E=e(null),q=e(!1),F=e(null),V=e(""),j=e({}),$=e({text:!1,url:!1,file:!1,quick:!1}),O=e(!1);function B(){const e={};"text"===D.value?e.text=function(e){const a=[],t=z;return e.trim()?e.length<t.minLength?a.push(t.minLengthMessage):e.length>t.maxLength&&a.push(t.maxLengthMessage):a.push("Text is required"),/[\x00-\x08\x0B\x0C\x0E-\x1F]/.test(e)&&a.push("Text contains invalid characters. Please remove any special characters."),a}(U.value):"url"===D.value?e.url=function(e){const a=[],t=I;return e.trim()?e.length>t.maxLength?a.push(t.maxLengthMessage):/^https?:\/\//.test(e)?/\./.test(e)||a.push("URL must contain a dot"):a.push("URL must start with http:// or https://"):a.push("URL is required"),a}(N.value):"file"===D.value&&(e.file=function(e){const a=[],t=M;if(e){e.size>t.maxSize&&a.push(t.maxSizeMessage),0===e.size&&a.push("File is empty");const l="."+e.name.split(".").pop().toLowerCase();t.allowedTypes.includes(l)||a.push(t.typeMessage)}else a.push("Please select a file");return a}(E.value)),j.value=e}function X(){$.value[D.value]=!0,O.value=!1,B()}const J=t((()=>j.value[D.value]||[])),G=t((()=>J.value.length>0)),K=t((()=>{let e=!1;return!y.isAnalyzing&&("text"===D.value?e=U.value.length>=z.minLength&&U.value.length<=z.maxLength:"url"===D.value?e=N.value.length>0:"file"===D.value?e=!!E.value:"quick"===D.value&&(e=V.value.trim().length>0),e)}));function Q(e){e.preventDefault(),e.stopPropagation(),E.value=e.target.files[0]||null,q.value=!1,X()}function Y(e){e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.files[0];a&&(E.value=a,X()),q.value=!1}function H(){var e;y.isAnalyzing||null==(e=F.value)||e.click()}function W(){E.value=null,F.value&&(F.value.value=""),X()}function Z(){K.value?(O.value=!1,"text"===D.value?h("analyze",{text:U.value,type:"text"}):"url"===D.value?h("analyze",{url:N.value,type:"url"}):"file"===D.value?h("analyze",{file:E.value,type:"file"}):"quick"===D.value&&(h("analyze",{text:V.value.trim(),type:"text",quick:!0}),V.value="")):O.value=!0}function ee(e){if(!e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]}function ae(){j.value={},$.value={text:!1,url:!1,file:!1,quick:!1},O.value=!1,B()}return(e,t)=>(i(),s("div",Fa,[o("div",Va,[o("div",{class:v(["input-method-card",{active:"file"===D.value,disabled:a.isAnalyzing}]),onClick:t[0]||(t[0]=e=>!a.isAnalyzing&&(D.value="file",ae()))},[o("div",ja,r(P),1),o("div",$a,[o("h4",null,r(w),1),o("p",null,r(L),1)]),"file"===D.value?(i(),s("div",Oa,"‚úì")):n("",!0)],2),o("div",{class:v(["input-method-card",{active:"url"===D.value,disabled:a.isAnalyzing}]),onClick:t[1]||(t[1]=e=>!a.isAnalyzing&&(D.value="url",ae()))},[o("div",Ba,r(S),1),o("div",Xa,[o("h4",null,r(k),1),o("p",null,r(C),1)]),"url"===D.value?(i(),s("div",Ja,"‚úì")):n("",!0)],2)]),"file"===D.value||"url"===D.value?(i(),s("div",Ga,["file"===D.value?(i(),s("div",Ka,[t[12]||(t[12]=o("label",null,"Upload a document",-1)),o("div",{class:v(["file-drop-zone",{"has-file":E.value,dragover:q.value,error:G.value&&$.value.file}]),onDrop:Y,onDragover:t[2]||(t[2]=g((e=>q.value=!0),["prevent"])),onDragleave:t[3]||(t[3]=g((e=>q.value=!1),["prevent"])),onClick:H},[o("input",{ref_key:"fileInput",ref:F,type:"file",onChange:Q,disabled:a.isAnalyzing,accept:".pdf,.doc,.docx,.txt",style:{display:"none"}},null,40,Qa),E.value?(i(),s("div",Ha,[t[10]||(t[10]=o("div",{class:"file-icon"},"üìÑ",-1)),o("div",Wa,[o("strong",null,r(E.value.name),1),o("span",null,r(ee(E.value.size)),1)]),a.isAnalyzing?n("",!0):(i(),s("button",{key:0,onClick:g(W,["stop"]),class:"clear-file-btn"}," ‚úï "))])):(i(),s("div",Ya,t[9]||(t[9]=[o("div",{class:"upload-icon"},"üìÅ",-1),o("p",null,"Click to browse or drag & drop",-1),o("p",{class:"file-types"},"Supports: PDF, DOC, DOCX, TXT (max 50MB)",-1)])))],34),G.value&&$.value.file?(i(),s("div",Za,[(i(!0),s(c,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[11]||(t[11]=o("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),u(" "+r(e),1)])))),128))])):n("",!0)])):"url"===D.value?(i(),s("div",et,[t[14]||(t[14]=o("label",null,"Enter URL to analyze",-1)),p(o("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>N.value=e),type:"url",placeholder:"https://example.com/document.pdf",disabled:a.isAnalyzing,onInput:X,class:v({error:G.value&&$.value.url})},null,42,at),[[m,N.value]]),o("div",tt,[N.value&&!G.value?(i(),s("span",lt,"Will analyze: "+r(N.value),1)):N.value&&G.value?(i(),s("span",st,"Invalid URL format")):n("",!0)]),G.value&&$.value.url?(i(),s("div",it,[(i(!0),s(c,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[13]||(t[13]=o("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),u(" "+r(e),1)])))),128))])):n("",!0)])):n("",!0)])):n("",!0),o("div",nt,[o("div",{class:v(["input-method-card",{active:"quick"===D.value,disabled:a.isAnalyzing}]),onClick:t[5]||(t[5]=e=>!a.isAnalyzing&&(D.value="quick",ae()))},[o("div",ot,r(R),1),o("div",rt,[o("h4",null,r(_),1),o("p",null,r(T),1)]),"quick"===D.value?(i(),s("div",ut,"‚úì")):n("",!0)],2),o("div",{class:v(["input-method-card",{active:"text"===D.value,disabled:a.isAnalyzing}]),onClick:t[6]||(t[6]=e=>!a.isAnalyzing&&(D.value="text",ae()))},[o("div",ct,r(A),1),o("div",dt,[o("h4",null,r(b),1),o("p",null,r(x),1)]),"text"===D.value?(i(),s("div",vt,"‚úì")):n("",!0)],2)]),o("div",pt,[o("button",{class:v(["analyze-btn",{disabled:!K.value||a.isAnalyzing}]),disabled:!K.value||a.isAnalyzing,onClick:Z},[a.isAnalyzing?(i(),s("span",gt)):(i(),s("span",ft,"üîç")),u(" "+r(a.isAnalyzing?"Analyzing...":"Analyze Content"),1)],10,mt),O.value&&G.value?(i(),s("div",yt,t[15]||(t[15]=[o("p",null,"Please fix the errors above before analyzing",-1)]))):n("",!0)]),"text"===D.value||"quick"===D.value?(i(),s("div",ht,["text"===D.value?(i(),s("div",bt,[t[17]||(t[17]=o("label",null,"Paste your text here",-1)),p(o("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>U.value=e),placeholder:"Paste legal text, citations, or document content here...",disabled:a.isAnalyzing,rows:"6",onInput:X,class:v({error:G.value&&$.value.text})},null,42,kt),[[m,U.value]]),o("div",wt,[o("span",{class:v(["char-count",{error:U.value.length>z.maxLength}])},r(U.value.length)+" / "+r(z.maxLength)+" characters ",3),U.value.length<z.minLength&&$.value.text?(i(),s("span",_t," Minimum "+r(z.minLength)+" characters required ",1)):n("",!0)]),G.value&&$.value.text?(i(),s("div",xt,[(i(!0),s(c,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[16]||(t[16]=o("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),u(" "+r(e),1)])))),128))])):n("",!0)])):"quick"===D.value?(i(),s("div",Ct,[t[18]||(t[18]=o("label",null,"Enter a single citation",-1)),p(o("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>V.value=e),type:"text",placeholder:"Enter citation...",disabled:a.isAnalyzing,onKeyup:f(Z,["enter"]),class:"quick-citation-input"},null,40,Lt),[[m,V.value]])])):n("",!0)])):n("",!0)]))}},At={class:"toast-icon"},St={class:"toast-message"},Pt={class:"enhanced-validator"},Rt={class:"main-content"},zt={class:"input-container"},It={key:0,class:"progress-container"},Mt={key:1,class:"processing-section mb-4"},Dt={class:"card"},Ut={class:"card-body"},Nt={class:"progress mb-3",style:{height:"25px"}},Et=["aria-valuenow"],qt={class:"row text-center mb-3"},Ft={class:"col-md-4"},Vt={class:"time-info"},jt={class:"fw-bold"},$t={class:"col-md-4"},Ot={class:"time-info"},Bt={class:"fw-bold"},Xt={class:"col-md-4"},Jt={class:"time-info"},Gt={class:"fw-bold"},Kt={key:0,class:"current-step mb-3"},Qt={class:"d-flex justify-content-between align-items-center mb-2"},Yt={class:"text-primary"},Ht={class:"progress",style:{height:"15px"}},Wt=["aria-valuenow"],Zt={key:1,class:"citation-stats mb-3"},el={class:"row text-center"},al={class:"col-md-3"},tl={class:"stat-item"},ll={class:"fw-bold"},sl={class:"col-md-3"},il={class:"stat-item"},nl={class:"fw-bold"},ol={class:"col-md-3"},rl={class:"stat-item"},ul={class:"fw-bold"},cl={class:"col-md-3"},dl={class:"stat-item"},vl={class:"fw-bold"},pl={key:2,class:"processing-steps"},ml={class:"steps-list"},gl={class:"step-name"},fl={class:"step-status"},yl={key:0,class:"text-success"},hl={key:1,class:"text-primary"},bl={key:2,class:"text-muted"},kl={key:3,class:"alert alert-danger mt-3"},wl={key:2,class:"results-container"},_l={key:3,class:"error-container"},xl={class:"error-card"},Cl={key:4,class:"empty-state"};const Ll=S({name:"EnhancedValidator",components:{CitationResults:qa,UnifiedInput:S(Tt,[["__scopeId","data-v-9b2cf9c8"]]),Toast:S({__name:"Toast",props:{message:String,type:{type:String,default:"info"},duration:{type:Number,default:3500}},emits:["close"],setup(a,{emit:u}){const c=a,d=u,p=e(!0),m=t((()=>"success"===c.type?"‚úÖ":"error"===c.type?"‚ùå":"‚ÑπÔ∏è"));function g(){p.value=!1,d("close")}return l((()=>c.message),(e=>{e&&(p.value=!0,setTimeout(g,c.duration))})),(e,t)=>(i(),y(b,{name:"toast-fade"},{default:h((()=>[p.value?(i(),s("div",{key:0,class:v(["toast",a.type])},[o("span",At,r(m.value),1),o("span",St,r(a.message),1),o("button",{class:"toast-close",onClick:g},"√ó")],2)):n("",!0)])),_:1}))}},[["__scopeId","data-v-a1e0936f"]]),SkeletonLoader:S({__name:"SkeletonLoader",props:{lines:{type:Number,default:3},height:{type:String,default:"auto"},width:{type:String,default:"100%"}},setup:e=>(a,t)=>(i(),s("div",{class:"skeleton-loader",style:k({height:e.height,width:e.width})},[(i(!0),s(c,null,d(e.lines,(e=>(i(),s("div",{key:e,class:"skeleton-line"})))),128))],4))},[["__scopeId","data-v-1c57e4a2"]])},setup(){const l=C();T();const s=e(null),i=e(null),{isLoading:n,cancel:o}=function(t={}){const{loadingMessage:l="Loading...",showLoading:s=!0,onSuccess:i,onError:n,onFinally:o}=t,r=e(null),u=e(null),c=e(!1),d=e(null);let v=null,p=null;const m=`api_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return a((()=>{p&&p.abort(),v&&v.remove()})),{execute:async function(e,a={}){var g;const{message:f=l,showLoader:y=s,signal:h,...b}={...t,...a};u.value=null,d.value=null,r.value=null,y&&(v=A(m,{message:f})),c.value=!0,"undefined"!=typeof AbortController&&(p=new AbortController,b.signal=h||p.signal);try{const a=await e({...b,signal:b.signal});return r.value=a.data||a,d.value=a.status||200,i&&i(a),a}catch(k){throw u.value=k,d.value=(null==(g=k.response)?void 0:g.status)||0,n&&n(k),k}finally{c.value=!1,v&&(u.value?v.error(u.value):v.complete(),v=null),o&&o(),p=null}},cancel:function(){p&&(p.abort(),p=null),v&&(v.remove(),v=null),c.value=!1},data:r,error:u,isLoading:c,status:d}}({loadingMessage:"Validating citation...",showLoading:!0}),r=e(!1),{isLoading:u}=function(){const e=(e,a="Loading...")=>{R.value=e,a&&(z.value=a)};return{isLoading:t((()=>R.value)),loadingMessage:t((()=>z.value)),setLoading:e,showLoading:a=>{e(!0,a)},hideLoading:()=>{e(!1)},toggleLoading:a=>{e(!R.value,a)}}}(),c=t((()=>n.value||u.value||r.value)),{elapsedTime:d,remainingTime:v,totalProgress:p,currentStep:m,currentStepProgress:g,processingSteps:f,actualTimes:y,citationInfo:h,rateLimitInfo:b,timeout:k,processingError:w,canRetry:_,startProcessing:S,stopProcessing:P,updateProgress:M,setSteps:D,resetProcessing:U,setProcessingError:N}=function(){const a=e(null),l=e(0),s=e(""),i=e(0),n=e([]),o=e({}),r=e(null),u=e(null),c=e(null),d=e(null),v=e(!1),p=t((()=>a.value?(Date.now()-a.value)/1e3:0)),m=t((()=>l.value?Math.max(0,l.value-p.value):0)),g=t((()=>l.value?Math.min(100,p.value/l.value*100):0)),f=t((()=>{if(!n.value.length)return 0;const e=n.value.findIndex((e=>e.step===s.value));if(-1===e)return 0;const a=n.value[e],t=p.value-(a.startTime||0);return Math.min(100,t/a.estimated_time*100)})),y=(e,a)=>{const t=n.value.findIndex((a=>a.step===e));-1!==t&&(0!==t&&100!==n.value[t-1].progress||(s.value=e,n.value[t].startTime||(n.value[t].startTime=Date.now())),n.value[t].progress=a,i.value=a)};return{startTime:a,estimatedTotalTime:l,currentStep:s,stepProgress:i,processingSteps:n,actualTimes:o,citationInfo:r,rateLimitInfo:u,timeout:c,processingError:d,canRetry:v,elapsedTime:p,remainingTime:m,totalProgress:g,currentStepProgress:f,startProcessing:e=>{var t;a.value=Date.now(),"object"==typeof e&&null!==e&&Array.isArray(e.steps)?(l.value=e.estimated_total_time,n.value=e.steps.map((e=>({step:e[0],estimated_time:e[1],startTime:null,progress:0}))),s.value=(null==(t=n.value[0])?void 0:t.step)||""):"number"==typeof e?(l.value=e,n.value=[],s.value=""):(l.value=0,n.value=[],s.value=""),i.value=0},stopProcessing:()=>{a.value=null,l.value=0,s.value="",i.value=0},updateProgress:e=>{"object"==typeof e&&e.step?y(e.step,e.progress||0):"number"==typeof e&&(i.value=e)},setSteps:e=>{Array.isArray(e)&&(n.value=e.map((e=>({step:"string"==typeof e?e:e.step,estimated_time:"object"==typeof e?e.estimated_time:10,startTime:null,progress:0}))))},resetProcessing:()=>{a.value=null,l.value=0,s.value="",i.value=0,n.value=[],o.value={},r.value=null,u.value=null,c.value=null,d.value=null,v.value=!1},setProcessingError:e=>{d.value=e,v.value=!0},updateStep:y,completeStep:e=>{y(e,100);const a=n.value.findIndex((a=>a.step===e))+1;a<n.value.length&&(s.value=n.value[a].step,n.value[a].startTime=Date.now())},updateActualTimes:e=>{o.value=e},reset:()=>{a.value=null,l.value=0,s.value="",i.value=0,n.value=[],o.value={},r.value=null,u.value=null,c.value=null,d.value=null,v.value=!1},formatTime:e=>e<60?`${Math.round(e)}s`:`${Math.floor(e/60)}m ${Math.round(e%60)}s`}}(),E=e(0),q=e(null),F=e(null),V=e(null);let j=e(null);const $=e(""),O=e("info"),B=(e,a="info")=>{$.value=e,O.value=a},X=e(null),J=12e4,G=e("");function K(e){return(e||[]).map((e=>{var a,t;const l=e.clusters&&e.clusters.length>0?e.clusters[0]:{},s=l.absolute_url?`https://www.courtlistener.com${l.absolute_url}`:void 0,i=(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found)||e.exists||"verified"===e.status||!0===e.verified;return{...e,metadata:{...l,url:s},details:{...l,url:s},valid:i,verified:i}}))}async function Q(e){if(e)try{const a=(await I.get(`/task_status/${e}`)).data;if("completed"===a.status){const e=Array.isArray(a.results)?a.results:a.citations||[];if(s.value={citations:K(e),metadata:a.metadata||{},total_citations:e.length,verified_count:e.filter((e=>{var a,t;return e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found)})).length,unverified_count:e.filter((e=>{var a,t;return!(e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found))})).length},r.value=!1,P(),n.value=!1,void 0!==u&&void 0!==u.value&&(u.value=!1),B("Citation analysis completed successfully!","success"),V.value&&(clearInterval(V.value),V.value=null),0===e.length){let e="No citations found in the provided text or document.";a.status_message&&a.status_message.toLowerCase().includes("rate limit")&&(e+=" (Possible cause: search engine rate limiting)"),a.error&&(e+=` (Backend error: ${a.error})`),i.value=e}window&&window.localStorage&&"true"===window.localStorage.getItem("debugMode")&&(i.value+="\n[DEBUG] Raw backend response: "+JSON.stringify(a,null,2))}else"failed"===a.status?(i.value=a.error||"Processing failed",r.value=!1,N(a.error||"Processing failed"),B(`Processing failed: ${a.error||"Unknown error"}`,"error"),V.value&&(clearInterval(V.value),V.value=null)):(r.value=!0,a.estimated_total_time&&a.steps?j.value!==e&&(S({estimated_total_time:a.estimated_total_time,steps:a.steps}),j.value=e):a.estimated_total_time&&j.value!==e&&(S(a.estimated_total_time),j.value=e),a.current_step&&M({step:a.current_step,progress:a.progress||0}),void 0!==a.total_citations&&(h.value={total:a.total_citations,processed:a.processed_citations||0,unique:a.unique_citations||0}),V.value||(V.value=setInterval((()=>Q(e)),2e3)));le()}catch(a){i.value="Failed to check processing status",r.value=!1,N("Failed to check processing status"),V.value&&(clearInterval(V.value),V.value=null)}}const Y=async(e,a)=>{try{"file"===a?await ee({file:e}):"url"===a?await ae({url:e}):"text"===a&&await Z({text:e})}catch(t){w.value=`Failed to analyze input: ${t.message}`,_.value=!0}},H=e=>{try{const a=Array.isArray(e.validation_results)&&e.validation_results.length>0?e.validation_results:e.citations||[];s.value={...e,citations:K(a),timestamp:(new Date).toISOString()},n.value=!1,i.value=null,r.value=!1,F.value=null,void 0!==u&&void 0!==u.value&&(u.value=!1),L((()=>{const e=document.querySelector(".results-container");e&&e.scrollIntoView({behavior:"smooth"})}))}catch(a){i.value="Failed to process results",n.value=!1}},W=e=>{i.value=e.message||"An error occurred during analysis",n.value=!1,r.value=!1,F.value=null,w.value=e.message||"Analysis failed",_.value=!0,B(i.value,"error")},Z=async({text:e,options:a})=>{n.value=!0,i.value=null,s.value=null;try{const a=await I.post("/analyze",{text:e,type:"text"},{timeout:3e5});"processing"===a.data.status&&a.data.task_id?(r.value=!0,F.value=a.data.task_id,V.value||(V.value=setInterval((()=>Q(a.data.task_id)),2e3))):(H(a.data),n.value=!1)}catch(t){W(t)}},ee=async({file:e})=>{n.value=!0,i.value=null,s.value=null;try{const a=new FormData;a.append("file",e);const t=await I.post("/analyze",a,{headers:{"Content-Type":"multipart/form-data"},timeout:3e5});"processing"===t.data.status&&t.data.task_id?(r.value=!0,F.value=t.data.task_id,V.value||(V.value=setInterval((()=>Q(t.data.task_id)),2e3))):(H(t.data),n.value=!1)}catch(a){W(a)}},ae=async({url:e})=>{n.value=!0,i.value=null,s.value=null;try{const a=await I.post("/analyze",{url:e,type:"url"},{timeout:3e5});"processing"===a.data.status&&a.data.task_id?(r.value=!0,F.value=a.data.task_id,V.value||(V.value=setInterval((()=>Q(a.data.task_id)),2e3))):(H(a.data),n.value=!1)}catch(a){W(a)}};function te(e){U(),D([{step:"Preparing analysis",estimated_time:5},{step:"Processing content",estimated_time:30},{step:"Verifying citations",estimated_time:60}]),S(),r.value=!0,i.value=null,s.value=null,e.file?ee(e):e.url?ae(e):e.text&&(e.quick,Z({text:e.text,options:{}})),G.value="",le(),X.value=setTimeout((()=>{G.value="Processing timed out. No response from server.",N(G.value),r.value=!1,B(G.value,"error")}),J)}function le(){X.value&&(clearTimeout(X.value),X.value=null)}return x((()=>{const{citation:e}=l.query;e&&"string"==typeof e&&te({text:e})})),a((()=>{r.value&&o(),V.value&&(clearInterval(V.value),V.value=null),le()})),{results:s,error:i,isLoading:c,showLoading:c,hasActiveRequest:r,clearResults:function(){s.value=null,i.value=null,U()},handleUnifiedAnalyze:te,retryProcessing:async()=>{if(F.value)try{w.value=null,_.value=!1,U(),await I.cancelRequest(F.value);const e=I.getRequestStatus(F.value);if(e){const{type:a,input:t}=e;await Y(t,a)}}catch(e){w.value=`Failed to retry: ${e.message}`,_.value=!0}},cancelValidation:o,copyResults:function(){},downloadResults:function(){},elapsedTime:d,remainingTime:v,totalProgress:p,currentStep:m,currentStepProgress:g,processingSteps:f,actualTimes:y,formatTime:function(e){if(!e||e<0)return"0s";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=Math.floor(e%60);return a>0?`${a}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`},citationInfo:h,queuePosition:E,estimatedQueueTime:q,rateLimitInfo:b,timeout:k,processingError:w,canRetry:_,getProgressBarClass:function(e){return e>=.8?"bg-success":e>=.5?"bg-info":e>=.3?"bg-warning":"bg-danger"},applyCorrection:()=>{},toastMessage:$,toastType:O,clearToast:()=>{$.value=""},fallbackError:G}}},[["render",function(e,a,t,l,p,m){const g=w("Toast"),f=w("UnifiedInput"),h=w("SkeletonLoader"),b=w("CitationResults");return i(),s("div",Pt,[l.toastMessage?(i(),y(g,{key:0,message:l.toastMessage,type:l.toastType,onClose:l.clearToast},null,8,["message","type","onClose"])):n("",!0),a[16]||(a[16]=o("div",{class:"header"},[o("h1",null,"Citation Validator"),o("p",{class:"subtitle"},"Analyze legal documents, text, or URLs for citation verification")],-1)),o("div",Rt,[o("div",zt,[_(f,{isAnalyzing:l.isLoading,onAnalyze:l.handleUnifiedAnalyze},null,8,["isAnalyzing","onAnalyze"])]),l.showLoading&&!l.results?(i(),s("div",It,[_(h,{lines:4,height:"6em"})])):n("",!0),l.showLoading?(i(),s("div",Mt,[o("div",Dt,[o("div",Ut,[a[12]||(a[12]=o("h5",{class:"card-title"},[o("i",{class:"fas fa-cog fa-spin me-2"}),u(" Processing Citations ")],-1)),o("div",Nt,[o("div",{class:v(["progress-bar progress-bar-striped progress-bar-animated",l.getProgressBarClass(l.totalProgress/100)]),style:k({width:`${l.totalProgress}%`}),role:"progressbar","aria-valuenow":l.totalProgress,"aria-valuemin":"0","aria-valuemax":"100"},r(Math.round(l.totalProgress))+"% ",15,Et)]),o("div",qt,[o("div",Ft,[o("div",Vt,[a[1]||(a[1]=o("small",{class:"text-muted"},"Elapsed",-1)),o("div",jt,r(l.formatTime(l.elapsedTime)),1)])]),o("div",$t,[o("div",Ot,[a[2]||(a[2]=o("small",{class:"text-muted"},"Remaining",-1)),o("div",Bt,r(l.formatTime(l.remainingTime)),1)])]),o("div",Xt,[o("div",Jt,[a[3]||(a[3]=o("small",{class:"text-muted"},"Total Estimate",-1)),o("div",Gt,r(l.formatTime(e.estimatedTotalTime)),1)])])]),l.currentStep?(i(),s("div",Kt,[o("div",Qt,[a[4]||(a[4]=o("span",{class:"fw-semibold"},"Current Step:",-1)),o("span",Yt,r(l.currentStep),1)]),o("div",Ht,[o("div",{class:"progress-bar bg-info",style:k({width:`${l.currentStepProgress}%`}),role:"progressbar","aria-valuenow":l.currentStepProgress,"aria-valuemin":"0","aria-valuemax":"100"},null,12,Wt)])])):n("",!0),l.citationInfo?(i(),s("div",Zt,[o("div",el,[o("div",al,[o("div",tl,[a[5]||(a[5]=o("small",{class:"text-muted"},"Total Citations",-1)),o("div",ll,r(l.citationInfo.total),1)])]),o("div",sl,[o("div",il,[a[6]||(a[6]=o("small",{class:"text-muted"},"Unique",-1)),o("div",nl,r(l.citationInfo.unique),1)])]),o("div",ol,[o("div",rl,[a[7]||(a[7]=o("small",{class:"text-muted"},"Processed",-1)),o("div",ul,r(l.citationInfo.processed),1)])]),o("div",cl,[o("div",dl,[a[8]||(a[8]=o("small",{class:"text-muted"},"Rate",-1)),o("div",vl,r(l.citationInfo.processed>0?Math.round(l.citationInfo.processed/l.elapsedTime):0)+"/sec",1)])])])])):n("",!0),l.processingSteps.length>0?(i(),s("div",pl,[a[10]||(a[10]=o("h6",{class:"mb-2"},"Processing Steps:",-1)),o("div",ml,[(i(!0),s(c,null,d(l.processingSteps,((e,t)=>(i(),s("div",{key:t,class:v(["step-item d-flex justify-content-between align-items-center py-1",{"text-muted":0===e.progress,"text-success":100===e.progress}])},[o("span",gl,r(e.step),1),o("span",fl,[100===e.progress?(i(),s("span",yl,a[9]||(a[9]=[o("i",{class:"fas fa-check"},null,-1),u(" Complete ")]))):e.progress>0?(i(),s("span",hl,r(Math.round(e.progress))+"% ",1)):(i(),s("span",bl,"Pending"))])],2)))),128))])])):n("",!0),l.processingError?(i(),s("div",kl,[a[11]||(a[11]=o("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),u(" "+r(l.processingError)+" ",1),l.canRetry?(i(),s("button",{key:0,onClick:a[0]||(a[0]=(...a)=>e.handleRetry&&e.handleRetry(...a)),class:"btn btn-sm btn-outline-danger ms-2"}," Retry ")):n("",!0)])):n("",!0)])])])):n("",!0),l.results&&!l.showLoading?(i(),s("div",wl,[_(b,{results:l.results,onApplyCorrection:l.applyCorrection,onCopyResults:l.copyResults,onDownloadResults:l.downloadResults,onToast:e.showToast},null,8,["results","onApplyCorrection","onCopyResults","onDownloadResults","onToast"])])):n("",!0),l.error&&!l.showLoading?(i(),s("div",_l,[o("div",xl,[a[13]||(a[13]=o("i",{class:"error-icon"},"‚ùå",-1)),a[14]||(a[14]=o("h3",null,"Analysis Failed",-1)),o("p",null,r(l.error),1)])])):n("",!0),l.results||l.showLoading||l.error?n("",!0):(i(),s("div",Cl,a[15]||(a[15]=[o("div",{class:"empty-content"},[o("div",{class:"empty-icon"},"üìÑ"),o("h2",null,"Ready to Analyze"),o("p",null,"Choose your input method above to get started")],-1)])))])])}],["__scopeId","data-v-48e4264e"]]);export{Ll as default};
