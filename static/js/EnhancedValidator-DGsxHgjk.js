import{r as e,A as a,p as t,B as l,c as s,o as i,l as n,b as r,t as o,g as u,F as c,n as d,u as v,v as p,x as m,y as g,C as f,h as y,w as h,T as _,D as b,f as k,d as w,s as x,E as C,G as A,z as L}from"./vue-core-BXg5zaqj.js";import{c as S,_ as T}from"./index-Daqoqdv0.js";import{a as P}from"./api-Cibp7nif.js";import"./axios-rSMZb3Ae.js";import"./pinia-CQ2rHS-F.js";const z=e(!1),I=e("Loading...");const M={class:"citation-results"},N={key:0,class:"loading-state"},D={key:1,class:"error-state"},R={key:2,class:"results-content"},V={class:"results-header"},U={class:"header-content"},F={class:"summary-stats"},q={class:"stat-item"},E={class:"stat-number"},B={class:"stat-item verified"},$={class:"stat-number"},j={class:"stat-item invalid"},O={class:"stat-number"},H={key:0,class:"stats-section"},J={class:"stats-grid"},G={class:"stat-card"},X={class:"stat-value"},Y={class:"stat-card"},K={class:"stat-value"},Q={class:"stat-card verified"},W={class:"stat-value"},Z={class:"stat-card invalid"},ee={class:"stat-value"},ae={class:"filter-section"},te={class:"filter-controls"},le=["onClick"],se={class:"filter-count"},ie={class:"search-box"},ne={key:1,class:"citations-list"},re={key:0,class:"group-icon"},oe={key:1,class:"group-icon"},ue={class:"group-title"},ce={class:"citation-header"},de={class:"citation-main"},ve=["title","onMouseenter","onClick"],pe={key:0,class:"score-tooltip"},me={class:"case-name"},ge=["href"],fe={key:1},ye={class:"citation-link"},he=["href"],_e={key:1,class:"citation-text"},be={class:"citation-actions"},ke=["onClick","title"],we={key:0,class:"citation-details"},xe={class:"detail-section"},Ce={class:"detail-row"},Ae={class:"detail-value"},Le={key:0,class:"detail-row"},Se={class:"detail-value"},Te={class:"detail-row"},Pe={class:"detail-section"},ze={class:"detail-row"},Ie={class:"detail-value"},Me={class:"detail-row"},Ne={class:"detail-value"},De={class:"detail-row"},Re={class:"detail-value"},Ve={key:0,class:"detail-row"},Ue={key:1,class:"detail-row"},Fe={class:"detail-section"},qe={key:0,class:"detail-row"},Ee={class:"detail-value"},Be={key:1,class:"detail-row"},$e={class:"detail-value"},je={key:2,class:"detail-row"},Oe={class:"detail-value"},He={key:3,class:"detail-row"},Je={class:"detail-value"},Ge={key:4,class:"detail-row"},Xe={class:"detail-value"},Ye={key:0,class:"detail-section"},Ke={class:"detail-row"},Qe={class:"detail-value"},We={key:0,class:"detail-row"},Ze={class:"detail-value"},ea={key:1,class:"detail-row"},aa={class:"detail-value"},ta={key:2,class:"detail-row"},la={key:1,class:"detail-section"},sa={class:"context-box"},ia={key:2,class:"detail-section"},na={class:"parallel-citations"},ra=["href"],oa={key:1},ua={class:"detail-section"},ca={class:"detail-row"},da={class:"detail-value"},va={key:0,class:"detail-row"},pa={class:"detail-value"},ma={key:1,class:"detail-row"},ga={class:"detail-value note"},fa={key:0,class:"pagination"},ya=["disabled"],ha={class:"page-info"},_a=["disabled"],ba={key:2,class:"empty-filter"},ka={key:3,class:"no-results"},wa={class:"modal-body"},xa={class:"detail-section"},Ca={class:"detail-grid"},Aa={class:"detail-item"},La={class:"detail-value"},Sa={class:"detail-item"},Ta={class:"detail-value"},Pa={class:"detail-item"},za={class:"detail-section"},Ia={class:"detail-grid"},Ma={key:0,class:"detail-item"},Na={class:"detail-value"},Da={key:1,class:"detail-item"},Ra={class:"detail-value"},Va={key:2,class:"detail-item"},Ua={class:"detail-value"},Fa={key:3,class:"detail-item"},qa={class:"detail-value"},Ea={key:4,class:"detail-item"},Ba={class:"detail-value"},$a={class:"detail-section"},ja={class:"detail-grid"},Oa={key:0,class:"detail-item"},Ha={class:"detail-value"},Ja={key:1,class:"detail-item"},Ga={class:"detail-value"},Xa={key:2,class:"detail-item"},Ya={class:"detail-value"},Ka={key:3,class:"detail-item"},Qa={class:"detail-value"},Wa={class:"detail-section"},Za={class:"detail-grid"},et={key:0,class:"detail-item"},at={class:"detail-value"},tt={key:1,class:"detail-item"},lt={class:"detail-value"},st={key:2,class:"detail-item"},it={class:"detail-value"},nt={key:0,class:"detail-section"},rt={class:"raw-data"},ot={key:1,class:"detail-section"},ut={class:"parallel-citations"},ct=T({__name:"CitationResults",props:{results:{type:Object,default:null},loading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["apply-correction","copy-results","download-results","toast"],setup(a,{emit:f}){const y=a,h=f,_=e("all"),b=e(""),k=e(1),w=e(null),x=e(new Set),C=e(null),A=t((()=>{var e;return(null==(e=y.results)?void 0:e.citations)?y.results.citations.filter((e=>e.verified)).length:0})),L=t((()=>{var e;return(null==(e=y.results)?void 0:e.citations)?y.results.citations.filter((e=>!e.verified)).length:0})),S=t((()=>{var e;if(!(null==(e=y.results)?void 0:e.citations))return[];let a=y.results.citations;if("verified"===_.value?a=a.filter((e=>e.verified)):"invalid"===_.value&&(a=a.filter((e=>!e.verified))),b.value.trim()){const e=b.value.toLowerCase();a=a.filter((a=>a.citation.toLowerCase().includes(e)||ct(a)&&ct(a).toLowerCase().includes(e)||dt(a)&&dt(a).toLowerCase().includes(e)||mt(a)&&mt(a).toLowerCase().includes(e)||gt(a)&&gt(a).toLowerCase().includes(e)||ft(a)&&ft(a).toLowerCase().includes(e)||yt(a)&&yt(a).toLowerCase().includes(e)||_t(a)&&_t(a).some((a=>a.toLowerCase().includes(e)))||kt(a)&&kt(a).toLowerCase().includes(e)))}return a.sort(((e,a)=>(e.score||0)-(a.score||0))),a})),T=t((()=>Math.ceil(S.value.length/50))),P=t((()=>{const e=50*(k.value-1),a=e+50;return S.value.slice(e,a)})),z=t((()=>{var e,a;return[{value:"all",label:"All",count:(null==(a=null==(e=y.results)?void 0:e.citations)?void 0:a.length)||0},{value:"verified",label:"Verified",count:A.value},{value:"invalid",label:"Invalid",count:L.value}]})),I=t((()=>[{status:"verified",citations:P.value.filter((e=>e.verified))},{status:"unverified",citations:P.value.filter((e=>!e.verified))}].filter((e=>e.citations.length>0)))),ct=e=>{var a,t;return e.case_name||(null==(a=e.metadata)?void 0:a.case_name)||(null==(t=e.group_metadata)?void 0:t.case_name)||null},dt=e=>e.extracted_case_name||null,vt=e=>e.case_name_similarity||null,pt=e=>e.case_name_mismatch||!1,mt=e=>{var a,t;return e.court||(null==(a=e.metadata)?void 0:a.court)||(null==(t=e.group_metadata)?void 0:t.court)||null},gt=e=>{var a,t;return e.docket_number||(null==(a=e.metadata)?void 0:a.docket)||(null==(t=e.group_metadata)?void 0:t.docket)||null},ft=e=>{var a;return e.date_filed||(null==(a=e.group_metadata)?void 0:a.date_filed)||null},yt=e=>e.extracted_date||null,ht=e=>{var a;return e.canonical_date||(null==(a=e.group_metadata)?void 0:a.canonical_date)||null},_t=e=>e.parallel_citations&&e.parallel_citations.length>0?e.parallel_citations:e.all_citations||[],bt=e=>{var a,t;return e.url||(null==(a=e.metadata)?void 0:a.url)||(null==(t=e.group_metadata)?void 0:t.url)||null},kt=e=>{var a;const t=e.url||"";if(t)try{return new URL(t).hostname.replace(/^www\./,"")}catch(s){return t}const l=e.citation_url||"";if(l)try{return new URL(l).hostname.replace(/^www\./,"")}catch(s){return l}return e.source||(null==(a=e.metadata)?void 0:a.source)||"Unknown"},wt=e=>e.note||null,xt=e=>{if(!e)return"N/A";const a=/^\d{4}/.exec(e);if(a)return a[0];try{return new Date(e).getFullYear()}catch(t){return e}},Ct=async()=>{try{const e=S.value.map((e=>`${e.citation} - ${e.verified?"Verified":"Invalid"}`)).join("\n");await navigator.clipboard.writeText(e),h("copy-results"),h("toast","Results copied to clipboard!","success")}catch(e){h("toast","Failed to copy results","error")}},At=()=>{try{const e={timestamp:(new Date).toISOString(),total:S.value.length,verified:A.value,invalid:L.value,citations:S.value.map((e=>({citation:e.citation,verified:e.verified,case_name:ct(e),extracted_case_name:dt(e),case_name_similarity:vt(e),case_name_mismatch:pt(e),court:mt(e),docket_number:gt(e),date_filed:ft(e),extracted_date:yt(e),parallel_citations:_t(e),url:bt(e),source:kt(e),note:wt(e),metadata:e.metadata})))},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),l=document.createElement("a");l.href=t,l.download=`citation-results-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t),h("download-results"),h("toast","Results downloaded successfully!","success")}catch(e){h("toast","Failed to download results","error")}},Lt=()=>{k.value=1};l(_,Lt),l(b,Lt);const St=e=>{if(!e)return"";if("string"==typeof e)return e;if("object"==typeof e){if(e.citation)return e.citation;if(e.cite)return e.cite;if(e.text)return e.text;if(e.volume||e.reporter||e.page){const a=e.volume||"",t=e.reporter||"",l=e.page||"",s=e.year||"";let i=[a,t,l].filter(Boolean).join(" ");if(s&&i&&!i.includes(s)&&(i+=` (${s})`),i)return i}return String(e)}return String(e)},Tt=e=>{if(!e)return"";let a=e.citation;if(Array.isArray(a)){if(a.length>0)return a[0]}else if("string"==typeof a)return a;let t=e.canonical_citation;if(Array.isArray(t)){if(t.length>0)return t[0]}else if("string"==typeof t)return t;return e.cite?e.cite:e.text?e.text:"Citation not available"},Pt=e=>{let a=e.citation;return Array.isArray(a)&&a.length>1?a.slice(1):!Array.isArray(a)&&Array.isArray(e.canonical_citation)&&e.canonical_citation.length>1?e.canonical_citation.slice(1):Array.isArray(e.parallel_citations)&&e.parallel_citations.length>0?e.parallel_citations:[]},zt=()=>{w.value=null},It=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString()}catch(a){return e}},Mt=e=>{if(!e)return"N/A";try{const a="string"==typeof e?JSON.parse(e):e;return JSON.stringify(a,null,2)}catch(a){return e}},Nt=()=>{C.value=null};return(e,t)=>(i(),s("div",M,[a.loading?(i(),s("div",N,t[4]||(t[4]=[r("div",{class:"loading-spinner"},null,-1),r("h3",null,"Analyzing citations...",-1)]))):a.error?(i(),s("div",D,[t[5]||(t[5]=r("div",{class:"error-icon"},"‚ùå",-1)),t[6]||(t[6]=r("h3",null,"Analysis Error",-1)),r("p",null,o(a.error),1)])):a.results&&a.results.citations&&a.results.citations.length>0?(i(),s("div",R,[r("div",V,[r("div",U,[t[10]||(t[10]=r("h2",null,"Citation Analysis Results",-1)),r("div",F,[r("div",q,[r("span",E,o(a.results.citations.length),1),t[7]||(t[7]=r("span",{class:"stat-label"},"Total",-1))]),r("div",B,[r("span",$,o(A.value),1),t[8]||(t[8]=r("span",{class:"stat-label"},"Verified",-1))]),r("div",j,[r("span",O,o(L.value),1),t[9]||(t[9]=r("span",{class:"stat-label"},"Invalid",-1))])])]),r("div",{class:"action-buttons"},[r("button",{onClick:Ct,class:"action-btn copy-btn"},t[11]||(t[11]=[r("span",{class:"btn-icon"},"üìã",-1),u(" Copy Results ")])),r("button",{onClick:At,class:"action-btn download-btn"},t[12]||(t[12]=[r("span",{class:"btn-icon"},"üíæ",-1),u(" Download ")]))])]),a.results.stats?(i(),s("div",H,[t[17]||(t[17]=r("h3",null,"Processing Breakdown",-1)),r("div",J,[r("div",G,[r("span",X,o(a.results.stats.total_extracted),1),t[13]||(t[13]=r("span",{class:"stat-title"},"Extracted",-1))]),r("div",Y,[r("span",K,o(a.results.stats.deduplicated),1),t[14]||(t[14]=r("span",{class:"stat-title"},"Unique",-1))]),r("div",Q,[r("span",W,o(a.results.stats.verified_in_cache+a.results.stats.verified_in_json_array+a.results.stats.verified_in_text_blob+a.results.stats.verified_in_single+a.results.stats.verified_in_langsearch),1),t[15]||(t[15]=r("span",{class:"stat-title"},"Verified",-1))]),r("div",Z,[r("span",ee,o(a.results.stats.not_verified),1),t[16]||(t[16]=r("span",{class:"stat-title"},"Not Verified",-1))])])])):n("",!0),r("div",ae,[r("div",te,[(i(!0),s(c,null,d(z.value,(e=>(i(),s("button",{key:e.value,class:v(["filter-btn",{active:_.value===e.value}]),onClick:a=>_.value=e.value},[u(o(e.label)+" ",1),r("span",se,"("+o(e.count)+")",1)],10,le)))),128))]),r("div",ie,[p(r("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),type:"text",placeholder:"Search citations...",class:"search-input"},null,512),[[m,b.value]])])]),S.value.length>0?(i(),s("div",ne,[(i(!0),s(c,null,d(I.value,((e,a)=>(i(),s(c,{key:e.status},[r("div",{class:v(["group-header",e.status])},["verified"===e.status?(i(),s("span",re,"‚úîÔ∏è")):"unverified"===e.status?(i(),s("span",oe,"‚ùå")):n("",!0),r("span",ue,o("verified"===e.status?"Verified Citations":"Unverified Citations")+" ("+o(e.citations.length)+") ",1)],2),(i(!0),s(c,null,d(e.citations,(e=>{var a,l,p;return i(),s("div",{key:e.id||e.citation||(null==(a=e.parallel_citations)?void 0:a.join("-")),class:v(["citation-item",{verified:e.verified,invalid:!e.verified}])},[r("div",ce,[r("div",de,[r("div",{class:v(["score-flag",`score-${e.scoreColor}`]),title:(p=e.score,{0:"No verification data available",1:"Limited verification - some data available",2:"Good verification - case name found",3:"Very good verification - case name and additional data",4:"Excellent verification - all data matches"}[p]||"Unknown score"),onMouseenter:a=>(e=>{C.value=e})(e),onMouseleave:Nt,onClick:a=>(e=>{C.value=C.value===e?null:e})(e),style:{cursor:"pointer",position:"relative"}},[u(o(e.score)+"/4 ",1),C.value===e?(i(),s("div",pe,[t[21]||(t[21]=r("div",null,[r("strong",null,"Score Breakdown:")],-1)),r("div",null,[t[18]||(t[18]=u("Case name match: ")),r("span",{class:v({"text-success":e.case_name&&"N/A"!==e.case_name})},o(e.case_name&&"N/A"!==e.case_name?"+2":"0"),3)]),r("div",null,[t[19]||(t[19]=u("Hinted name similarity: ")),r("span",{class:v({"text-success":vt(e)>=.5})},o(vt(e)>=.5?"+1":"0"),3)]),r("div",null,[t[20]||(t[20]=u("Year match: ")),r("span",{class:v({"text-success":yt(e)&&ht(e)&&yt(e).substring(0,4)===ht(e).substring(0,4)})},o(yt(e)&&ht(e)&&yt(e).substring(0,4)===ht(e).substring(0,4)?"+1":"0"),3)])])):n("",!0)],42,ve),r("div",me,[e.verified&&bt(e)?(i(),s("a",{key:0,href:bt(e),target:"_blank",class:"case-name-link",title:"View case details"},o(ct(e)||"Unknown Case"),9,ge)):(i(),s("span",fe,o(ct(e)||"Unknown Case"),1))]),r("div",ye,[e.verified&&bt(e)?(i(),s("a",{key:0,href:bt(e),target:"_blank",class:"citation-hyperlink",title:"View case details"},o(Tt(e)),9,he)):(i(),s("span",_e,o(Tt(e)),1))])]),r("div",be,[r("button",{onClick:a=>{return t=e,void(x.value.has(t.citation)?x.value.delete(t.citation):x.value.add(t.citation));var t},class:v(["expand-btn",{expanded:x.value.has(e.citation)}]),title:x.value.has(e.citation)?"Hide details":"Show details"},o(x.value.has(e.citation)?"‚ñº":"‚ñ∂"),11,ke)])]),x.value.has(e.citation)?(i(),s("div",we,[r("div",xe,[t[28]||(t[28]=r("h4",{class:"section-title"},"Citation Information",-1)),r("div",Ce,[t[22]||(t[22]=r("span",{class:"detail-label"},"Citation Text:",-1)),t[23]||(t[23]=u()),r("span",Ae,o(Tt(e)),1)]),e.id?(i(),s("div",Le,[t[24]||(t[24]=r("span",{class:"detail-label"},"Database ID:",-1)),t[25]||(t[25]=u()),r("span",Se,o(e.id),1)])):n("",!0),r("div",Te,[t[26]||(t[26]=r("span",{class:"detail-label"},"Status:",-1)),t[27]||(t[27]=u()),r("span",{class:v(["detail-value",e.verified?"verified":"invalid"])},o(e.verified?"Verified":"Not Verified"),3)])]),r("div",Pe,[t[38]||(t[38]=r("h4",{class:"section-title"},"Case Information",-1)),r("div",ze,[t[29]||(t[29]=r("span",{class:"detail-label"},"Canonical Case Name:",-1)),t[30]||(t[30]=u()),r("span",Ie,o(ct(e)||"N/A"),1)]),r("div",Me,[t[31]||(t[31]=r("span",{class:"detail-label"},"Extracted Case Name:",-1)),t[32]||(t[32]=u()),r("span",Ne,o(dt(e)||"N/A"),1)]),r("div",De,[t[33]||(t[33]=r("span",{class:"detail-label"},"Hinted Case Name:",-1)),t[34]||(t[34]=u()),r("span",Re,o(e.hinted_case_name||"N/A"),1)]),null!==vt(e)?(i(),s("div",Ve,[t[35]||(t[35]=r("span",{class:"detail-label"},"Name Similarity:",-1)),t[36]||(t[36]=u()),r("span",{class:v(["detail-value",(l=vt(e),l>=.8?"high-similarity":l>=.6?"medium-similarity":"low-similarity")])},o((100*vt(e)).toFixed(1))+"%",3)])):n("",!0),pt(e)?(i(),s("div",Ue,t[37]||(t[37]=[r("span",{class:"detail-label"},"Name Mismatch:",-1),u(),r("span",{class:"detail-value warning"},"‚ö†Ô∏è Case names differ significantly",-1)]))):n("",!0)]),r("div",Fe,[t[49]||(t[49]=r("h4",{class:"section-title"},"Citation Components",-1)),e.volume?(i(),s("div",qe,[t[39]||(t[39]=r("span",{class:"detail-label"},"Volume:",-1)),t[40]||(t[40]=u()),r("span",Ee,o(e.volume),1)])):n("",!0),e.reporter?(i(),s("div",Be,[t[41]||(t[41]=r("span",{class:"detail-label"},"Reporter:",-1)),t[42]||(t[42]=u()),r("span",$e,o(e.reporter),1)])):n("",!0),e.page?(i(),s("div",je,[t[43]||(t[43]=r("span",{class:"detail-label"},"Page:",-1)),t[44]||(t[44]=u()),r("span",Oe,o(e.page),1)])):n("",!0),e.year?(i(),s("div",He,[t[45]||(t[45]=r("span",{class:"detail-label"},"Year:",-1)),t[46]||(t[46]=u()),r("span",Je,o(e.year),1)])):n("",!0),e.court?(i(),s("div",Ge,[t[47]||(t[47]=r("span",{class:"detail-label"},"Court:",-1)),t[48]||(t[48]=u()),r("span",Xe,o(e.court),1)])):n("",!0)]),ft(e)||yt(e)||ht(e)?(i(),s("div",Ye,[t[58]||(t[58]=r("h4",{class:"section-title"},"Decision Information",-1)),r("div",Ke,[t[50]||(t[50]=r("span",{class:"detail-label"},"Extracted Date:",-1)),t[51]||(t[51]=u()),r("span",Qe,o(xt(yt(e))||"N/A"),1)]),ht(e)?(i(),s("div",We,[t[52]||(t[52]=r("span",{class:"detail-label"},"Canonical Date (Case Name):",-1)),t[53]||(t[53]=u()),r("span",Ze,o(xt(ht(e))),1)])):n("",!0),ft(e)?(i(),s("div",ea,[t[54]||(t[54]=r("span",{class:"detail-label"},"Canonical Date (Verified):",-1)),t[55]||(t[55]=u()),r("span",aa,o(xt(ft(e))),1)])):n("",!0),yt(e)&&ft(e)?(i(),s("div",ta,[t[56]||(t[56]=r("span",{class:"detail-label"},"Date Match:",-1)),t[57]||(t[57]=u()),r("span",{class:v(["detail-value",yt(e)===ft(e)?"high-similarity":"low-similarity"])},o(yt(e)===ft(e)?"‚úì Match":"‚úó Different"),3)])):n("",!0)])):n("",!0),e.context?(i(),s("div",la,[t[59]||(t[59]=r("h4",{class:"section-title"},"Context",-1)),r("div",sa,o(e.context),1)])):n("",!0),Pt(e)&&Pt(e).length>0?(i(),s("div",ia,[t[60]||(t[60]=r("h4",{class:"section-title"},"Additional Parallel Citations",-1)),r("div",na,[(i(!0),s(c,null,d(Pt(e),((a,t)=>(i(),s("span",{key:t,class:"parallel-citation"},[e.verified&&a.url?(i(),s("a",{key:0,href:a.url,target:"_blank",class:"parallel-citation-link",title:"View case details for this citation"},o(St(a)),9,ra)):(i(),s("span",oa,o(St(a)),1))])))),128))])])):n("",!0),r("div",ua,[t[67]||(t[67]=r("h4",{class:"section-title"},"Verification Details",-1)),r("div",ca,[t[61]||(t[61]=r("span",{class:"detail-label"},"Source:",-1)),t[62]||(t[62]=u()),r("span",da,o(kt(e)||"N/A"),1)]),void 0!==e.confidence?(i(),s("div",va,[t[63]||(t[63]=r("span",{class:"detail-label"},"Confidence:",-1)),t[64]||(t[64]=u()),r("span",pa,o((100*e.confidence).toFixed(1))+"%",1)])):n("",!0),wt(e)?(i(),s("div",ma,[t[65]||(t[65]=r("span",{class:"detail-label"},"Note:",-1)),t[66]||(t[66]=u()),r("span",ga,o(wt(e)),1)])):n("",!0)])])):n("",!0)],2)})),128))],64)))),128)),T.value>1?(i(),s("div",fa,[r("button",{onClick:t[1]||(t[1]=e=>k.value--),disabled:k.value<=1,class:"pagination-btn"}," ‚Üê Previous ",8,ya),r("span",ha,"Page "+o(k.value)+" of "+o(T.value),1),r("button",{onClick:t[2]||(t[2]=e=>k.value++),disabled:k.value>=T.value,class:"pagination-btn"}," Next ‚Üí ",8,_a)])):n("",!0)])):n("",!0),0===S.value.length&&a.results.citations.length>0?(i(),s("div",ba,t[68]||(t[68]=[r("div",{class:"empty-icon"},"üîç",-1),r("h3",null,"No citations match your filter",-1),r("p",null,"Try adjusting your search or filter criteria",-1)]))):n("",!0)])):(i(),s("div",ka,t[69]||(t[69]=[r("div",{class:"no-results-icon"},"üìÑ",-1),r("h3",null,"No Citations Found",-1),r("p",null,"The document didn't contain any recognizable legal citations",-1)]))),w.value?(i(),s("div",{key:4,class:"modal-overlay",onClick:zt},[r("div",{class:"modal-content",onClick:t[3]||(t[3]=g((()=>{}),["stop"]))},[r("div",{class:"modal-header"},[t[70]||(t[70]=r("h3",null,"Citation Details",-1)),r("button",{onClick:zt,class:"modal-close"},"√ó")]),r("div",wa,[r("div",xa,[t[74]||(t[74]=r("h4",null,"Citation Information",-1)),r("div",Ca,[r("div",Aa,[t[71]||(t[71]=r("span",{class:"detail-label"},"Citation Text:",-1)),r("span",La,o(Tt(w.value)),1)]),r("div",Sa,[t[72]||(t[72]=r("span",{class:"detail-label"},"Database ID:",-1)),r("span",Ta,o(w.value.id||"N/A"),1)]),r("div",Pa,[t[73]||(t[73]=r("span",{class:"detail-label"},"Status:",-1)),r("span",{class:v(["detail-value",w.value.verified?"verified":"invalid"])},o(w.value.verified?"Verified":"Not Verified"),3)])])]),r("div",za,[t[80]||(t[80]=r("h4",null,"Citation Components",-1)),r("div",Ia,[w.value.volume?(i(),s("div",Ma,[t[75]||(t[75]=r("span",{class:"detail-label"},"Volume:",-1)),r("span",Na,o(w.value.volume),1)])):n("",!0),w.value.reporter?(i(),s("div",Da,[t[76]||(t[76]=r("span",{class:"detail-label"},"Reporter:",-1)),r("span",Ra,o(w.value.reporter),1)])):n("",!0),w.value.page?(i(),s("div",Va,[t[77]||(t[77]=r("span",{class:"detail-label"},"Page:",-1)),r("span",Ua,o(w.value.page),1)])):n("",!0),w.value.year?(i(),s("div",Fa,[t[78]||(t[78]=r("span",{class:"detail-label"},"Year:",-1)),r("span",qa,o(w.value.year),1)])):n("",!0),w.value.court?(i(),s("div",Ea,[t[79]||(t[79]=r("span",{class:"detail-label"},"Court:",-1)),r("span",Ba,o(w.value.court),1)])):n("",!0)])]),r("div",$a,[t[85]||(t[85]=r("h4",null,"Verification Details",-1)),r("div",ja,[w.value.verification_source?(i(),s("div",Oa,[t[81]||(t[81]=r("span",{class:"detail-label"},"Verification Source:",-1)),r("span",Ha,o(w.value.verification_source),1)])):n("",!0),void 0!==w.value.verification_confidence?(i(),s("div",Ja,[t[82]||(t[82]=r("span",{class:"detail-label"},"Verification Confidence:",-1)),r("span",Ga,o((100*w.value.verification_confidence).toFixed(1))+"%",1)])):n("",!0),void 0!==w.value.verification_count?(i(),s("div",Xa,[t[83]||(t[83]=r("span",{class:"detail-label"},"Times Verified:",-1)),r("span",Ya,o(w.value.verification_count),1)])):n("",!0),void 0!==w.value.error_count?(i(),s("div",Ka,[t[84]||(t[84]=r("span",{class:"detail-label"},"Verification Errors:",-1)),r("span",Qa,o(w.value.error_count),1)])):n("",!0)])]),r("div",Wa,[t[89]||(t[89]=r("h4",null,"Database Timestamps",-1)),r("div",Za,[w.value.created_at?(i(),s("div",et,[t[86]||(t[86]=r("span",{class:"detail-label"},"First Added:",-1)),r("span",at,o(It(w.value.created_at)),1)])):n("",!0),w.value.updated_at?(i(),s("div",tt,[t[87]||(t[87]=r("span",{class:"detail-label"},"Last Updated:",-1)),r("span",lt,o(It(w.value.updated_at)),1)])):n("",!0),w.value.last_verified_at?(i(),s("div",st,[t[88]||(t[88]=r("span",{class:"detail-label"},"Last Verified:",-1)),r("span",it,o(It(w.value.last_verified_at)),1)])):n("",!0)])]),w.value.verification_result?(i(),s("div",nt,[t[90]||(t[90]=r("h4",null,"Raw Verification Data",-1)),r("div",rt,[r("pre",null,o(Mt(w.value.verification_result)),1)])])):n("",!0),Pt(w.value)&&Pt(w.value).length>0?(i(),s("div",ot,[t[91]||(t[91]=r("h4",null,"Additional Parallel Citations",-1)),r("div",ut,[(i(!0),s(c,null,d(Pt(w.value),((e,a)=>(i(),s("span",{key:a,class:"parallel-citation"},o(St(e)),1)))),128))])])):n("",!0)]),r("div",{class:"modal-footer"},[r("button",{onClick:zt,class:"btn btn-secondary"},"Close")])])])):n("",!0)]))}},[["__scopeId","data-v-3f235739"]]),dt={class:"unified-input"},vt={class:"input-methods-top"},pt={class:"method-icon"},mt={class:"method-content"},gt={key:0,class:"active-indicator"},ft={class:"method-icon"},yt={class:"method-content"},ht={key:0,class:"active-indicator"},_t={key:0,class:"input-area-top"},bt={key:0,class:"file-input"},kt=["disabled"],wt={key:0,class:"drop-zone-content"},xt={key:1,class:"file-info"},Ct={class:"file-details"},At={key:0,class:"validation-errors"},Lt={key:1,class:"url-input"},St=["disabled"],Tt={class:"input-footer"},Pt={key:0,class:"url-preview"},zt={key:1,class:"url-error"},It={key:0,class:"validation-errors"},Mt={class:"input-methods-bottom"},Nt={class:"method-icon"},Dt={class:"method-content"},Rt={key:0,class:"active-indicator"},Vt={class:"method-icon"},Ut={class:"method-content"},Ft={key:0,class:"active-indicator"},qt={class:"analyze-section"},Et=["disabled"],Bt={key:0,class:"analyzing-spinner"},$t={key:1,class:"analyze-icon"},jt={key:0,class:"validation-summary"},Ot={key:1,class:"input-area-bottom"},Ht={key:0,class:"text-input"},Jt=["disabled"],Gt={class:"input-footer"},Xt={key:0,class:"min-length-hint"},Yt={key:0,class:"validation-errors"},Kt={key:1,class:"quick-citation-input-area"},Qt=["disabled"],Wt={__name:"UnifiedInput",props:{isAnalyzing:{type:Boolean,default:!1}},emits:["analyze"],setup(a,{emit:l}){const y=a,h=l,_="Paste Text",b="URL",k="Upload File",w="Quick Citation",x="Paste legal text or citations directly",C="Analyze content from a web URL",A="Upload a document for analysis",L="Enter a single citation and analyze instantly",S="üìù",T="üîó",P="üìÅ",z="üîé",I={minLength:10,maxLength:5e4,minLengthMessage:"Text must be at least 10 characters long",maxLengthMessage:"Text is too long. Maximum 50,000 characters allowed."},M={maxLength:2048,maxLengthMessage:"URL is too long. Maximum 2,048 characters allowed."},N={maxSize:52428800,allowedTypes:[".pdf",".doc",".docx",".txt"],maxSizeMessage:"File is too large. Maximum 50MB allowed.",typeMessage:"Invalid file type. Please upload PDF, DOC, DOCX, or TXT files."},D=e("text"),R=e(""),V=e(""),U=e(null),F=e(!1),q=e(null),E=e(""),B=e({}),$=e({text:!1,url:!1,file:!1,quick:!1}),j=e(!1);function O(){const e={};"text"===D.value?e.text=function(e){const a=[],t=I;return e.trim()?e.length<t.minLength?a.push(t.minLengthMessage):e.length>t.maxLength&&a.push(t.maxLengthMessage):a.push("Text is required"),/[\x00-\x08\x0B\x0C\x0E-\x1F]/.test(e)&&a.push("Text contains invalid characters. Please remove any special characters."),a}(R.value):"url"===D.value?e.url=function(e){const a=[],t=M;return e.trim()?e.length>t.maxLength?a.push(t.maxLengthMessage):/^https?:\/\//.test(e)?/\./.test(e)||a.push("URL must contain a dot"):a.push("URL must start with http:// or https://"):a.push("URL is required"),a}(V.value):"file"===D.value&&(e.file=function(e){const a=[],t=N;if(e){e.size>t.maxSize&&a.push(t.maxSizeMessage),0===e.size&&a.push("File is empty");const l="."+e.name.split(".").pop().toLowerCase();t.allowedTypes.includes(l)||a.push(t.typeMessage)}else a.push("Please select a file");return a}(U.value)),B.value=e}function H(){$.value[D.value]=!0,j.value=!1,O()}const J=t((()=>B.value[D.value]||[])),G=t((()=>J.value.length>0)),X=t((()=>{let e=!1;return!y.isAnalyzing&&("text"===D.value?e=R.value.length>=I.minLength&&R.value.length<=I.maxLength:"url"===D.value?e=V.value.length>0:"file"===D.value?e=!!U.value:"quick"===D.value&&(e=E.value.trim().length>0),e)}));function Y(e){e.preventDefault(),e.stopPropagation(),U.value=e.target.files[0]||null,F.value=!1,H()}function K(e){e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.files[0];a&&(U.value=a,H()),F.value=!1}function Q(){var e;y.isAnalyzing||null==(e=q.value)||e.click()}function W(){U.value=null,q.value&&(q.value.value=""),H()}function Z(){X.value?(j.value=!1,"text"===D.value?h("analyze",{text:R.value,type:"text"}):"url"===D.value?h("analyze",{url:V.value,type:"url"}):"file"===D.value?h("analyze",{file:U.value,type:"file"}):"quick"===D.value&&(h("analyze",{text:E.value.trim(),type:"text",quick:!0}),E.value="")):j.value=!0}function ee(e){if(!e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]}function ae(){B.value={},$.value={text:!1,url:!1,file:!1,quick:!1},j.value=!1,O()}return(e,t)=>(i(),s("div",dt,[r("div",vt,[r("div",{class:v(["input-method-card",{active:"file"===D.value,disabled:a.isAnalyzing}]),onClick:t[0]||(t[0]=e=>!a.isAnalyzing&&(D.value="file",ae()))},[r("div",pt,o(P),1),r("div",mt,[r("h4",null,o(k),1),r("p",null,o(A),1)]),"file"===D.value?(i(),s("div",gt,"‚úì")):n("",!0)],2),r("div",{class:v(["input-method-card",{active:"url"===D.value,disabled:a.isAnalyzing}]),onClick:t[1]||(t[1]=e=>!a.isAnalyzing&&(D.value="url",ae()))},[r("div",ft,o(T),1),r("div",yt,[r("h4",null,o(b),1),r("p",null,o(C),1)]),"url"===D.value?(i(),s("div",ht,"‚úì")):n("",!0)],2)]),"file"===D.value||"url"===D.value?(i(),s("div",_t,["file"===D.value?(i(),s("div",bt,[t[12]||(t[12]=r("label",null,"Upload a document",-1)),r("div",{class:v(["file-drop-zone",{"has-file":U.value,dragover:F.value,error:G.value&&$.value.file}]),onDrop:K,onDragover:t[2]||(t[2]=g((e=>F.value=!0),["prevent"])),onDragleave:t[3]||(t[3]=g((e=>F.value=!1),["prevent"])),onClick:Q},[r("input",{ref_key:"fileInput",ref:q,type:"file",onChange:Y,disabled:a.isAnalyzing,accept:".pdf,.doc,.docx,.txt",style:{display:"none"}},null,40,kt),U.value?(i(),s("div",xt,[t[10]||(t[10]=r("div",{class:"file-icon"},"üìÑ",-1)),r("div",Ct,[r("strong",null,o(U.value.name),1),r("span",null,o(ee(U.value.size)),1)]),a.isAnalyzing?n("",!0):(i(),s("button",{key:0,onClick:g(W,["stop"]),class:"clear-file-btn"}," ‚úï "))])):(i(),s("div",wt,t[9]||(t[9]=[r("div",{class:"upload-icon"},"üìÅ",-1),r("p",null,"Click to browse or drag & drop",-1),r("p",{class:"file-types"},"Supports: PDF, DOC, DOCX, TXT (max 50MB)",-1)])))],34),G.value&&$.value.file?(i(),s("div",At,[(i(!0),s(c,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[11]||(t[11]=r("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),u(" "+o(e),1)])))),128))])):n("",!0)])):"url"===D.value?(i(),s("div",Lt,[t[14]||(t[14]=r("label",null,"Enter URL to analyze",-1)),p(r("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>V.value=e),type:"url",placeholder:"https://example.com/document.pdf",disabled:a.isAnalyzing,onInput:H,class:v({error:G.value&&$.value.url})},null,42,St),[[m,V.value]]),r("div",Tt,[V.value&&!G.value?(i(),s("span",Pt,"Will analyze: "+o(V.value),1)):V.value&&G.value?(i(),s("span",zt,"Invalid URL format")):n("",!0)]),G.value&&$.value.url?(i(),s("div",It,[(i(!0),s(c,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[13]||(t[13]=r("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),u(" "+o(e),1)])))),128))])):n("",!0)])):n("",!0)])):n("",!0),r("div",Mt,[r("div",{class:v(["input-method-card",{active:"quick"===D.value,disabled:a.isAnalyzing}]),onClick:t[5]||(t[5]=e=>!a.isAnalyzing&&(D.value="quick",ae()))},[r("div",Nt,o(z),1),r("div",Dt,[r("h4",null,o(w),1),r("p",null,o(L),1)]),"quick"===D.value?(i(),s("div",Rt,"‚úì")):n("",!0)],2),r("div",{class:v(["input-method-card",{active:"text"===D.value,disabled:a.isAnalyzing}]),onClick:t[6]||(t[6]=e=>!a.isAnalyzing&&(D.value="text",ae()))},[r("div",Vt,o(S),1),r("div",Ut,[r("h4",null,o(_),1),r("p",null,o(x),1)]),"text"===D.value?(i(),s("div",Ft,"‚úì")):n("",!0)],2)]),r("div",qt,[r("button",{class:v(["analyze-btn",{disabled:!X.value||a.isAnalyzing}]),disabled:!X.value||a.isAnalyzing,onClick:Z},[a.isAnalyzing?(i(),s("span",Bt)):(i(),s("span",$t,"üîç")),u(" "+o(a.isAnalyzing?"Analyzing...":"Analyze Content"),1)],10,Et),j.value&&G.value?(i(),s("div",jt,t[15]||(t[15]=[r("p",null,"Please fix the errors above before analyzing",-1)]))):n("",!0)]),"text"===D.value||"quick"===D.value?(i(),s("div",Ot,["text"===D.value?(i(),s("div",Ht,[t[17]||(t[17]=r("label",null,"Paste your text here",-1)),p(r("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>R.value=e),placeholder:"Paste legal text, citations, or document content here...",disabled:a.isAnalyzing,rows:"6",onInput:H,class:v({error:G.value&&$.value.text})},null,42,Jt),[[m,R.value]]),r("div",Gt,[r("span",{class:v(["char-count",{error:R.value.length>I.maxLength}])},o(R.value.length)+" / "+o(I.maxLength)+" characters ",3),R.value.length<I.minLength&&$.value.text?(i(),s("span",Xt," Minimum "+o(I.minLength)+" characters required ",1)):n("",!0)]),G.value&&$.value.text?(i(),s("div",Yt,[(i(!0),s(c,null,d(J.value,(e=>(i(),s("div",{key:e,class:"error-message"},[t[16]||(t[16]=r("span",{class:"error-icon"},"‚ö†Ô∏è",-1)),u(" "+o(e),1)])))),128))])):n("",!0)])):"quick"===D.value?(i(),s("div",Kt,[t[18]||(t[18]=r("label",null,"Enter a single citation",-1)),p(r("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>E.value=e),type:"text",placeholder:"Enter citation...",disabled:a.isAnalyzing,onKeyup:f(Z,["enter"]),class:"quick-citation-input"},null,40,Qt),[[m,E.value]])])):n("",!0)])):n("",!0)]))}},Zt={class:"toast-icon"},el={class:"toast-message"},al={class:"enhanced-validator"},tl={class:"header text-center mb-4"},ll={class:"main-content"},sl={key:0,class:"progress-container"},il={key:1,class:"processing-section mb-4"},nl={key:2,class:"processing-section mb-4"},rl={class:"card"},ol={class:"card-body text-center"},ul={class:"mt-2"},cl={class:"progress mt-3",style:{height:"1.5rem"}},dl=["aria-valuenow"],vl={key:0,class:"mt-2 text-muted"},pl={key:3,class:"results-container"},ml={key:4,class:"error-container"},gl={class:"error-card"},fl={key:5,class:"no-results-state text-center mt-5"};const yl=T({name:"EnhancedValidator",components:{CitationResults:ct,UnifiedInput:T(Wt,[["__scopeId","data-v-9b2cf9c8"]]),Toast:T({__name:"Toast",props:{message:String,type:{type:String,default:"info"},duration:{type:Number,default:3500}},emits:["close"],setup(a,{emit:u}){const c=a,d=u,p=e(!0),m=t((()=>"success"===c.type?"‚úÖ":"error"===c.type?"‚ùå":"‚ÑπÔ∏è"));function g(){p.value=!1,d("close")}return l((()=>c.message),(e=>{e&&(p.value=!0,setTimeout(g,c.duration))})),(e,t)=>(i(),y(_,{name:"toast-fade"},{default:h((()=>[p.value?(i(),s("div",{key:0,class:v(["toast",a.type])},[r("span",Zt,o(m.value),1),r("span",el,o(a.message),1),r("button",{class:"toast-close",onClick:g},"√ó")],2)):n("",!0)])),_:1}))}},[["__scopeId","data-v-a1e0936f"]]),SkeletonLoader:T({__name:"SkeletonLoader",props:{lines:{type:Number,default:3},height:{type:String,default:"auto"},width:{type:String,default:"100%"}},setup:e=>(a,t)=>(i(),s("div",{class:"skeleton-loader",style:b({height:e.height,width:e.width})},[(i(!0),s(c,null,d(e.lines,(e=>(i(),s("div",{key:e,class:"skeleton-line"})))),128))],4))},[["__scopeId","data-v-1c57e4a2"]])},setup(){const s=C();L();const i=e(null),n=e(null),{isLoading:r,cancel:o}=function(t={}){const{loadingMessage:l="Loading...",showLoading:s=!0,onSuccess:i,onError:n,onFinally:r}=t,o=e(null),u=e(null),c=e(!1),d=e(null);let v=null,p=null;const m=`api_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return a((()=>{p&&p.abort(),v&&v.remove()})),{execute:async function(e,a={}){var g;const{message:f=l,showLoader:y=s,signal:h,..._}={...t,...a};u.value=null,d.value=null,o.value=null,y&&(v=S(m,{message:f})),c.value=!0,"undefined"!=typeof AbortController&&(p=new AbortController,_.signal=h||p.signal);try{const a=await e({..._,signal:_.signal});return o.value=a.data||a,d.value=a.status||200,i&&i(a),a}catch(b){throw u.value=b,d.value=(null==(g=b.response)?void 0:g.status)||0,n&&n(b),b}finally{c.value=!1,v&&(u.value?v.error(u.value):v.complete(),v=null),r&&r(),p=null}},cancel:function(){p&&(p.abort(),p=null),v&&(v.remove(),v=null),c.value=!1},data:o,error:u,isLoading:c,status:d}}({loadingMessage:"Validating citation...",showLoading:!0}),u=e(!1),{isLoading:c}=function(){const e=(e,a="Loading...")=>{z.value=e,a&&(I.value=a)};return{isLoading:t((()=>z.value)),loadingMessage:t((()=>I.value)),setLoading:e,showLoading:a=>{e(!0,a)},hideLoading:()=>{e(!1)},toggleLoading:a=>{e(!z.value,a)}}}(),d=t((()=>r.value||c.value||u.value)),{elapsedTime:v,remainingTime:p,totalProgress:m,currentStep:g,currentStepProgress:f,processingSteps:y,actualTimes:h,citationInfo:_,rateLimitInfo:b,timeout:k,processingError:w,canRetry:T,startProcessing:M,stopProcessing:N,updateProgress:D,setSteps:R,resetProcessing:V,setProcessingError:U}=function(){const a=e(null),l=e(0),s=e(""),i=e(0),n=e([]),r=e({}),o=e(null),u=e(null),c=e(null),d=e(null),v=e(!1),p=t((()=>a.value?(Date.now()-a.value)/1e3:0)),m=t((()=>l.value?Math.max(0,l.value-p.value):0)),g=t((()=>l.value?Math.min(100,p.value/l.value*100):0)),f=t((()=>{if(!n.value.length)return 0;const e=n.value.findIndex((e=>e.step===s.value));if(-1===e)return 0;const a=n.value[e],t=p.value-(a.startTime||0);return Math.min(100,t/a.estimated_time*100)})),y=(e,a)=>{const t=n.value.findIndex((a=>a.step===e));-1!==t&&(0!==t&&100!==n.value[t-1].progress||(s.value=e,n.value[t].startTime||(n.value[t].startTime=Date.now())),n.value[t].progress=a,i.value=a)};return{startTime:a,estimatedTotalTime:l,currentStep:s,stepProgress:i,processingSteps:n,actualTimes:r,citationInfo:o,rateLimitInfo:u,timeout:c,processingError:d,canRetry:v,elapsedTime:p,remainingTime:m,totalProgress:g,currentStepProgress:f,startProcessing:e=>{var t;a.value=Date.now(),"object"==typeof e&&null!==e&&Array.isArray(e.steps)?(l.value=e.estimated_total_time,n.value=e.steps.map((e=>({step:e[0],estimated_time:e[1],startTime:null,progress:0}))),s.value=(null==(t=n.value[0])?void 0:t.step)||""):"number"==typeof e?(l.value=e,n.value=[],s.value=""):(l.value=0,n.value=[],s.value=""),i.value=0},stopProcessing:()=>{a.value=null,l.value=0,s.value="",i.value=0},updateProgress:e=>{"object"==typeof e&&e.step?y(e.step,e.progress||0):"number"==typeof e&&(i.value=e)},setSteps:e=>{Array.isArray(e)&&(n.value=e.map((e=>({step:"string"==typeof e?e:e.step,estimated_time:"object"==typeof e?e.estimated_time:10,startTime:null,progress:0}))))},resetProcessing:()=>{a.value=null,l.value=0,s.value="",i.value=0,n.value=[],r.value={},o.value=null,u.value=null,c.value=null,d.value=null,v.value=!1},setProcessingError:e=>{d.value=e,v.value=!0},updateStep:y,completeStep:e=>{y(e,100);const a=n.value.findIndex((a=>a.step===e))+1;a<n.value.length&&(s.value=n.value[a].step,n.value[a].startTime=Date.now())},updateActualTimes:e=>{r.value=e},reset:()=>{a.value=null,l.value=0,s.value="",i.value=0,n.value=[],r.value={},o.value=null,u.value=null,c.value=null,d.value=null,v.value=!1},formatTime:e=>e<60?`${Math.round(e)}s`:`${Math.floor(e/60)}m ${Math.round(e%60)}s`}}(),F=e(0),q=e(null),E=e(null),B=e(null);let $=e(null);const j=e(""),O=e("info"),H=(e,a="info")=>{j.value=e,O.value=a},J=e(null),G=12e4,X=e(""),Y=t((()=>_.value&&_.value.total>=35)),K=e(0),Q=t((()=>_.value&&_.value.total?_.value.total:0)),W=t((()=>Q.value?Math.min(100,Math.round(K.value/Q.value*100)):0)),Z=t((()=>W.value>=80?"bg-success":W.value>=50?"bg-info":W.value>=30?"bg-warning":"bg-danger"));let ee=null;function ae(){i.value=null,n.value=null,V()}function te(e){return(e||[]).map((e=>{const a=e.case_name&&"N/A"!==e.case_name&&e.canonical_date&&"N/A"!==e.canonical_date;let t=0;if(e.case_name&&"N/A"!==e.case_name&&(t+=2),e.extracted_case_name&&"N/A"!==e.extracted_case_name&&e.case_name&&"N/A"!==e.case_name){const a=e.case_name.toLowerCase().split(/\s+/).filter((e=>e.length>2)),l=e.extracted_case_name.toLowerCase().split(/\s+/).filter((e=>e.length>2));a.filter((e=>l.includes(e))).length/Math.max(a.length,l.length)>=.5&&(t+=1)}if(e.extracted_date&&e.canonical_date){const a=e.extracted_date.toString().substring(0,4);a===e.canonical_date.toString().substring(0,4)&&4===a.length&&(t+=1)}let l="red";4===t||3===t?l="green":2===t?l="yellow":1===t&&(l="orange");return{...e,citation:e.citation||e.text||"Unknown citation",verified:a,valid:a,score:t,scoreColor:l,case_name:e.case_name||"N/A",extracted_case_name:e.extracted_case_name||"N/A",hinted_case_name:e.hinted_case_name||"N/A",canonical_date:e.canonical_date||null,extracted_date:e.extracted_date||null,metadata:{case_name:e.case_name,canonical_date:e.canonical_date,court:e.court,confidence:e.confidence,method:e.method,pattern:e.pattern},details:{case_name:e.case_name,canonical_date:e.canonical_date,court:e.court,confidence:e.confidence,method:e.method,pattern:e.pattern}}}))}async function le(e){if(e)try{const a=(await P.get(`/task_status/${e}`)).data;if("completed"===a.status){const e=Array.isArray(a.results)?a.results:a.citations||[];if(i.value={citations:te(e),metadata:a.metadata||{},total_citations:e.length,verified_count:e.filter((e=>{var a,t;return e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found)})).length,unverified_count:e.filter((e=>{var a,t;return!(e.verified||e.valid||(null==(a=e.data)?void 0:a.valid)||(null==(t=e.data)?void 0:t.found))})).length},u.value=!1,N(),r.value=!1,void 0!==c&&void 0!==c.value&&(c.value=!1),H("Citation analysis completed successfully!","success"),B.value&&(clearInterval(B.value),B.value=null),0===e.length){let e="No citations found in the provided text or document.";a.status_message&&a.status_message.toLowerCase().includes("rate limit")&&(e+=" (Possible cause: search engine rate limiting)"),a.error&&(e+=` (Backend error: ${a.error})`),n.value=e}window&&window.localStorage&&"true"===window.localStorage.getItem("debugMode")&&(n.value+="\n[DEBUG] Raw backend response: "+JSON.stringify(a,null,2))}else"failed"===a.status?(n.value=a.error||"Processing failed",u.value=!1,U(a.error||"Processing failed"),H(`Processing failed: ${a.error||"Unknown error"}`,"error"),B.value&&(clearInterval(B.value),B.value=null)):(u.value=!0,a.estimated_total_time&&a.steps?$.value!==e&&(M({estimated_total_time:a.estimated_total_time,steps:a.steps}),$.value=e):a.estimated_total_time&&$.value!==e&&(M(a.estimated_total_time),$.value=e),a.current_step&&D({step:a.current_step,progress:a.progress||0}),void 0!==a.total_citations&&(_.value={total:a.total_citations,processed:a.processed_citations||0,unique:a.unique_citations||0}),B.value||(B.value=setInterval((()=>le(e)),2e3)));ce()}catch(a){n.value="Failed to check processing status",u.value=!1,U("Failed to check processing status"),B.value&&(clearInterval(B.value),B.value=null)}}const se=async(e,a)=>{try{"file"===a?await oe({file:e}):"url"===a?await ue({url:e}):"text"===a&&await re({text:e})}catch(t){w.value=`Failed to analyze input: ${t.message}`,T.value=!0}},ie=e=>{try{const a=Array.isArray(e.validation_results)&&e.validation_results.length>0?e.validation_results:e.citations||[];i.value={...e,citations:te(a),timestamp:(new Date).toISOString()},r.value=!1,n.value=null,u.value=!1,E.value=null,void 0!==c&&void 0!==c.value&&(c.value=!1),A((()=>{const e=document.querySelector(".results-container");e&&e.scrollIntoView({behavior:"smooth"})}))}catch(a){n.value="Failed to process results",r.value=!1}},ne=e=>{n.value=e.message||"An error occurred during analysis",r.value=!1,u.value=!1,E.value=null,w.value=e.message||"Analysis failed",T.value=!0,H(n.value,"error")},re=async({text:e,options:a})=>{r.value=!0,n.value=null,i.value=null;try{const a=await P.post("/analyze",{text:e,type:"text"},{timeout:3e5});"processing"===a.data.status&&a.data.task_id?(u.value=!0,E.value=a.data.task_id,B.value||(B.value=setInterval((()=>le(a.data.task_id)),2e3))):(ie(a.data),r.value=!1)}catch(t){ne(t)}},oe=async({file:e})=>{r.value=!0,n.value=null,i.value=null;try{const a=new FormData;a.append("file",e);const t=await P.post("/analyze",a,{headers:{"Content-Type":"multipart/form-data"},timeout:3e5});"processing"===t.data.status&&t.data.task_id?(u.value=!0,E.value=t.data.task_id,B.value||(B.value=setInterval((()=>le(t.data.task_id)),2e3))):(ie(t.data),r.value=!1)}catch(a){ne(a)}},ue=async({url:e})=>{r.value=!0,n.value=null,i.value=null;try{const a=await P.post("/analyze",{url:e,type:"url"},{timeout:3e5});"processing"===a.data.status&&a.data.task_id?(u.value=!0,E.value=a.data.task_id,B.value||(B.value=setInterval((()=>le(a.data.task_id)),2e3))):(ie(a.data),r.value=!1)}catch(a){ne(a)}};function ce(){J.value&&(clearTimeout(J.value),J.value=null)}return x((()=>{let e={...s.query};if(e.task_id)return E.value=e.task_id,u.value=!0,void le(e.task_id);if(!e.text&&!e.url&&!e.fileName&&localStorage.getItem("lastCitationInput"))try{e=JSON.parse(localStorage.getItem("lastCitationInput"))}catch(a){e={}}e.text||e.url||e.fileName?(ae(),e.text?re({text:e.text}):e.url?ue({url:e.url}):e.fileName&&(n.value="File upload not available from history. Please upload the file again.")):i.value=null,Y.value&&Q.value>20&&(K.value=0,ee&&clearInterval(ee),ee=setInterval((()=>{K.value<Q.value&&K.value++}),2e3))})),a((()=>{u.value&&o(),B.value&&(clearInterval(B.value),B.value=null),ce(),ee&&clearInterval(ee)})),l((()=>i.value),(e=>{e&&ee&&(K.value=Q.value,clearInterval(ee))})),{results:i,error:n,isLoading:d,showLoading:d,hasActiveRequest:u,clearResults:ae,handleUnifiedAnalyze:function(e){V(),R([{step:"Preparing analysis",estimated_time:5},{step:"Processing content",estimated_time:30},{step:"Verifying citations",estimated_time:60}]),M(),u.value=!0,n.value=null,i.value=null,e.file?oe(e):e.url?ue(e):e.text&&(e.quick,re({text:e.text,options:{}})),X.value="",ce(),J.value=setTimeout((()=>{X.value="Processing timed out. No response from server.",U(X.value),u.value=!1,H(X.value,"error")}),G)},retryProcessing:async()=>{if(E.value)try{w.value=null,T.value=!1,V(),await P.cancelRequest(E.value);const e=P.getRequestStatus(E.value);if(e){const{type:a,input:t}=e;await se(t,a)}}catch(e){w.value=`Failed to retry: ${e.message}`,T.value=!0}},cancelValidation:o,copyResults:function(){},downloadResults:function(){},elapsedTime:v,remainingTime:p,totalProgress:m,currentStep:g,currentStepProgress:f,processingSteps:y,actualTimes:h,formatTime:function(e){if(!e||e<0)return"0s";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=Math.floor(e%60);return a>0?`${a}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`},citationInfo:_,queuePosition:F,estimatedQueueTime:q,rateLimitInfo:b,timeout:k,processingError:w,canRetry:T,getProgressBarClass:function(e){return e>=.8?"bg-success":e>=.5?"bg-info":e>=.3?"bg-warning":"bg-danger"},applyCorrection:()=>{},toastMessage:j,toastType:O,clearToast:()=>{j.value=""},fallbackError:X,showTimer:Y,progressCurrent:K,progressTotal:Q,progressPercent:W,progressBarClass:Z}}},[["render",function(e,a,t,l,c,d){const p=k("Toast"),m=k("SkeletonLoader"),g=k("CitationResults");return i(),s("div",al,[l.toastMessage?(i(),y(p,{key:0,message:l.toastMessage,type:l.toastType,onClose:l.clearToast},null,8,["message","type","onClose"])):n("",!0),r("div",tl,[r("button",{class:"btn btn-link back-btn",onClick:a[0]||(a[0]=(...a)=>e.goHome&&e.goHome(...a))},a[1]||(a[1]=[r("i",{class:"bi bi-arrow-left"},null,-1),u(" Back to Home ")])),a[2]||(a[2]=r("h1",{class:"results-title"},"Citation Verification Results",-1))]),r("div",ll,[l.showLoading&&!l.results?(i(),s("div",sl,[w(m,{lines:4,height:"6em"})])):n("",!0),l.showLoading&&!l.showTimer?(i(),s("div",il,a[3]||(a[3]=[r("div",{class:"card"},[r("div",{class:"card-body text-center"},[r("h5",{class:"card-title"},[r("i",{class:"fas fa-cog fa-spin me-2"}),u(" Processing Citations ")]),r("div",{class:"spinner-border text-info mt-3",role:"status"},[r("span",{class:"visually-hidden"},"Processing...")]),r("div",{class:"mt-2"},"Processing citations...")])],-1)]))):n("",!0),l.showLoading&&l.showTimer?(i(),s("div",nl,[r("div",rl,[r("div",ol,[a[4]||(a[4]=r("h5",{class:"card-title"},[r("i",{class:"fas fa-cog fa-spin me-2"}),u(" Processing Citations ")],-1)),a[5]||(a[5]=r("div",{class:"spinner-border text-info mt-3",role:"status"},[r("span",{class:"visually-hidden"},"Processing...")],-1)),r("div",ul,"Processing "+o(l.progressCurrent)+" of "+o(l.progressTotal)+" citations...",1),r("div",cl,[r("div",{class:v(["progress-bar progress-bar-striped progress-bar-animated",l.progressBarClass]),role:"progressbar",style:b({width:l.progressPercent+"%"}),"aria-valuenow":l.progressPercent,"aria-valuemin":"0","aria-valuemax":"100"},o(l.progressPercent)+"% ",15,dl)]),100!==l.progressPercent||l.results?n("",!0):(i(),s("div",vl,"Finalizing results..."))])])])):n("",!0),l.results&&!l.showLoading?(i(),s("div",pl,[w(g,{results:l.results,onApplyCorrection:l.applyCorrection,onCopyResults:l.copyResults,onDownloadResults:l.downloadResults,onToast:e.showToast},null,8,["results","onApplyCorrection","onCopyResults","onDownloadResults","onToast"])])):n("",!0),l.error&&!l.showLoading?(i(),s("div",ml,[r("div",gl,[a[6]||(a[6]=r("i",{class:"error-icon"},"‚ùå",-1)),a[7]||(a[7]=r("h3",null,"Analysis Failed",-1)),r("p",null,o(l.error),1)])])):n("",!0),l.results||l.showLoading||l.error?n("",!0):(i(),s("div",fl,a[8]||(a[8]=[r("p",{class:"lead"},[u("No results to display."),r("br"),u("Please return to the home page to start a new analysis.")],-1)])))])])}],["__scopeId","data-v-f92763c3"]]);export{yl as default};
