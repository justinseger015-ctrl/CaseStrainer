import{r as e,s as a,p as t,c as l,o as s,b as n,l as i,u,g as r,v as o,x as c,y as d,t as v,F as p,n as m,z as b}from"./vue-core-BXg5zaqj.js";import{a as f}from"./api-Cibp7nif.js";import{_ as y}from"./index--vV0uQ1E.js";import"./axios-rSMZb3Ae.js";import"./pinia-CQ2rHS-F.js";const g={class:"home"},h={class:"container"},x={class:"modern-card shadow-sm mt-5"},k={class:"card-body p-5"},w={class:"mb-5"},I={class:"btn-group w-100 modern-tab-group",role:"group"},C=["disabled"],z=["disabled"],M=["disabled"],P={class:"modern-tab-content"},S={key:0,class:"my-tab-pane"},D={class:"form-group mb-4"},R=["disabled"],U={key:1,class:"my-tab-pane"},N={class:"form-group mb-4"},O=["disabled"],B={key:0,class:"drop-zone-content"},F={key:1,class:"file-info"},T={class:"file-details"},E={class:"text-muted"},_={key:0,class:"text-danger mt-2"},j={key:2,class:"my-tab-pane"},q={class:"form-group mb-4"},A=["disabled"],L={key:0,class:"invalid-feedback"},V={key:1,class:"form-text mt-1"},X={key:0,class:"mb-4"},J={class:"recent-inputs"},K=["onClick"],W={class:"recent-input-content"},$={class:"recent-input-title"},G={class:"recent-input-preview"},H=["onClick"],Q={class:"mt-5"},Y=["disabled"],Z={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},ee={key:1,class:"bi bi-search me-2"},ae=y({__name:"HomeView",setup(y){const ae=b(),te=e("paste"),le=e(""),se=e(""),ne=e(null),ie=e(!1),ue=e(!1),re=e(""),oe=e(""),ce=e([]);a((()=>{const e=localStorage.getItem("recentCitationInputs");if(e)try{ce.value=JSON.parse(e).slice(0,5)}catch(a){}}));const de=t((()=>le.value?le.value.trim().split(/\s+/).length:0)),ve=t((()=>{if(!le.value)return 0;let e=0;return[/\d+\s+[Uu]\.?[Ss]\.?\s+\d+/g,/\d+\s+[Ff]\.?\d*\s+\d+/g,/\d+\s+[Ss]\.?\s+\d+/g,/\d+\s+[Aa]pp\.?\s+\d+/g].forEach((a=>{const t=le.value.match(a);t&&(e+=t.length)})),Math.max(e,Math.floor(de.value/100))})),pe=t((()=>{if(!le.value)return 0;const e=le.value.match(/\b(19|20)\d{2}\b/g);return e?new Set(e).size:0})),me=t((()=>{if(!le.value)return 0;let e=0;e+=Math.min(30,le.value.length/1e3*10);e+=Math.min(25,de.value/50*5);const a=ve.value/Math.max(1,de.value/100);e+=Math.min(25,10*a);return e+=Math.min(20,4*pe.value),Math.round(e)}));t((()=>me.value>=80?"excellent":me.value>=60?"good":me.value>=40?"fair":"poor"));const be=t((()=>{switch(te.value){case"paste":return le.value.trim().length>=10;case"file":return null!==ne.value;case"url":return""!==se.value.trim()&&!oe.value;default:return!1}})),fe=()=>{if(re.value="",oe.value="","url"===te.value&&se.value.trim())try{new URL(se.value)}catch{oe.value="Please enter a valid URL"}"paste"===te.value&&le.value.length},ye=()=>{localStorage.setItem("recentCitationInputs",JSON.stringify(ce.value))},ge=e=>{switch(e){case"paste":return"bi bi-clipboard-text";case"file":return"bi bi-file-earmark-text";case"url":return"bi bi-link-45deg";default:return"bi bi-question-circle"}},he=e=>{switch(e.tab){case"paste":return"Text Input";case"file":return`File: ${e.fileName}`;case"url":return"URL Input";default:return"Unknown Input"}},xe=e=>{switch(e.tab){case"paste":return e.text?e.text.substring(0,60)+(e.text.length>60?"...":""):"";case"file":return e.fileName||"Unknown file";case"url":return e.url||"";default:return""}},ke=e=>{const a=e.target.files[0];a&&Ie(a)},we=e=>{e.preventDefault(),ue.value=!1;const a=e.dataTransfer.files[0];a&&Ie(a)},Ie=e=>{re.value="";["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"].includes(e.type)?e.size>52428800?re.value="File size must be less than 50MB":ne.value=e:re.value="Please select a valid file type (PDF, DOC, DOCX, or TXT)"},Ce=()=>{if(!ie.value){const e=document.getElementById("fileInput");e&&e.click()}},ze=()=>{ne.value=null,re.value="",document.getElementById("fileInput")&&(document.getElementById("fileInput").value="")},Me=e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},Pe=async()=>{var e,a;if(be.value&&!ie.value){ie.value=!0;try{const e={tab:te.value,text:le.value,url:se.value,fileName:ne.value?ne.value.name:null,timestamp:(new Date).toISOString()};let a;switch((e=>{ce.value=ce.value.filter((a=>!(a.tab===e.tab&&("paste"===a.tab&&a.text===e.text||"url"===a.tab&&a.url===e.url||"file"===a.tab&&a.fileName===e.fileName)))),ce.value.unshift(e),ce.value=ce.value.slice(0,5),ye()})(e),localStorage.setItem("lastCitationInput",JSON.stringify(e)),te.value){case"paste":le.value.trim()&&(a=await f.post("/analyze",{text:le.value.trim(),type:"text"}));break;case"url":se.value.trim()&&(a=await f.post("/analyze",{url:se.value.trim(),type:"url"}));break;case"file":if(ne.value){const e=new FormData;e.append("file",ne.value),e.append("type","file"),a=await f.post("/analyze",e,{headers:{"Content-Type":"multipart/form-data"}})}}a&&a.data&&("processing"===a.data.status&&a.data.task_id?ae.push({path:"/enhanced-validator",query:{tab:te.value,task_id:a.data.task_id,..."paste"===te.value&&le.value.trim()?{text:le.value.trim()}:{},..."url"===te.value&&se.value.trim()?{url:se.value.trim()}:{}}}):ae.push({path:"/enhanced-validator",query:{tab:te.value,..."paste"===te.value&&le.value.trim()?{text:le.value.trim()}:{},..."url"===te.value&&se.value.trim()?{url:se.value.trim()}:{}}}))}catch(t){let l="An error occurred during analysis. Please try again.";if(t.response)switch(t.response.status){case 400:l=(null==(e=t.response.data)?void 0:e.message)||"Invalid input. Please check your data and try again.";break;case 413:l="File too large. Please use a smaller file.";break;case 429:l="Too many requests. Please wait a moment and try again.";break;case 500:l="Server error. Please try again later.";break;default:l=(null==(a=t.response.data)?void 0:a.message)||`Server error (${t.response.status}). Please try again.`}else"ECONNABORTED"===t.code?l="Request timed out. Please try again.":"NETWORK_ERROR"===t.code&&(l="Network error. Please check your connection and try again.");alert(l)}finally{ie.value=!1}}};return(e,a)=>(s(),l("div",g,[n("div",h,[n("div",x,[n("div",k,[a[19]||(a[19]=n("h2",{class:"mb-5 text-center modern-title"},"Citation Verifier",-1)),n("div",w,[n("div",I,[n("button",{type:"button",class:u(["btn modern-tab-btn","paste"===te.value?"active":""]),onClick:a[0]||(a[0]=e=>te.value="paste"),disabled:ie.value},a[7]||(a[7]=[n("i",{class:"bi bi-clipboard-text me-2"},null,-1),r(" Paste Text ")]),10,C),n("button",{type:"button",class:u(["btn modern-tab-btn","file"===te.value?"active":""]),onClick:a[1]||(a[1]=e=>te.value="file"),disabled:ie.value},a[8]||(a[8]=[n("i",{class:"bi bi-upload me-2"},null,-1),r(" File Upload ")]),10,z),n("button",{type:"button",class:u(["btn modern-tab-btn","url"===te.value?"active":""]),onClick:a[2]||(a[2]=e=>te.value="url"),disabled:ie.value},a[9]||(a[9]=[n("i",{class:"bi bi-link-45deg me-2"},null,-1),r(" URL Upload ")]),10,M)])]),n("div",P,["paste"===te.value?(s(),l("div",S,[n("div",D,[a[10]||(a[10]=n("label",{for:"textInput",class:"form-label"},"Paste your text here",-1)),o(n("textarea",{id:"textInput","onUpdate:modelValue":a[3]||(a[3]=e=>le.value=e),class:"form-control modern-input",rows:"8",placeholder:"Paste legal text, citations, or document content here...",disabled:ie.value,onInput:fe},null,40,R),[[c,le.value]])])])):i("",!0),"file"===te.value?(s(),l("div",U,[n("div",N,[a[15]||(a[15]=n("label",{class:"form-label"},"Upload a document",-1)),n("div",{class:u(["file-drop-zone modern-drop-zone",{"has-file":ne.value,dragover:ue.value,error:re.value}]),onDrop:we,onDragover:a[4]||(a[4]=d((e=>ue.value=!0),["prevent"])),onDragleave:a[5]||(a[5]=d((e=>ue.value=!1),["prevent"])),onClick:Ce},[n("input",{ref:"fileInput",id:"fileInput",type:"file",onChange:ke,disabled:ie.value,accept:".pdf,.doc,.docx,.txt",style:{display:"none"}},null,40,O),ne.value?(s(),l("div",F,[a[13]||(a[13]=n("i",{class:"bi bi-file-earmark-text fs-3 text-primary me-3"},null,-1)),n("div",T,[n("strong",null,v(ne.value.name),1),n("span",E,v(Me(ne.value.size)),1)]),ie.value?i("",!0):(s(),l("button",{key:0,onClick:d(ze,["stop"]),class:"btn btn-sm btn-outline-danger"},a[12]||(a[12]=[n("i",{class:"bi bi-x"},null,-1)])))])):(s(),l("div",B,a[11]||(a[11]=[n("i",{class:"bi bi-cloud-upload fs-1 text-muted mb-3"},null,-1),n("p",{class:"mb-2"},"Click to browse or drag & drop",-1),n("p",{class:"text-muted small"},"Supports: PDF, DOC, DOCX, TXT (max 50MB)",-1)])))],34),re.value?(s(),l("div",_,[a[14]||(a[14]=n("i",{class:"bi bi-exclamation-triangle me-1"},null,-1)),r(" "+v(re.value),1)])):i("",!0)])])):i("",!0),"url"===te.value?(s(),l("div",j,[n("div",q,[a[16]||(a[16]=n("label",{for:"urlInput",class:"form-label"},"Enter URL to analyze",-1)),o(n("input",{id:"urlInput","onUpdate:modelValue":a[6]||(a[6]=e=>se.value=e),type:"url",class:u(["form-control modern-input",{"is-invalid":oe.value}]),placeholder:"https://example.com/document.pdf",disabled:ie.value,onInput:fe},null,42,A),[[c,se.value]]),oe.value?(s(),l("div",L,v(oe.value),1)):se.value&&!oe.value?(s(),l("div",V," Will analyze: "+v(se.value),1)):i("",!0)])])):i("",!0)]),ce.value.length>0?(s(),l("div",X,[a[18]||(a[18]=n("label",{class:"form-label"},"Recent Inputs",-1)),n("div",J,[(s(!0),l(p,null,m(ce.value,((e,t)=>(s(),l("div",{key:t,class:"recent-input-item",onClick:a=>(e=>{switch(te.value=e.tab,e.tab){case"paste":le.value=e.text||"";break;case"url":se.value=e.url||""}fe()})(e)},[n("div",W,[n("div",$,[n("i",{class:u([ge(e.tab),"me-2"])},null,2),r(" "+v(he(e)),1)]),n("div",G,v(xe(e)),1)]),n("button",{onClick:d((e=>(e=>{ce.value.splice(e,1),ye()})(t)),["stop"]),class:"btn btn-sm btn-outline-secondary",title:"Remove from history"},a[17]||(a[17]=[n("i",{class:"bi bi-x"},null,-1)]),8,H)],8,K)))),128))])])):i("",!0),n("div",Q,[n("button",{class:u(["btn","btn-primary","btn-lg","w-100",{disabled:!be.value||ie.value}]),disabled:!be.value||ie.value,onClick:Pe},[ie.value?(s(),l("span",Z)):(s(),l("i",ee)),r(" "+v(ie.value?"Analyzing...":"Analyze Content"),1)],10,Y)])])])])]))}},[["__scopeId","data-v-9b112e11"]]);export{ae as default};
