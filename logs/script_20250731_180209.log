**********************
Windows PowerShell transcript start
Start time: 20250731180209
Username: NETID\jafrank
RunAs User: NETID\jafrank
Configuration Name: 
Machine: HAUMEA (Microsoft Windows NT 10.0.20348.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy Bypass -Command .\cslaunch.ps1 -MenuOption 2
Process ID: 12724
PSVersion: 5.1.20348.3932
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.20348.3932
BuildVersion: 10.0.20348.3932
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is D:\dev\casestrainer\logs\script_20250731_180209.log

=== Checking Docker Availability ===
[OK] Docker CLI is available: Docker version 28.3.2, build 578ccf6
[INFO] Docker is running in Linux containers mode
[OK] Docker Compose is available: Docker Compose version v2.38.2-desktop.1
[cslaunch] Running menu option 2...
Deleting all .pyc files and __pycache__ directories to prevent stale bytecode...
Ensuring latest code from git...
âš ï¸ Uncommitted changes detected - skipping git pull
   Uncommitted files: 43
Analyzing code changes to determine rebuild strategy...
Found recent changes: 43 files
   - .env
   - casestrainer-vue-new/package-lock.json
   - citations.db
   - ... and 40 more
âš ï¸ Detected critical changes - recommending full rebuild for safety
   - Python import changes detected
   - Dependency file changes detected
ðŸ„ Performing full rebuild due to detected changes...

=== Starting Docker Production Mode ===
Checking if Vue build is needed...
Force flag specified - Vue build required
OK Docker is running
OK Sufficient disk space (90.86 GB free)
Processing Vue frontend build...
Vue build needed: True, ForceRebuild: True
Building Vue frontend (ForceRebuild: True)...
Force rebuild mode: Clearing Vue caches...
Removing existing dist directory...
Removing node_modules for clean install...
Removing package-lock.json for clean dependency resolution...
Clearing npm cache...
npm cache cleared
Vue directory: D:\dev\casestrainer\casestrainer-vue-new
Checking Node.js and npm...
OK Node.js v22.15.0, npm 8.19.2
Using npm at: npm
Installing npm dependencies...
Force rebuild: Running clean npm install...
Running: npm install
OK npm dependencies installed
Building Vue frontend...
Force rebuild: Building from clean state...
Running: npm run build
OK Vue frontend built successfully (0.61 MB)
Copying Vue build assets to static/assets...
Assets copied to D:\dev\casestrainer\static\assets
Stopping existing Docker containers...
Force rebuild: Removing volumes and orphaned containers...
Running: docker-compose -f D:\dev\casestrainer\docker-compose.prod.yml down --timeout 30 --volumes --remove-orphans
Containers stopped successfully
Checking for any remaining 'casestrainer' containers...
No remaining 'casestrainer' containers found.

Starting Docker containers...
Force rebuild: Building all images from scratch with --no-cache...
Running: docker-compose -f D:\dev\casestrainer\docker-compose.prod.yml build --no-cache
Docker compose command: docker-compose -f D:\dev\casestrainer\docker-compose.prod.yml up -d
OK Docker containers started successfully
Waiting for containers to initialize...

Waiting for services to initialize...
Services not ready (attempt 1): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 2): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 3): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 4): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 5): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 6): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 7): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 8): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 9): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 10): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 11): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 12): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 13): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 14): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 15): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 16): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 17): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 18): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 19): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 20): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 21): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 22): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 23): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 24): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 25): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 26): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 27): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 28): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 29): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 30): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 31): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 32): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 33): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 34): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 35): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 36): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 37): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 38): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 39): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 40): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 41): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 42): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 43): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 44): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 45): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 46): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 47): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 48): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 49): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 50): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
WARNING: Timeout waiting for services after 10 minutes
Final status: Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Health check failed, attempting container restart...
Restarting backend and worker containers...
docker-compose : no such service: backend-prod
At D:\dev\casestrainer\cslaunch.ps1:1693 char:29
+ ...             docker-compose -f $dockerComposeFile restart backend-prod ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (no such service: backend-prod:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError

Waiting for services to initialize...
Services not ready (attempt 1): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 2): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 3): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 4): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 5): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 6): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 7): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 8): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 9): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 10): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 11): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 12): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 13): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 14): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Services not ready (attempt 15): Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
WARNING: Timeout waiting for services after 3 minutes
Final status: Backend (127.0.0.1:5001): DOWN, Redis (127.0.0.1:6380): UP, RQ Worker: HEALTHY
Container restart didn't help, but continuing anyway...

=== Docker Production Mode Ready ===
INFO Production Site:  https://wolf.law.uw.edu/casestrainer

Local Development URLs:
Backend API:    http://localhost:5001/casestrainer/api/
Frontend Prod:  http://localhost:8080/
Nginx (HTTP):   http://localhost:80/
Nginx (HTTPS):  https://localhost:443/
Local Frontend: https://localhost/casestrainer/
API Health:     https://localhost/casestrainer/api/health

Docker Commands:
  View logs:    docker-compose -f docker-compose.prod.yml logs [service]
  Stop all:     docker-compose -f docker-compose.prod.yml down
  Restart:      docker-compose -f docker-compose.prod.yml restart [service]

Running adaptive learning pipeline...
Starting adaptive learning pipeline...
Using enhanced adaptive learning pipeline...
Running adaptive learning pipeline...
âœ… Adaptive learning pipeline completed successfully
âœ… Adaptive learning completed successfully

Running post-startup validation...
  Testing API endpoints...
PS>TerminatingError(Invoke-WebRequest): "Unable to connect to the remote server"
  Health check attempt 1 failed: Unable to connect to the remote server
PS>TerminatingError(Invoke-WebRequest): "Unable to connect to the remote server"
  Health check attempt 2 failed: Unable to connect to the remote server
PS>TerminatingError(Invoke-WebRequest): "Unable to connect to the remote server"
  Health check attempt 3 failed: Unable to connect to the remote server
  âŒ API health check failed after 3 attempts
WARNING: Post-startup validation failed - system may have issues
Running production test suite...
pytest.exe :
D:\Python\Lib\site-packages\pytest_asyncio\plugin.py:208:
PytestDeprecationWarning: The configuration option
"asyncio_default_fixture_loop_scope" is unset.
At D:\dev\casestrainer\cslaunch.ps1:2616 char:21
+ ...             & pytest test_production_server.py -v
--maxfail=1 --disab ...
+
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (D:\Python\Lib\s..
   .cope" is unset.:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError

The event loop scope for asynchronous fixtures will default to
the fixture caching scope. Future versions of pytest-asyncio
will default the loop scope for asynchronous fixtures to
function scope. Set the default fixture loop scope explicitly
in order to avoid unexpected behavior in the future. Valid
fixture loop scopes are: "function", "class", "module",
"package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_
SCOPE_UNSET))
============================= test session starts =============================
platform win32 -- Python 3.13.3, pytest-8.3.5, pluggy-1.6.0 -- D:\Python\python.exe
cachedir: .pytest_cache
metadata: {'Python': '3.13.3', 'Platform': 'Windows-2022Server-10.0.20348-SP0', 'Packages': {'pytest': '8.3.5', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.9.0', 'asyncio': '1.0.0', 'cov': '6.1.1', 'html': '4.1.1', 'httpx': '0.35.0', 'metadata': '3.1.1', 'mock': '3.14.1', 'timeout': '2.4.0', 'xdist': '3.7.0'}}
rootdir: D:\dev\casestrainer
configfile: pytest.ini
plugins: anyio-4.9.0, asyncio-1.0.0, cov-6.1.1, html-4.1.1, httpx-0.35.0, metadata-3.1.1, mock-3.14.1, timeout-2.4.0, xdist-3.7.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
ERROR: file or directory not found: test_production_server.py

collecting ... collected 0 items

============================ no tests ran in 0.03s ============================
[2025-07-31 18:24:11] âŒ Some production tests failed (exit code: 4)!

Last 30 lines of test output:
--maxfail=1 --disab ...
+
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (D:\Python\Lib\s..
   .cope" is unset.:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError

The event loop scope for asynchronous fixtures will default to
the fixture caching scope. Future versions of pytest-asyncio
will default the loop scope for asynchronous fixtures to
function scope. Set the default fixture loop scope explicitly
in order to avoid unexpected behavior in the future. Valid
fixture loop scopes are: "function", "class", "module",
"package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_
SCOPE_UNSET))
============================= test session starts =============================
platform win32 -- Python 3.13.3, pytest-8.3.5, pluggy-1.6.0 -- D:\Python\python.exe
cachedir: .pytest_cache
metadata: {'Python': '3.13.3', 'Platform': 'Windows-2022Server-10.0.20348-SP0', 'Packages': {'pytest': '8.3.5', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.9.0', 'asyncio': '1.0.0', 'cov': '6.1.1', 'html': '4.1.1', 'httpx': '0.35.0', 'metadata': '3.1.1', 'mock': '3.14.1', 'timeout': '2.4.0', 'xdist': '3.7.0'}}
rootdir: D:\dev\casestrainer
configfile: pytest.ini
plugins: anyio-4.9.0, asyncio-1.0.0, cov-6.1.1, html-4.1.1, httpx-0.35.0, metadata-3.1.1, mock-3.14.1, timeout-2.4.0, xdist-3.7.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
ERROR: file or directory not found: test_production_server.py

collecting ... collected 0 items

============================ no tests ran in 0.03s ============================

Full test log available at: D:\dev\casestrainer\logs\production_test.log
PS>$global:?
False
